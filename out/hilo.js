(function(g){g.console=g.console||{log:function(){}};g=Array.prototype;var f=g.slice;g.indexOf=g.indexOf||function(f,c){c=c||0;var a=this.length,e;if(0==a||c>=a)return-1;0>c&&(c=a+c);for(e=c;e<a;e++)if(this[e]===f)return e;return-1};g=Function.prototype;g.bind=g.bind||function(h){function c(){var b=e.concat(f.call(arguments));return a.apply(this instanceof c?this:h,b)}var a=this,e=f.call(arguments,1),d=function(){};d.prototype=a.prototype;c.prototype=new d;return c}})(window);
(function(g){for(var f=0,h=["ms","moz","webkit","o"],c=0;c<h.length&&!g.requestAnimationFrame;++c)g.requestAnimationFrame=g[h[c]+"RequestAnimationFrame"],g.cancelAnimationFrame=g[h[c]+"CancelAnimationFrame"]||g[h[c]+"CancelRequestAnimationFrame"];g.requestAnimationFrame||(g.requestAnimationFrame=function(a,e){var d=(new Date).getTime(),b=Math.max(0,16-(d-f)),k=g.setTimeout(function(){a(d+b)},b);f=d+b;return k});g.cancelAnimationFrame||(g.cancelAnimationFrame=function(a){clearTimeout(a)})})(window);(function(g){var f=function(){var h=document,c=h.documentElement,a=0;return{getUid:function(e){var d=++a;if(e){var b=e.charCodeAt(e.length-1);48<=b&&57>=b&&(e+="_");return e+d}return d},viewToString:function(e){for(var d;e;)d=d?e.id+"."+d:e.id,e=e.parent;return d},copy:function(e,d,b){for(var k in d)if(!b||e.hasOwnProperty(k)||void 0!==e[k])e[k]=d[k];return e},browser:function(){var e=navigator.userAgent,e={iphone:/iphone/i.test(e),ipad:/ipad/i.test(e),ipod:/ipod/i.test(e),ios:/iphone|ipad|ipod/i.test(e),
android:/android/i.test(e),webkit:/webkit/i.test(e),chrome:/chrome/i.test(e),safari:/safari/i.test(e),firefox:/firefox/i.test(e),ie:/msie/i.test(e),opera:/opera/i.test(e),supportTouch:"ontouchstart"in g,supportCanvas:null!=h.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation"in g,supportDeviceMotion:"ondevicemotion"in g};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),e.supportStorage=!0}catch(a){}var d=e.jsVendor=e.webkit?"webkit":e.firefox?
"Moz":e.opera?"O":e.ie?"ms":"",b=e.cssVendor="-"+d+"-",k=h.createElement("div"),u=k.style,r=void 0!=u[d+"Transform"];if(d=void 0!=u[d+"Perspective"])k.id="test3d",u=h.createElement("style"),u.textContent="@media ("+b+"transform-3d){#test3d{height:3px}}",h.head.appendChild(u),c.appendChild(k),d=3==k.offsetHeight,h.head.removeChild(u),c.removeChild(k);e.supportTransform=r;e.supportTransform3D=d;return e}(),event:function(){var e="ontouchstart"in g;return{POINTER_START:e?"touchstart":"mousedown",POINTER_MOVE:e?
"touchmove":"mousemove",POINTER_END:e?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElementRect:function(e){try{var d=e.getBoundingClientRect()}catch(a){d={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}var b=(g.pageXOffset||c.scrollLeft)-(c.clientLeft||0)||0,k=(g.pageYOffset||c.scrollTop)-(c.clientTop||0)||0,u=g.getComputedStyle?getComputedStyle(e):e.currentStyle,r=
parseInt;e=r(u.paddingLeft)+r(u.borderLeftWidth)||0;var p=r(u.paddingTop)+r(u.borderTopWidth)||0,f=r(u.paddingRight)+r(u.borderRightWidth)||0,u=r(u.paddingBottom)+r(u.borderBottomWidth)||0,r=d.top||0,h=d.left||0;return{left:h+b+e,top:r+k+p,width:d.right-f-h-e,height:d.bottom-u-r-p}},createElement:function(e,d){var b=h.createElement(e),k,a,c;for(k in d)if(a=d[k],"style"===k)for(c in a)b.style[c]=a[c];else b[k]=a;return b},getElement:function(e){return h.getElementById(e)},setElementStyleByView:function(e){var d=
e.drawable,b=d.domElement.style,k=e._stateCache||(e._stateCache={}),a=f.browser.jsVendor,c=!1;this.cacheStateIfChanged(e,["visible"],k)&&(b.display=e.visible?"":"none");this.cacheStateIfChanged(e,["alpha"],k)&&(b.opacity=e.alpha);if(e.visible&&!(0>=e.alpha)){this.cacheStateIfChanged(e,["width"],k)&&(b.width=e.width+"px");this.cacheStateIfChanged(e,["height"],k)&&(b.height=e.height+"px");this.cacheStateIfChanged(e,["depth"],k)&&(b.zIndex=e.depth+1);if(c=this.cacheStateIfChanged(e,["pivotX","pivotY"],
k))b[a+"TransformOrigin"]=e.pivotX+"px "+e.pivotY+"px";if(this.cacheStateIfChanged(e,["x","y","rotation","scaleX","scaleY"],k)||c)b[a+"Transform"]=this.getTransformCSS(e);this.cacheStateIfChanged(e,["background"],k)&&(b.backgroundColor=e.background);b.pointerEvents||(b.pointerEvents="none");if(c=d.image)if(c=c.src,c!==k.image&&(k.image=c,b.backgroundImage="url("+c+")"),c=d.rect)d=c[0],c=c[1],d!==k.sx&&(k.sx=d,b.backgroundPositionX=-d+"px"),c!==k.sy&&(k.sy=c,b.backgroundPositionY=-c+"px");if(e=e.mask)if(d=
e.drawable.domElement.style.backgroundImage,d!==k.maskImage&&(k.maskImage=d,b[a+"MaskImage"]=d,b[a+"MaskRepeat"]="no-repeat"),d=e.x,e=e.y,d!==k.maskX||e!==k.maskY)k.maskX=d,k.maskY=e,b[a+"MaskPosition"]=d+"px "+e+"px"}},cacheStateIfChanged:function(a,d,b){var k,c,r,p,f=!1;k=0;for(c=d.length;k<c;k++)r=d[k],p=a[r],p!=b[r]&&(b[r]=p,f=!0);return f},getTransformCSS:function(a){var d=this.browser.supportTransform3D,b=d?"3d":"";return"translate"+b+"("+(a.x-a.pivotX)+"px, "+(a.y-a.pivotY)+(d?"px, 0px)":"px)")+
"rotate"+b+(d?"(0, 0, 1, ":"(")+a.rotation+"deg)scale"+b+"("+a.scaleX+", "+a.scaleY+(d?", 1)":")")}}}();f.undefined=void 0;g.Hilo=f})(window);(function(g){g=g.Hilo;var f=function(){var f=function(b){var d={},a,p;for(a in b)p=b[a],c.hasOwnProperty(a)?c[a].call(this,p):d[a]=p;e(this.prototype,d)},c={Extends:function(b){var d=this.prototype,c=a(b.prototype);e(this,b);e(c,d);c.constructor=this;this.prototype=c;this.superclass=b.prototype},Mixes:function(b){b instanceof Array||(b=[b]);for(var d=this.prototype,a;a=b.shift();)e(d,a.prototype||a)},Statics:function(b){e(this,b)}},a=function(){if(Object.__proto__)return function(b){return{__proto__:b}};
var b=function(){};return function(d){b.prototype=d;return new b}}(),e=function(d){for(var a=1,e=arguments.length;a<e;a++){var c=arguments[a],f,h;for(h in c){var g=c[h];!g||"object"!==typeof g||void 0===g.value&&"function"!==typeof g.get&&"function"!==typeof g.set?d[h]=g:(f=f||{},f[h]=g)}f&&b(d,f)}return d};try{var d=Object.defineProperty,b=Object.defineProperties;d({},"$",{value:0})}catch(k){"__defineGetter__"in Object&&(d=function(b,d,a){"value"in a&&(b[d]=a.value);"get"in a&&b.__defineGetter__(d,
a.get);"set"in a&&b.__defineSetter__(d,a.set);return b},b=function(b,a){for(var k in a)a.hasOwnProperty(k)&&d(b,k,a[k]);return b})}return{create:function(b){b=b||{};var a=b.hasOwnProperty("constructor")?b.constructor:function(){};f.call(a,b);return a},mix:e}}();g.Class=f})(window);(function(g){var f=g.Hilo,h=f.Class.create({constructor:function(a,e,d){this.type=a;this.target=e;this.detail=d;this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}});if(g=g.Event){g=g.prototype;var c=g.stopImmediatePropagation;g.stopImmediatePropagation=function(){c&&c.call(this);this._stopped=!0}}f.Event={_listeners:null,on:function(a,e,d){var b=this._listeners=this._listeners||{};a=b[a]=b[a]||[];for(var b=0,k=a.length;b<k;b++)if(a[b].listener===
e)return;a.push({listener:e,once:d});return this},off:function(a,e){if(0==arguments.length)return this._listeners=null,this;var d=this._listeners&&this._listeners[a];if(d){if(1==arguments.length)return delete this._listeners[a],this;for(var b=0,k=d.length;b<k;b++)if(d[b].listener===e){d.splice(b,1);0===d.length&&delete this._listeners[a];break}}return this},fire:function(a,e){var d,b;"string"===typeof a?b=a:(d=a,b=a.type);var k=this._listeners;if(!k)return!1;var c=k[b];if(c){c=c.slice(0);d=d||new h(b,
this,e);if(d._stopped)return!1;for(var r=0;r<c.length;r++){var p=c[r];p.listener.call(this,d);p.once&&c.splice(r--,1)}0==c.length&&delete k[b];return!0}return!1}}})(window);(function(g){g=g.Hilo;var f=g.Class.create({constructor:function(f,c,a,e,d,b){this.a=f;this.b=c;this.c=a;this.d=e;this.tx=d;this.ty=b},concat:function(f){var c=arguments,a=this.a,e=this.b,d=this.c,b=this.d,k=this.tx,u=this.ty;if(6<=c.length)var r=c[0],p=c[1],g=c[2],q=c[3],n=c[4],c=c[5];else r=f.a,p=f.b,g=f.c,q=f.d,n=f.tx,c=f.ty;this.a=a*r+e*g;this.b=a*p+e*q;this.c=d*r+b*g;this.d=d*p+b*q;this.tx=k*r+u*g+n;this.ty=k*p+u*q+c;return this},rotate:function(f){var c=Math.sin(f);f=Math.cos(f);var a=this.a,
e=this.b,d=this.c,b=this.d,k=this.tx,u=this.ty;this.a=a*f-e*c;this.b=a*c+e*f;this.c=d*f-b*c;this.d=d*c+b*f;this.tx=k*f-u*c;this.ty=k*c+u*f;return this},scale:function(f,c){this.a*=f;this.d*=c;this.c*=f;this.b*=c;this.tx*=f;this.ty*=c;return this},translate:function(f,c){this.tx+=f;this.ty+=c;return this},identity:function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this},invert:function(){var f=this.a,c=this.b,a=this.c,e=this.d,d=this.tx,b=f*e-c*a;this.a=e/b;this.b=-c/b;this.c=-a/b;this.d=
f/b;this.tx=(a*this.ty-e*d)/b;this.ty=-(f*this.ty-c*d)/b;return this},transformPoint:function(f,c,a){var e=f.x*this.a+f.y*this.c+this.tx,d=f.x*this.b+f.y*this.d+this.ty;c&&(e=e+.5>>0,d=d+.5>>0);if(a)return{x:e,y:d};f.x=e;f.y=d;return f}});g.Matrix=f})(window);(function(g){var f=g.Hilo,h=f.Class.create({constructor:function(c){this._targetFPS=c||30;this._interval=1E3/this._targetFPS;this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(c){if(!this._intervalId){this._lastTime=+new Date;var a=this,e=this._interval,d=g.requestAnimationFrame||g[f.browser.jsVendor+"RequestAnimationFrame"];if(c&&d)var b=function(){a._tick()},k=function(){a._intervalId=setTimeout(k,
e);d(b)};else k=function(){a._intervalId=setTimeout(k,e);a._tick()};k()}},stop:function(){clearTimeout(this._intervalId);this._intervalId=null;this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var c=+new Date,a=c-this._lastTime,e=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1E3/(this._tickTime/this._tickCount)+.5>>0,this._tickTime=this._tickCount=0):this._tickTime+=c-this._lastTime;this._lastTime=c;for(var c=
0,d=e.length;c<d;c++)e[c].tick(a)}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(c){if(!c||"function"!=typeof c.tick)throw Error("Ticker: The tick object must implement the tick method.");this._tickers.push(c)},removeTick:function(c){var a=this._tickers;c=a.indexOf(c);0<=c&&a.splice(c,1)}});f.Ticker=h})(window);(function(g){var f=g.Hilo,h=f.Class.create({constructor:function(c){this.init(c)},image:null,rect:null,init:function(c){var a=this,e=a.image;h.isDrawable(c)?a.image=c:f.copy(a,c,!0);c=a.image;if("string"===typeof c)if(e&&c===e.getAttribute("src"))c=a.image=e;else{a.image=null;var d=new Image;d.onload=function(){d.onload=null;a.init(d)};d.src=c;return}c&&!a.rect&&(a.rect=[0,0,c.width,c.height])},Statics:{isDrawable:function(c){if(!c||!c.tagName)return!1;c=c.tagName.toLowerCase();return"img"===c||"canvas"===
c||"video"===c}}});f.Drawable=h})(window);(function(g){var f=g.Hilo,h=f.Class.create({load:function(c){var a=c.src,e="jsonp"==c.type;if(e){var d=c.callbackName||"callback",b=c.callback||"jsonp"+ ++h._count;g[b]||(g[b]=function(a){delete g[b]})}e&&(a+=(-1==a.indexOf("?")?"?":"&")+d+"="+b);c.noCache&&(a+=(-1==a.indexOf("?")?"?":"&")+"t="+ +new Date);e=document.createElement("script");e.type="text/javascript";e.async=!0;e.onload=this.onLoad.bind(this);e.onerror=this.onError.bind(this);e.src=a;c.id&&(e.id=c.id);document.getElementsByTagName("head")[0].appendChild(e)},
onLoad:function(c){c=c.target;c.onload=c.onerror=null;return c},onError:function(c){var a=c.target;a.onload=a.onerror=null;return c},Statics:{_count:0}});f.ScriptLoader=h})(window);(function(g){var f=g.Hilo,h=f.Class.create({load:function(c){var a=this,e=new Image;c.crossOrigin&&(e.crossOrigin=c.crossOrigin);e.onload=function(){a.onLoad(e)};e.onerror=e.onabort=a.onError.bind(e);e.src=c.src+(c.noCache?(-1==c.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(c){c=c||g.event;c.onload=c.onerror=c.onabort=null;return c},onError:function(c){var a=c.target;a.onload=a.onerror=a.onabort=null;return c}});f.ImageLoader=h})(window);(function(g){g=g.Hilo;var f=g.ImageLoader,h=g.ScriptLoader,c=g.Class.create({Mixes:g.Event,constructor:function(a){this._source=[];this.add(a)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(a){a&&(a=a instanceof Array?a:[a],this._source=this._source.concat(a));return this},get:function(a){if(a)for(var e=this._source,d=0;d<e.length;d++){var b=e[d];if(b.id===a||b.src===a)return b}return null},getContent:function(a){return(a=this.get(a))&&a.content},start:function(){this._loadNext();
return this},_loadNext:function(){var a=this,e=a._source,d=e.length;if(a._loaded>=d)a.fire("complete");else if(a._currentIndex<d-1&&a._connections<a.maxConnections){var b=++a._currentIndex,e=e[b],k=a._getLoader(e);if(k){var c=k.onLoad,r=k.onError;k.onLoad=function(d){k.onLoad=c;k.onError=r;d=c&&c.call(k,d)||d.target;a._onItemLoad(b,d)};k.onError=function(d){k.onLoad=c;(k.onError=r)&&r.call(k,d);a._onItemError(b,d)};a._connections++}a._loadNext();k&&k.load(e)}},_getLoader:function(a){var e=a.loader;
if(e)return e;var d;if(!(d=a.type)){var b;if(a=a.src.match(/\/?[^/]+\.(\w+)(\?\S+)?$/i))b=a[1].toLowerCase();d=b||null}switch(d){case "png":case "jpg":case "jpeg":case "gif":e=new f;break;case "js":case "jsonp":e=new h}return e},_onItemLoad:function(a,e){var d=this._source[a];d.loaded=!0;d.content=e;this._connections--;this._loaded++;this.fire("load",d);this._loadNext()},_onItemError:function(a,e){var d=this._source[a];d.error=e;this._connections--;this._loaded++;this.fire("error",d);this._loadNext()},
getSize:function(a){for(var e=0,d=this._source,b=0;b<d.length;b++)var k=d[b],e=e+((a?k.loaded&&k.size:k.size)||0);return e},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});g.LoadQueue=c})(window);(function(g){var f=g.Hilo;g=f.Class.create({Mixes:f.Event,constructor:function(g){f.copy(this,g,!0);this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element)try{var f=this._element=new Audio;f.addEventListener("canplaythrough",this._onAudioEvent,!1);f.addEventListener("ended",this._onAudioEvent,!1);f.addEventListener("error",this._onAudioEvent,!1);f.src=this.src;f.volume=this.volume;
f.load()}catch(c){f=this._element={},f.play=f.pause=function(){}}return this},_onAudioEvent:function(f){var c=f.type;switch(c){case "canplaythrough":f.target.removeEventListener(c,this._onAudioEvent);this.loaded=!0;this.duration=this._element.duration;this.fire("load");this.autoPlay&&this._doPlay();break;case "ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case "error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),
this.playing=!0)},play:function(){this.playing&&this.stop();this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._element.pause(),this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1);return this},setVolume:function(f){this.volume!=f&&(this.volume=f,this._element.volume=f);return this},setMute:function(f){this.muted!=
f&&(this.muted=f,this._element.volume=f?0:this.volume);return this},Statics:{isSupported:null!==g.Audio}});f.HTMLAudio=g})(window);(function(g){var f=g.Hilo,h=f.Class,c=f.Event,a=function(){var a=g.AudioContext||g.webkitAudioContext,d=a?new a:null;return h.create({Mixes:c,constructor:function(b){f.copy(this,b,!0);this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=d;this._gainNode=d.createGain?d.createGain():d.createGainNode();this._gainNode.connect(d.destination);this._onAudioEvent=
this._onAudioEvent.bind(this);this._onDecodeComplete=this._onDecodeComplete.bind(this);this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var b=new XMLHttpRequest;b.src=this.src;b.open("GET",this.src,!0);b.responseType="arraybuffer";b.onload=this._onAudioEvent;b.onprogress=this._onAudioEvent;b.onerror=this._onAudioEvent;b.send();this._buffer=!0}return this},_onAudioEvent:function(b){switch(b.type){case "load":b=b.target;b.onload=b.onprogress=b.onerror=null;this._context.decodeAudioData(b.response,
this._onDecodeComplete,this._onDecodeError);break;case "ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case "progress":this.fire(b);break;case "error":this.fire(b)}},_onDecodeComplete:function(b){this._buffer=b;this.loaded=!0;this.duration=b.duration;this.fire("load");this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var b=this._context.createBufferSource();b.start||(b.start=b.noteOn,b.stop=b.noteOff);b.buffer=
this._buffer;b.onended=this._onAudioEvent;this._gainNode.gain.value=this.muted?0:this.volume;b.connect(this._gainNode);b.start(0,this._offset);this._audioNode=b;this._startTime=this._context.currentTime;this.playing=!0},_clearAudioNode:function(){var b=this._audioNode;b&&(b.onended=null,b.disconnect(0),this._audioNode=null)},play:function(){this.playing&&this.stop();this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._audioNode.stop(0),
this._offset+=this._context.currentTime-this._startTime,this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1);return this},setVolume:function(b){this.volume!=b&&(this.volume=b,this._gainNode.gain.value=b);return this},setMute:function(b){this.muted!=b&&(this.muted=b,this._gainNode.gain.value=b?0:this.volume);return this},Statics:{isSupported:null!=
a,enabled:!1,enable:function(){if(!this.enabled&&d){var b=d.createBufferSource();b.buffer=d.createBuffer(1,1,22050);b.connect(d.destination);b.start?b.start(0,0,0):b.noteOn(0,0,0);return this.enabled=!0}return this.enabled}}})}();f.WebAudio=a})(window);(function(g){var f=g.Hilo,h=f.HTMLAudio,c=f.WebAudio;f.WebSound={_audios:{},enableAudio:function(){c.isSupported&&c.enable()},getAudio:function(a){a=this._normalizeSource(a);var e=this._audios[a.src];e||(c.isSupported?e=new c(a):h.isSupported&&(e=new h(a)),this._audios[a.src]=e);return e},removeAudio:function(a){a="string"===typeof a?a:a.src;var e=this._audios[a];e&&(e.stop(),e.off(),this._audios[a]=null,delete this._audios[a])},_normalizeSource:function(a){var e={};"string"===typeof a?e={src:a}:
f.copy(e,a);return e}}})(window);(function(g){var f=g.Hilo;g=f.Class.create({constructor:function(g){g=g||{};f.copy(this,g,!0)},renderType:null,canvas:null,stage:null,startDraw:function(f){},draw:function(f){},endDraw:function(f){},transform:function(){},clear:function(f,c,a,e){},resize:function(f,c){}});f.Renderer=g})(window);(function(g){var f=g.Hilo,h=f.Class,c=f.Renderer,a=f.Drawable,e=function(){function d(b,a){var d=b.tagName||"div",e=a.image,c=b.width||e&&e.width,g=b.height||e&&e.height,q=f.createElement(d),h=q.style;b.id&&(q.id=b.id);h.position="absolute";h.left=(b.left||0)+"px";h.top=(b.top||0)+"px";h.width=c+"px";h.height=g+"px";if("canvas"==d)q.width=c,q.height=g,e&&(d=q.getContext("2d"),c=a.rect||[0,0,c,g],d.drawImage(e,c[0],c[1],c[2],c[3],b.x||0,b.y||0,b.width||c[2],b.height||c[3]));else{h.opacity=void 0!=
b.alpha?b.alpha:1;if(b===this.stage||b.clipChildren)h.overflow="hidden";e&&e.src&&(h.backgroundImage="url("+e.src+")",h.backgroundPosition=-(b.rectX||0)+"px "+-(b.rectY||0)+"px")}return q}return h.create({Extends:c,constructor:function(b){e.superclass.constructor.call(this,b)},renderType:"dom",startDraw:function(b){var k=b.drawable=b.drawable||new a,k=k.domElement=k.domElement||d(b,k);b.visible!=b._visible&&(k.style.display=b.visible?null:"none",b._visible=b.visible);return!0},draw:function(b){var d=
b.parent,a=b.drawable.domElement,e=a.parentNode;d?(d=d.drawable.domElement,d!=e&&d.appendChild(a),b.width||b.height||(a=b.drawable.rect)&&(a[2]||a[3])&&(b.width=a[2],b.height=a[3])):b!==this.stage||e||(a.style.overflow="hidden",this.canvas.appendChild(a))},transform:function(b){f.setElementStyleByView(b);if(b===this.stage){var a=this.canvas.style,d=b._scaleX,e=b._scaleY,c=b.scaleX,g=b.scaleY;if(!d&&1!=c||d&&d!=c)b._scaleX=c,a.width=c*b.width+"px";if(!e&&1!=g||e&&e!=g)b._scaleY=g,a.height=g*b.height+
"px"}},resize:function(b,a){var d=this.canvas.style;d.width=b+"px";d.height=a+"px";"absolute"!=d.position&&(d.position="relative")}})}();f.DOMRenderer=e})(window);(function(g){var f=g.Hilo,h=f.Matrix,c=Math.PI/180,a=f.Class.create({Extends:f.Renderer,Statics:{MAX_BATCH_NUM:2E3,ATTRIBUTE_NUM:5,isSupport:null},renderType:"webgl",gl:null,constructor:function(b){a.superclass.constructor.call(this,b);b=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl");this.maxBatchNum=a.MAX_BATCH_NUM;this.positionStride=4*a.ATTRIBUTE_NUM;var d=6*this.maxBatchNum;this.positions=new Float32Array(this.maxBatchNum*a.ATTRIBUTE_NUM*4);this.indexs=new Uint16Array(d);
for(var e=0,c=0;e<d;e+=6,c+=4)this.indexs[e+0]=c+0,this.indexs[e+1]=c+1,this.indexs[e+2]=c+2,this.indexs[e+3]=c+1,this.indexs[e+4]=c+2,this.indexs[e+5]=c+3;this.batchIndex=0;this.sprites=[];b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);b.clearColor(0,0,0,0);b.disable(b.DEPTH_TEST);b.disable(b.CULL_FACE);b.enable(b.BLEND);this._initShaders();this.defaultShader.active();this.positionBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,
this.indexs,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this.positionBuffer);b.bufferData(b.ARRAY_BUFFER,this.positions,b.DYNAMIC_DRAW);b.vertexAttribPointer(this.a_position,2,b.FLOAT,!1,this.positionStride,0);b.vertexAttribPointer(this.a_TexCoord,2,b.FLOAT,!1,this.positionStride,8);b.vertexAttribPointer(this.a_alpha,1,b.FLOAT,!1,this.positionStride,16)},context:null,startDraw:function(b){return b.visible&&0<b.alpha?(b===this.stage&&this.clear(),!0):!1},draw:function(b){var d=b.width,a=b.height,e=
b.background;(this.batchIndex>=this.maxBatchNum||e)&&this._renderBatches();var c=b.drawable;if(e=c&&c.image){e.texture||this.activeShader.uploadTexture(e);var c=c.rect,f=c[2],g=c[3];d||a||(d=b.width=f,a=b.height=g);c=this._createVertexs(e,c[0],c[1],f,g,-b.pivotX,-b.pivotY,d,a);d=this.batchIndex*this.positionStride;a=this.positions;f=b.__webglRenderAlpha;a[d+0]=c[0];a[d+1]=c[1];a[d+2]=c[2];a[d+3]=c[3];a[d+4]=f;a[d+5]=c[4];a[d+6]=c[5];a[d+7]=c[6];a[d+8]=c[7];a[d+9]=f;a[d+10]=c[8];a[d+11]=c[9];a[d+12]=
c[10];a[d+13]=c[11];a[d+14]=f;a[d+15]=c[12];a[d+16]=c[13];a[d+17]=c[14];a[d+18]=c[15];a[d+19]=f;c=b.__webglWorldMatrix;for(f=0;4>f;f++){var g=a[d+5*f],h=a[d+5*f+1];a[d+5*f]=c.a*g+c.c*h+c.tx;a[d+5*f+1]=c.b*g+c.d*h+c.ty}b.texture=e.texture;this.sprites[this.batchIndex++]=b}},endDraw:function(b){b===this.stage&&this._renderBatches()},transform:function(b){var d=b.drawable;if(d&&d.domElement)f.setElementStyleByView(b);else{var d=b.scaleX,a=b.scaleY;if(b===this.stage){var e=this.canvas.style,c=b._scaleX,
g=b._scaleY;if(!c&&1!=d||c&&c!=d)b._scaleX=d,e.width=d*b.width+"px";if(!g&&1!=a||g&&g!=a)b._scaleY=a,e.height=a*b.height+"px";b.__webglWorldMatrix=b.__webglWorldMatrix||new h(1,0,0,1,0,0)}else b.__webglWorldMatrix=b.__webglWorldMatrix||new h(1,0,0,1,0,0),this._setConcatenatedMatrix(b,b.parent);0<b.alpha&&(b.__webglRenderAlpha=b.parent&&b.parent.__webglRenderAlpha?b.alpha*b.parent.__webglRenderAlpha:b.alpha)}},clear:function(b,d,a,e){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},resize:function(b,d){if(this.width!==
b||this.height!==d)this.width=this.canvas.width=b,this.height=this.canvas.height=d,this.gl.viewport(0,0,b,d),this.canvasHalfWidth=.5*b,this.canvasHalfHeight=.5*d,this._uploadProjectionTransform(!0)},_renderBatches:function(){var b=this.gl;b.bufferSubData(b.ARRAY_BUFFER,0,this.positions.subarray(0,this.batchIndex*this.positionStride));for(var b=0,d=null,a=0;a<this.batchIndex;a++){var e=this.sprites[a];d&&d!==e.texture&&(this._renderBatch(b,a),b=a);d=e.texture}this._renderBatch(b,this.batchIndex);this.batchIndex=
0},_renderBatch:function(b,d){var a=this.gl,e=d-b;0<e&&(a.bindTexture(a.TEXTURE_2D,this.sprites[b].texture),a.drawElements(a.TRIANGLES,6*e,a.UNSIGNED_SHORT,12*b))},_uploadProjectionTransform:function(b){if(!this._projectionTransformElements||b)this._projectionTransformElements=new Float32Array([1/this.canvasHalfWidth,0,0,0,1/this.canvasHalfHeight,0,-1,1,1]);this.gl.uniformMatrix3fv(this.u_projectionTransform,!1,this._projectionTransformElements)},_initShaders:function(){this.defaultShader=new d(this,
{v:"attribute vec2 a_position;\nattribute vec2 a_TexCoord;\nattribute float a_alpha;\nuniform mat3 u_projectionTransform;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n    v_TexCoord = a_TexCoord;\n    v_alpha = a_alpha;\n}\n",f:"\nprecision mediump float;\nuniform sampler2D u_Sampler;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_alpha;\n}\n"},
{attributes:["a_position","a_TexCoord","a_alpha"],uniforms:["u_projectionTransform","u_Alpha","u_Sampler"]})},_createVertexs:function(b,d,a,e,c,f,g,h,t){var m=this.__tempVertexs||[],l=b.width;b=b.height;e/=l;c/=b;d/=l;a/=b;1<e+d&&(e=1-d);1<c+a&&(c=1-a);a=1-a-c;g=-t-g;l=0;m[l++]=f;m[l++]=g;m[l++]=d;m[l++]=a;m[l++]=f+h;m[l++]=g;m[l++]=d+e;m[l++]=a;m[l++]=f;m[l++]=g+t;m[l++]=d;m[l++]=a+c;m[l++]=f+h;m[l++]=g+t;m[l++]=d+e;m[l++]=a+c;return m},_setConcatenatedMatrix:function(b,d){var a=b.__webglWorldMatrix,
e=1,f=0,g=360-b.rotation%360,h=b.scaleX,n=b.scaleY;g&&(f=g*c,e=Math.cos(f),f=Math.sin(f));a.a=e*h;a.b=f*h;a.c=-f*n;a.d=e*n;a.tx=b.x;a.ty=-b.y;e=d.__webglWorldMatrix;a.concat(e.a,e.b,e.c,e.d,e.tx,e.ty)}}),e={},d=function(b,a,d){this.renderer=b;this.gl=b.gl;this.program=this._createProgram(this.gl,a.v,a.f);d=d||{};this.attributes=d.attributes||[];this.uniforms=d.uniforms||[]};d.prototype={active:function(){var b=this.renderer,d=this.gl,a=this.program;a&&d&&(b.activeShader=this,d.useProgram(a),this.attributes.forEach(function(e){b[e]=
d.getAttribLocation(a,e);d.enableVertexAttribArray(b[e])}),this.uniforms.forEach(function(e){b[e]=d.getUniformLocation(a,e)}),this.width!==b.width||this.height!==b.height)&&(this.width=b.width,this.height=b.height,b._uploadProjectionTransform())},uploadTexture:function(b){var d=this.gl,a=this.renderer;if(e[b.src])b.texture=e[b.src];else{var c=d.createTexture(),a=a.u_Sampler;d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,c);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,1);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
1);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,b);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.uniform1i(a,0);d.bindTexture(d.TEXTURE_2D,null);b.texture=c;e[b.src]=c}},_createProgram:function(b,d,a){d=this._createShader(b,b.VERTEX_SHADER,d);var e=this._createShader(b,b.FRAGMENT_SHADER,
a);if(!d||!e)return null;if(a=b.createProgram())if(b.attachShader(a,d),b.attachShader(a,e),b.linkProgram(a),b.deleteShader(e),b.deleteShader(d),!b.getProgramParameter(a,b.LINK_STATUS))return d=b.getProgramInfoLog(a),console.log("Failed to link program: "+d),b.deleteProgram(a),null;return a},_createShader:function(b,d,a){if(d=b.createShader(d))if(b.shaderSource(d,a),b.compileShader(d),!b.getShaderParameter(d,b.COMPILE_STATUS))return a=b.getShaderInfoLog(d),console.log("Failed to compile shader: "+
a),b.deleteShader(d),null;return d}};a.isSupport=function(){if(void 0===this._isSupport){var b=document.createElement("canvas");b.getContext&&(b.getContext("webgl")||b.getContext("experimental-webgl"))?this._isSupport=!0:this._isSupport=!1}return this._isSupport};f.WebGLRenderer=a})(window);(function(g){var f=g.Hilo,h=f.Class.create({Extends:f.Renderer,constructor:function(c){h.superclass.constructor.call(this,c);this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(c){return c.visible&&0<c.alpha?(c===this.stage&&this.clear(0,0,c.width,c.height),this.context.save(),!0):!1},draw:function(c){var a=this.context,e=c.width,d=c.height,b=c.background;b&&(a.fillStyle=b,a.fillRect(0,0,e,d));var k=c.drawable;if(b=k&&k.image){var k=k.rect,f=k[2],g=k[3],
p=k[4],h=k[5];f&&g&&(e||d||(e=c.width=f,d=c.height=g),(p||h)&&a.translate(p-.5*f,h-.5*g),a.drawImage(b,k[0],k[1],f,g,0,0,e,d))}},endDraw:function(c){this.context.restore()},transform:function(c){var a=c.drawable;if(a&&a.domElement)f.setElementStyleByView(c);else{var a=this.context,e=c.scaleX,d=c.scaleY;if(c===this.stage){var b=this.canvas.style,k=c._scaleX,g=c._scaleY;if(!k&&1!=e||k&&k!=e)c._scaleX=e,b.width=e*c.width+"px";if(!g&&1!=d||g&&g!=d)c._scaleY=d,b.height=d*c.height+"px"}else{var b=c.x,k=
c.y,g=c.pivotX,r=c.pivotY,p=c.rotation%360,h=c.mask;h&&(h._render(this),a.clip());if(h=c.align)if("function"===typeof h)c.align();else{var q=c.parent;if(q){var n=c.width,t=c.height,m=q.width,q=q.height;switch(h){case "TL":k=b=0;break;case "T":b=m-n>>1;k=0;break;case "TR":b=m-n;k=0;break;case "L":b=0;k=q-t>>1;break;case "C":b=m-n>>1;k=q-t>>1;break;case "R":b=m-n;k=q-t>>1;break;case "BL":b=0;k=q-t;break;case "B":b=m-n>>1;k=q-t;break;case "BR":b=m-n,k=q-t}}}0==b&&0==k||a.translate(b,k);0!=p&&a.rotate(p*
Math.PI/180);1==e&&1==d||a.scale(e,d);0==g&&0==r||a.translate(-g,-r)}0<c.alpha&&(a.globalAlpha*=c.alpha)}},clear:function(c,a,e,d){this.context.clearRect(c,a,e,d)},resize:function(c,a){this.canvas.width=c;this.canvas.height=a}});f.CanvasRenderer=h})(window);(function(g){var f=g.Hilo,h=f.Class,c=f.Event,a=f.Matrix;g=function(){function e(d,b,a){for(var e=d.length,c=b.length,f,g,h,n,t,m,l=0,v=f=0;v<e;v++){f=d[v];g=d[v<e-1?v+1:0];l=f.y-g.y;f=g.x-f.x;g=Math.sqrt(l*l+f*f);l/=g;f/=g;g=h=d[0].x*l+d[0].y*f;for(var x=1;x<e;x++)m=d[x].x*l+d[x].y*f,m>h?h=m:m<g&&(g=m);n=t=b[0].x*l+b[0].y*f;for(x=1;x<c;x++)m=b[x].x*l+b[x].y*f,m>t?t=m:m<n&&(n=m);g<n?(g=n-h,l=-l,f=-f):g-=t;if(0<=g)return!1;g>a.overlap&&(a.overlap=g,a.normal.x=l,a.normal.y=f)}return a}return h.create({Mixes:c,
constructor:function(d){d=d||{};this.id=this.id||d.id||f.getUid("View");f.copy(this,d,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,mask:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var d=this,b;b=d.parent;)d=b;return d.canvas?d:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(d,
b){"number"===typeof b?d.addChildAt(this,b):d.addChild(this);return this},removeFromParent:function(){var d=this.parent;d&&d.removeChild(this);return this},getBounds:function(){for(var d=this.width,b=this.height,a=this.getConcatenatedMatrix(),d=this.boundsArea||[{x:0,y:0},{x:d,y:0},{x:d,y:b},{x:0,y:b}],b=[],e,c,f,g,h,n,t,m=0,l=d.length;m<l;m++)e=a.transformPoint(d[m],!0,!0),c=e.x,f=e.y,0==m?(g=h=c,n=t=f):(g>c?g=c:h<c&&(h=c),n>f?n=f:t<f&&(t=f)),b[m]=e;b.x=g;b.y=n;b.width=h-g;b.height=t-n;return b},
getConcatenatedMatrix:function(d){for(var b=new a(1,0,0,1,0,0),e=this;e!=d&&e.parent;e=e.parent){var c=1,f=0,g=e.rotation%360,h=e.pivotX,q=e.pivotY,n=e.scaleX,t=e.scaleY;g&&(f=g*Math.PI/180,c=Math.cos(f),f=Math.sin(f));0!=h&&(b.tx-=h);0!=q&&(b.ty-=q);b.concat(c*n,f*n,-f*t,c*t,e.x,e.y)}return b},hitTestPoint:function(d,b,a){var e=this.getBounds(),c=d>=e.x&&d<=e.x+e.width&&b>=e.y&&b<=e.y+e.height;if(c&&a){a=0;for(var c=!1,f,g,h,n,t=0,m=e.length;t<m;t++){var l=e[t],v=e[(t+1)%m];if(l.y==v.y&&b==l.y&&
(l.x>v.x?(f=v.x,g=l.x):(f=l.x,g=v.x),d>=f&&d<=g)){c=!0;continue}l.y>v.y?(h=v.y,n=l.y):(h=l.y,n=v.y);if(!(b<h||b>n)){var x=(b-l.y)*(v.x-l.x)/(v.y-l.y)+l.x;x>d?a++:x==d&&(c=!0);l.x>d&&l.y==b&&(l=e[(m+t-1)%m],(l.y<b&&v.y>b||l.y>b&&v.y<b)&&a++)}}c=c||1==a%2}return c},hitTestObject:function(d,b){var a=this.getBounds(),c=d.getBounds(),f=a.x<=c.x+c.width&&c.x<=a.x+a.width&&a.y<=c.y+c.height&&c.y<=a.y+a.height;f&&b&&(f=(f=e(a,c,{overlap:-Infinity,normal:{x:0,y:0}}))?e(c,a,f):!1);return!!f},_render:function(d,
b){this.onUpdate&&!1===this.onUpdate(b)||!d.startDraw(this)||(d.transform(this),this.render(d,b),d.endDraw(this))},_fireMouseEvent:function(d){d.eventCurrentTarget=this;this.fire(d);if("mousemove"==d.type){if(!this.__mouseOver){this.__mouseOver=!0;var b=f.copy({},d);b.type="mouseover";this.fire(b)}}else"mouseout"==d.type&&(this.__mouseOver=!1);b=this.parent;d._stopped||d._stopPropagationed||!b||("mouseout"==d.type||"touchout"==d.type?b.hitTestPoint(d.stageX,d.stageY,!0)||b._fireMouseEvent(d):b._fireMouseEvent(d))},
onUpdate:null,render:function(d,b){d.draw(this)},toString:function(){return f.viewToString(this)}})}();f.View=g})(window);(function(g){var f=g.Hilo,h=f.Class.create({Extends:f.View,constructor:function(c){c=c||{};this.id=this.id||c.id||f.getUid("Container");h.superclass.constructor.call(this,c);this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(c,a){var e=this.children,d=e.length,b=c.parent;a=0>a?0:a>d?d:a;var f=this.getChildIndex(c);if(f==a)return this;0<=f?(e.splice(f,1),a=a==d?d-1:a):b&&
b.removeChild(c);e.splice(a,0,c);0>f?this._updateChildren(a):this._updateChildren(f<a?f:a,(f<a?a:f)+1);return this},addChild:function(c){for(var a=this.children.length,e=arguments,d=0,b=e.length;d<b;d++)this.addChildAt(e[d],a+d);return this},removeChildAt:function(c){var a=this.children;if(0>c||c>=a.length)return null;var e=a[c];if(e){var d=e.drawable,b=d&&d.domElement;if(b){var f=b.parentNode;f&&f.removeChild(b);d.domElement=null}e.parent=null;e.depth=-1}a.splice(c,1);this._updateChildren(c);return e},
removeChild:function(c){return this.removeChildAt(this.getChildIndex(c))},removeChildById:function(c){for(var a=this.children,e,d=0,b=a.length;d<b;d++)if(e=a[d],e.id===c)return this.removeChildAt(d),e;return null},removeAllChildren:function(){for(;this.children.length;)this.removeChildAt(0);return this},getChildAt:function(c){var a=this.children;return 0>c||c>=a.length?null:a[c]},getChildById:function(c){for(var a=this.children,e,d=0,b=a.length;d<b;d++)if(e=a[d],e.id===c)return e;return null},getChildIndex:function(c){return this.children.indexOf(c)},
setChildIndex:function(c,a){var e=this.children,d=e.indexOf(c);if(0<=d&&d!=a){var b=e.length;a=0>a?0:a>=b?b-1:a;e.splice(d,1);e.splice(a,0,c);this._updateChildren()}return this},swapChildren:function(c,a){var e=this.children,d=this.getChildIndex(c),b=this.getChildIndex(a);c.depth=b;e[b]=c;a.depth=d;e[d]=a},swapChildrenAt:function(c,a){var e=this.children,d=this.getChildAt(c),b=this.getChildAt(a);d.depth=a;e[a]=d;b.depth=c;e[c]=b},sortChildren:function(c){var a=this.children;if("string"==typeof c){var e=
c;c=function(d,b){return b[e]-d[e]}}a.sort(c);this._updateChildren()},_updateChildren:function(c,a){var e=this.children,d;a=a||e.length;for(var b=c||0;b<a;b++)d=e[b],d.depth=b+1,d.parent=this},contains:function(c){for(;c=c.parent;)if(c===this)return!0;return!1},getViewAtPoint:function(c,a,e,d,b){for(var f=d?[]:null,g=this.children,h,p,w=g.length-1;0<=w;w--)if(h=g[w],!(!h||!h.visible||0>=h.alpha||b&&!h.pointerEnabled))if(h.children&&h.children.length&&(!b||h.pointerChildren)&&(p=h.getViewAtPoint(c,
a,e,d,b)),p)if(d)p.length&&(f=f.concat(p));else return p;else if(h.hitTestPoint(c,a,e))if(d)f.push(h);else return h;return d&&f.length?f:null},render:function(c,a){h.superclass.render.call(this,c,a);var e=this.children.slice(0),d,b,f;d=0;for(b=e.length;d<b;d++)f=e[d],f.parent===this&&f._render(c,a)}});f.Container=h})(window);(function(g){var f=g.Hilo,h=f.CanvasRenderer,c=f.DOMRenderer,a=f.WebGLRenderer,e=f.Class.create({Extends:f.Container,constructor:function(d){d=d||{};this.id=this.id||d.id||f.getUid("Stage");e.superclass.constructor.call(this,d);this._initRenderer(d);var b=this.width,a=this.height,c=this.updateViewport();d.width||(b=c&&c.width||320);d.height||(a=c&&c.height||480);this.resize(b,a,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(d){var b=d.canvas,e=d.container;d=d.renderType||
"canvas";"string"===typeof b&&(b=f.getElement(b));"string"===typeof e&&(e=f.getElement(e));b?b.getContext||(d="dom"):b=f.createElement("dom"===d?"div":"canvas",{style:{position:"absolute"}});this.canvas=b;e&&e.appendChild(b);b={canvas:b,stage:this};switch(d){case "dom":this.renderer=new c(b);break;case "webgl":a.isSupport()?this.renderer=new a(b):this.renderer=new h(b);break;default:this.renderer=new h(b)}},addTo:function(d){var b=this.canvas;b.parentNode!==d&&d.appendChild(b);return this},tick:function(d){this.paused||
this._render(this.renderer,d)},enableDOMEvent:function(d,b){var a=this,e=a.canvas,c="string"===typeof d?[d]:d;b=!1!==b;for(var f=a._domListener||(a._domListener=function(b){a._onDOMEvent(b)}),g=0;g<c.length;g++)d=c[g],b?e.addEventListener(d,f,!1):e.removeEventListener(d,f);return a},_onDOMEvent:function(d){var b=d.type,a=0==b.indexOf("touch"),e=d;if(a)var c=d.touches,e=d.changedTouches,e=c&&c.length?c[0]:e&&e.length?e[0]:null;var c=e.pageX||e.clientX,e=e.pageY||e.clientY,g=this.viewport||this.updateViewport();
d.stageX=c=(c-g.left)/this.scaleX;d.stageY=e=(e-g.top)/this.scaleY;d.stopPropagation=function(){this._stopPropagationed=!0};var c=this.getViewAtPoint(c,e,!0,!1,!0)||this,e=this.canvas,g=this._eventTarget,h="mouseout"===b;if(g&&(!(g==c||g.contains&&g.contains(c))||h)){if(h="touchmove"===b?"touchout":"mousemove"===b||h||!c?"mouseout":null){var q=f.copy({},d);q.type=h;q.eventTarget=g;g._fireMouseEvent(q)}d.lastEventTarget=g;this._eventTarget=null}c&&c.pointerEnabled&&"mouseout"!==b&&(d.eventTarget=this._eventTarget=
c,c._fireMouseEvent(d));a||(e.style.cursor=c&&c.pointerEnabled&&c.useHandCursor?"pointer":"");f.browser.android&&"touchmove"===b&&d.preventDefault()},updateViewport:function(){var a=this.canvas,b=null;a.parentNode&&(b=this.viewport=f.getElementRect(a));return b},resize:function(a,b,e){if(e||this.width!==a||this.height!==b)this.width=a,this.height=b,this.renderer.resize(a,b),this.updateViewport()}});f.Stage=e})(window);(function(g){var f=g.Hilo,h=f.Drawable,c=f.Class.create({Extends:f.View,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("Bitmap");c.superclass.constructor.call(this,a);this.drawable=new h(a);if(!this.width||!this.height)if(a=this.drawable.rect)this.width=a[2],this.height=a[3]},setImage:function(a,e){this.drawable.init({image:a,rect:e});e&&(this.width=e[2],this.height=e[3]);return this}});f.Bitmap=c})(window);(function(g){var f=g.Hilo,h=f.Drawable,c=f.Class.create({Extends:f.View,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("Sprite");c.superclass.constructor.call(this,a);this._frames=[];this._frameNames={};this.drawable=new h;a.frames&&this.addFrame(a.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(a,e){var d=null!=e?e:this._frames.length;
if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this.setFrame(a[b],d+b);else this.setFrame(a,d);return this},setFrame:function(a,e){var d=this._frames,b=d.length;e=0>e?0:e>b?b:e;d[e]=a;a.name&&(this._frameNames[a.name]=a);if(0==e&&!this.width||!this.height)this.width=a.rect[2],this.height=a.rect[3];return this},getFrame:function(a){if("number"===typeof a){var e=this._frames;return 0>a||a>=e.length?null:e[a]}return this._frameNames[a]},getFrameIndex:function(a){var e=this._frames,d=e.length,b=
-1;if("number"===typeof a)b=a;else if(a="string"===typeof a?this._frameNames[a]:a)for(var c=0;c<d;c++)if(a===e[c]){b=c;break}return b},play:function(){this.paused=!1;return this},stop:function(){this.paused=!0;return this},"goto":function(a,e){var d=this._frames.length,b=this.getFrameIndex(a);this.currentFrame=0>b?0:b>=d?d-1:b;this.paused=e;this._firstRender=!0;return this},_render:function(a,e){var d=this.currentFrame,b;this._firstRender?(b=d,this._firstRender=!1):b=this._nextFrame(e);b!=d&&(this.currentFrame=
b,(d=this._frames[b].callback)&&d.call(this));if(this.onEnterFrame)this.onEnterFrame(b);this.drawable.init(this._frames[b]);c.superclass._render.call(this,a,e)},_nextFrame:function(a){var e=this._frames,d=e.length,b=this.currentFrame,e=e[b],c=this._frameElapsed;a=0!=b||this.drawable?c+(this.timeBased?a:1):0;c=this._frameElapsed=a<(e.duration||this.interval)?a:0;(e.stop||!this.loop&&b>=d-1)&&this.stop();this.paused||0!=c||(null!=e.next?b=this.getFrameIndex(e.next):b>=d-1?b=0:this.drawable&&b++);return b},
setFrameCallback:function(a,e){if(a=this.getFrame(a))a.callback=e;return this},onEnterFrame:null});f.Sprite=c})(window);(function(g){var f=g.Hilo,h=f.Drawable,c=f.Class.create({Extends:f.View,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("Button");c.superclass.constructor.call(this,a);this.drawable=new h(a);this.setState(c.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(a){this.enabled!=a&&(a?this.setState(c.UP):this.setState(c.DISABLED));return this},setState:function(a){if(this.state!==a){this.state=a;this.pointerEnabled=
this.enabled=a!==c.DISABLED;var e;switch(a){case c.UP:e=this.upState;break;case c.OVER:e=this.overState;break;case c.DOWN:e=this.downState;break;case c.DISABLED:e=this.disabledState}e&&(this.drawable.init(e),f.copy(this,e,!0))}return this},fire:function(a,e){if(this.enabled){switch("string"===typeof a?a:a.type){case "mousedown":case "touchstart":case "touchmove":this.setState(c.DOWN);break;case "mouseover":this.setState(c.OVER);break;case "mouseup":this.overState?this.setState(c.OVER):this.upState&&
this.setState(c.UP);break;case "touchend":case "touchout":case "mouseout":this.setState(c.UP)}return c.superclass.fire.call(this,a,e)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});f.Button=c})(window);(function(g){var f=g.Hilo;g=f.Class;var h=f.View,c=f.createElement("canvas"),a=c&&c.getContext("2d"),e=g.create({Extends:h,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("Text");e.superclass.constructor.call(this,a);a.font||(this.font="12px arial");this._fontHeight=e.measureFontHeight(this.font)},text:null,color:"#000",textAlign:null,textVAlign:null,outline:!1,lineSpacing:0,maxWidth:200,font:null,textWidth:0,textHeight:0,cacheDirty:!0,cache:function(a){(a||this._cacheDirty||!this._cacheImage)&&
this.updateCache()},updateCache:function(){c.width=this.width;c.height=this.height;this._draw(a);this._cacheImage=new Image;this._cacheImage.src=c.toDataURL();this.drawable=this.drawable||new Drawable;this.drawable.init(this._cacheImage);this.cacheDirty=!1},setCacheDirty:function(a){this._cacheDirty=a},setFont:function(a){this.font!==a&&(this.font=a,this._fontHeight=e.measureFontHeight(a),this.setCacheDirty(!0));return this},render:function(a,b){if("canvas"===a.renderType)this._draw(a.context);else{if("dom"===
a.renderType){var e=this.drawable.domElement,c=e.style;c.font=this.font;c.textAlign=this.textAlign;c.color=this.color;c.width=this.width+"px";c.height=this.height+"px";c.lineHeight=this._fontHeight+this.lineSpacing+"px";e.innerHTML=this.text}else this.cache();a.draw(this)}},_draw:function(a){var b=this.text.toString();if(b){a.font=this.font;a.textAlign=this.textAlign;a.textBaseline="top";var e=b.split(/\r\n|\r|\n|<br(?:[ \/])*>/),c=0,f=0,g=this._fontHeight+this.lineSpacing,h,q,n,b=[];h=0;for(len=
e.length;h<len;h++)if(q=e[h],n=a.measureText(q).width,n<=this.maxWidth)b.push({text:q,y:f}),c<n&&(c=n),f+=g;else{n="";var t=0,m,l,v;l=0;for(wlen=q.length;l<wlen;l++)v=q[l],m=a.measureText(n+v).width,m>this.maxWidth?(b.push({text:n,y:f}),c<t&&(c=t),f+=g,n=v):(t=m,n+=v),l==wlen-1&&(b.push({text:n,y:f}),n!==v&&c<m&&(c=m),f+=g)}this.textWidth=c;this.textHeight=f;this.width||(this.width=c);this.height||(this.height=f);e=0;switch(this.textVAlign){case "middle":e=this.height-this.textHeight>>1;break;case "bottom":e=
this.height-this.textHeight}if(h=this.background)a.fillStyle=h,a.fillRect(0,0,this.width,this.height);this.outline?a.strokeStyle=this.color:a.fillStyle=this.color;for(h=0;h<b.length;h++)q=b[h],this._drawTextLine(a,q.text,e+q.y)}},_drawTextLine:function(a,b,e){var c=0,f=this.width;switch(this.textAlign){case "center":c=f>>1;break;case "right":case "end":c=f}this.outline?a.strokeText(b,c,e):a.fillText(b,c,e)},Statics:{measureFontHeight:function(a){var b=document.documentElement,e=f.createElement("div",
{style:{font:a,position:"absolute"},innerHTML:"M"});b.appendChild(e);a=e.offsetHeight;b.removeChild(e);return a}}});f.Text=e})(window);(function(g){var f=g.Hilo,h=f.Bitmap,c=f.Class.create({Extends:f.Container,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("BitmapText");c.superclass.constructor.call(this,a);if(a=a.text+"")this.text="",this.setText(a);this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(a){a=a.toString();var e=a.length;if(this.text!=a){this.text=a;var d,b,c,f=c=0,g=0;for(d=0;d<e;d++)if(b=a.charAt(d),b=this.glyphs[b])g=c+(0<c?this.letterSpacing:0),this.children[d]?
(c=this.children[d],c.setImage(b.image,b.rect)):(c=this._createBitmap(b),this.addChild(c)),c.x=g,c=g+b.rect[2],f=Math.max(f,b.rect[3]);for(d=this.children.length-1;d>=e;d--)this._releaseBitmap(this.children[d]),this.children[d].removeFromParent();this.width=c;this.height=f;this.setTextAlign();return this}},_createBitmap:function(a){var e;c._pool.length?(e=c._pool.pop(),e.setImage(a.image,a.rect)):e=new h({image:a.image,rect:a.rect});return e},_releaseBitmap:function(a){c._pool.push(a)},setTextAlign:function(a){this.textAlign=
a||this.textAlign;switch(this.textAlign){case "center":this.pivotX=.5*this.width;break;case "right":this.pivotX=this.width;break;default:this.pivotX=0}return this},hasGlyphs:function(a){var e=this.glyphs;if(!e)return!1;a=a.toString();var d=a.length,b;for(b=0;b<d;b++)if(!e[a.charAt(b)])return!1;return!0},Statics:{_pool:[],createGlyphs:function(a,e,d,b){var c=a.toString();d=d||c.length;var f=e.width/d;b=e.height/(b||1);var g={},h=0;for(a=a.length;h<a;h++)charStr=c.charAt(h),g[charStr]={image:e,rect:[h%
d*f,b*Math.floor(h/d),f,b]};return g}}});f.BitmapText=c})(window);(function(g){var f=g.Hilo,h=f.Drawable,c=f.Class.create({Extends:f.View,constructor:function(a){a=a||{};this.id=this.id||a.id||f.getUid("DOMElement");c.superclass.constructor.call(this,a);this.drawable=new h;(this.drawable.domElement=a.element||f.createElement("div")).id=this.id},_render:function(a,e){this.onUpdate&&!1===this.onUpdate(e)||(a.transform(this),this.visible&&0<this.alpha&&this.render(a,e))},render:function(a,e){var d=a.canvas;if(d.getContext){var b=this.depth,c=d.nextSibling,f;if(!this.drawable.domElement.parentNode){for(;c&&
3!=c.nodeType;){f=parseInt(c.style.zIndex)||0;if(0>=f||f>b)break;c=c.nextSibling}d.parentNode.insertBefore(this.drawable.domElement,c)}}else a.draw(this)}});f.DOMElement=c})(window);(function(g){g=g.Hilo;var f=g.Class,h=function(){function c(a,c){var d={image:a.image,rect:a.rect};c&&(d.name=c.name||null,d.duration=c.duration||0,d.stop=!!c.stop,d.next=c.next||null);return d}return f.create({constructor:function(a){var e;var d=a.frames;if(d){e=[];var b;if(d instanceof Array)for(var f=0,g=d.length;f<g;f++)b=d[f],e[f]={image:a.image,rect:b};else{b=d.frameWidth;for(var g=d.frameHeight,h=a.width/b|0,f=a.height/g|0,d=d.numFrames||h*f,f=0;f<d;f++)e[f]={image:a.image,rect:[f%h*b,(f/h|
0)*g,b,g]}}}else e=null;this._frames=e;var p;e=this._frames;if(a=a.sprites){var d={},w;for(p in a){f=a[p];if("number"===typeof f)b=c(e[f]);else if(f instanceof Array)for(b=[],g=0,h=f.length;g<h;g++){w=f[g];var q;"number"===typeof w?w=c(e[w]):(q=w.rect,"number"===typeof q&&(q=e[w.rect]),w=c(q,w));b[g]=w}else for(b=[],g=f.from;g<=f.to;g++)b[g-f.from]=c(e[g],f[g]);d[p]=b}p=d}else p=null;this._sprites=p},_frames:null,_sprites:null,getFrame:function(a){var c=this._frames;return c&&c[a]},getSprite:function(a){var c=
this._sprites;return c&&c[a]},Statics:{createSpriteFrames:function(a,c,d,b,f,g,h){if("[object Array]"===Object.prototype.toString.call(a)){c=[];for(var p=0,w=a.length;p<w;p++)c=c.concat(this.createSpriteFrames.apply(this,a[p]))}else{if("string"===typeof c){var q=c.split(",");c=[];for(var n=0,t=q.length;n<t;n++)if(w=q[n].split("-"),1==w.length)c.push(parseInt(w[0]));else for(p=parseInt(w[0]),w=parseInt(w[1]);p<=w;p++)c.push(p)}q=Math.floor(d.width/b);for(p=0;p<c.length;p++)n=c[p],c[p]={rect:[n%q*b,
f*Math.floor(n/q),b,f],image:d,duration:h};c[0].name=a;g?c[c.length-1].next=a:c[c.length-1].stop=!0}return c}}})}();g.TextureAtlas=h})(window);
