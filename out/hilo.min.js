(function(b){b.console=b.console||{log:function(){}};b=Array.prototype;var a=b.slice;b.indexOf=b.indexOf||function(g,j){j=j||0;var f=this.length,h;if(0==f||j>=f){return -1}0>j&&(j=f+j);for(h=j;h<f;h++){if(this[h]===g){return h}}return -1};b=Function.prototype;b.bind=b.bind||function(j){function l(){var c=k.concat(a.call(arguments));return g.apply(this instanceof l?this:j,c)}var g=this,k=a.call(arguments,1),h=function(){};h.prototype=g.prototype;l.prototype=new h;return l}})(window);(function(b){for(var a=0,d=["ms","moz","webkit","o"],f=0;f<d.length&&!b.requestAnimationFrame;++f){b.requestAnimationFrame=b[d[f]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[d[f]+"CancelAnimationFrame"]||b[d[f]+"CancelRequestAnimationFrame"]}b.requestAnimationFrame||(b.requestAnimationFrame=function(e,j){var h=(new Date).getTime(),c=Math.max(0,16-(h-a)),g=b.setTimeout(function(){e(h+c)},c);a=h+c;return g});b.cancelAnimationFrame||(b.cancelAnimationFrame=function(c){clearTimeout(c)})})(window);(function(b){var a=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.toColorRgb=function(){var c=this.toLowerCase();return c&&a.test(c)?4===c.length?{r:parseInt("0x"+c.charAt(1)+c.charAt(1)),g:parseInt("0x"+c.charAt(2)+c.charAt(2)),b:parseInt("0x"+c.charAt(3)+c.charAt(3))}:{r:parseInt("0x"+c.slice(1,3)),g:parseInt("0x"+c.slice(3,5)),b:parseInt("0x"+c.slice(5,7))}:{r:0,g:0,b:0}}})(window);(function(b){var a=function(){var f=document,g=f.documentElement,d=0;return{getUid:function(e){var c=++d;return e?e+"_"+c:c},copy:function(e,j,c){for(var h in j){if(!c||e.hasOwnProperty(h)||void 0!==e[h]){e[h]=j[h]}}return e},browser:function(){var c=navigator.userAgent,c={iphone:/iphone/i.test(c),ipad:/ipad/i.test(c),ipod:/ipod/i.test(c),ios:/iphone|ipad|ipod/i.test(c),android:/android/i.test(c),webkit:/webkit/i.test(c),chrome:/chrome/i.test(c),safari:/safari/i.test(c),firefox:/firefox/i.test(c),ie:/msie/i.test(c),opera:/opera/i.test(c),supportTouch:"ontouchstart" in b,supportCanvas:null!=f.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation" in b,supportDeviceMotion:"ondevicemotion" in b};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),c.supportStorage=!0}catch(e){}c.jsVendor=c.webkit?"webkit":c.firefox?"Moz":c.opera?"O":c.ie?"ms":"";c.cssVendor="-"+c.jsVendor+"-";return c}(),event:function(){var c="ontouchstart" in b;return{POINTER_START:c?"touchstart":"mousedown",POINTER_MOVE:c?"touchmove":"mousemove",POINTER_END:c?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElement:function(c){return f.getElementById(c)},getElementRect:function(s){try{var n=s.getBoundingClientRect()}catch(o){n={top:s.offsetTop,left:s.offsetLeft,width:s.offsetWidth,height:s.offsetHeight}}var p=(b.pageXOffset||g.scrollLeft)-(g.clientLeft||0)||0,l=(b.pageYOffset||g.scrollTop)-(g.clientTop||0)||0,j=b.getComputedStyle?b.getComputedStyle(s):s.currentStyle,c=parseInt;s=c(j.paddingLeft)+c(j.borderLeftWidth)||0;var t=c(j.paddingTop)+c(j.borderTopWidth)||0,w=c(j.paddingRight)+c(j.borderRightWidth)||0,j=c(j.paddingBottom)+c(j.borderBottomWidth)||0,c=n.top||0,m=n.left||0;return{left:m+p+s,top:c+l+t,width:n.right-w-m-s,height:n.bottom-j-c-t}},createElement:function(e,m){var c=f.createElement(e),h,l,j;for(h in m){if(l=m[h],"style"===h){for(j in l){c.style[j]=l[j]}}else{c[h]=l}}return c},setElementStyleByView:function(A,w){var z=a.browser.jsVendor,u=!1,j=A.parent,h=A.drawable,u=h.domElement,y=u.style,x=A._stateCache||(A._stateCache={});j&&(j=j.drawable&&j.drawable.domElement)&&j!=u.parentNode&&j.appendChild(u);this.cacheStateIfChanged(A,["visible"],x)&&(y.display=A.visible?"":"none");this.cacheStateIfChanged(A,["alpha"],x)&&(y.opacity=A.alpha);if(A.visible&&!(0>=A.alpha)){this.cacheStateIfChanged(A,["width"],x)&&(y.width=(A.width||0)+"px");this.cacheStateIfChanged(A,["height"],x)&&(y.height=(A.height||0)+"px");this.cacheStateIfChanged(A,["depth"],x)&&(y.zIndex=A.depth+1);this.cacheStateIfChanged(A,["clipChildren"],x)&&(y.overflow=A.clipChildren?"hidden":null);if(u=this.cacheStateIfChanged(A,["pivotX","pivotY"],x)){var j=A.pivotX,v=A.pivotY,o=h.rect;if(o){var s=o[2],n=o[3],B=o[4],o=o[5];if(B||o){j-=B-0.5*s,v-=o-0.5*n}}y[z+"TransformOrigin"]=j+"px "+v+"px"}if(this.cacheStateIfChanged(A,["x","y","rotation","scaleX","scaleY"],x)||u){y[z+"Transform"]="translate("+(A.x-A.pivotX)+"px, "+(A.y-A.pivotY)+"px)rotate("+A.rotation+"deg)scale("+A.scaleX+", "+A.scaleY+")"}if(w){y.pointerEvents="none"}else{if(y.pointerEvents||(y.pointerEvents="none"),this.cacheStateIfChanged(A,["background"],x)&&(y.backgroundColor=A.background),z=h.image){if(z=z.src,z!==x.image&&(x.image=z,y.backgroundImage="url("+z+")"),o=h.rect){h=o[0],z=o[1],h!==x.sx&&(x.sx=h,y.backgroundPositionX=-h+"px"),z!==x.sy&&(x.sy=z,y.backgroundPositionY=-z+"px")}}}}},cacheStateIfChanged:function(j,o,h){var l,n,m,s,p=!1;l=0;for(n=o.length;l<n;l++){m=o[l],s=j[m],s!=h[m]&&(h[m]=s,p=!0)}return p}}}();a.undefined=void 0;b.Hilo=a})(window);(function(b){b=b.Hilo;var a=function(){var m=function(c){var k={},d,p;for(d in c){p=c[d],o.hasOwnProperty(d)?o[d].call(this,p):k[d]=p}n(this.prototype,k)},o={Extends:function(d){var e=this.prototype,k=h(d.prototype);n(this,d);n(k,e);k.constructor=this;this.prototype=k;this.superclass=d.prototype},Mixes:function(c){c instanceof Array||(c=[c]);for(var e=this.prototype,d;d=c.shift();){n(e,d.prototype||d)}},Statics:function(c){n(this,c)}},h=function(){if(Object.__proto__){return function(d){return{__proto__:d}}}var c=function(){};return function(d){c.prototype=d;return new c}}(),n=function(r){for(var k=1,t=arguments.length;k<t;k++){var u=arguments[k],s,p;for(p in u){var q=u[p];!q||"object"!==typeof q||void 0===q.value&&"function"!==typeof q.get&&"function"!==typeof q.set?r[p]=q:(s=s||{},s[p]=q)}s&&g(r,s)}return r};try{var l=Object.defineProperty,g=Object.defineProperties;l({},"$",{value:0})}catch(j){"__defineGetter__" in Object&&(l=function(c,e,d){"value" in d&&(c[e]=d.value);"get" in d&&c.__defineGetter__(e,d.get);"set" in d&&c.__defineSetter__(e,d.set);return c},g=function(c,d){for(var e in d){d.hasOwnProperty(e)&&l(c,e,d[e])}return c})}return{create:function(c){c=c||{};var d=c.hasOwnProperty("constructor")?c.constructor:function(){};m.call(d,c);return d},mix:n}}();b.Class=a})(window);(function(b){var a=b.Hilo,d=a.Class.create({constructor:function(c,g,e){this.type=c;this.target=g;this.detail=e;this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}});if(b=b.Event){b=b.prototype;var f=b.stopImmediatePropagation;b.stopImmediatePropagation=function(){f&&f.call(this);this._stopped=!0}}a.Event={_listeners:null,on:function(e,j,h){var c=this._listeners=this._listeners||{};e=c[e]=c[e]||[];for(var c=0,g=e.length;c<g;c++){if(e[c].listener===j){return}}e.push({listener:j,once:h});return this},off:function(e,j){if(0==arguments.length){return this._listeners=null,this}var h=this._listeners&&this._listeners[e];if(h){if(1==arguments.length){return delete this._listeners[e],this}for(var c=0,g=h.length;c<g;c++){if(h[c].listener===j){h.splice(c,1);0===h.length&&delete this._listeners[e];break}}}return this},fire:function(g,n){var m,e;"string"===typeof g?e=g:(m=g,e=g.type);var j=this._listeners;if(!j){return !1}var l=j[e];if(l){l=l.slice(0);m=m||new d(e,this,n);if(m._stopped){return !1}for(var o=0;o<l.length;o++){var h=l[o];h.listener.call(this,m);h.once&&l.splice(o--,1)}0==l.length&&delete j[e];return !0}return !1}}})(window);(function(b){b=b.Hilo;var a=b.Class.create({constructor:function(k,m,h,l,j,g){this.a=k;this.b=m;this.c=h;this.d=l;this.tx=j;this.ty=g},concat:function(u){var x=arguments,z=this.a,w=this.b,t=this.c,y=this.d,o=this.tx,l=this.ty;if(6<=x.length){var j=x[0],A=x[1],p=x[2],s=x[3],n=x[4],x=x[5]}else{j=u.a,A=u.b,p=u.c,s=u.d,n=u.tx,x=u.ty}this.a=z*j+w*p;this.b=z*A+w*s;this.c=t*j+y*p;this.d=t*A+y*s;this.tx=o*j+l*p+n;this.ty=o*A+l*s+x;return this},rotate:function(n){var p=Math.sin(n);n=Math.cos(n);var h=this.a,o=this.b,m=this.c,g=this.d,j=this.tx,l=this.ty;this.a=h*n-o*p;this.b=h*p+o*n;this.c=m*n-g*p;this.d=m*p+g*n;this.tx=j*n-l*p;this.ty=j*p+l*n;return this},scale:function(d,f){this.a*=d;this.d*=f;this.c*=d;this.b*=f;this.tx*=d;this.ty*=f;return this},translate:function(d,f){this.tx+=d;this.ty+=f;return this},identity:function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this},invert:function(){var k=this.a,m=this.b,h=this.c,l=this.d,j=this.tx,g=k*l-m*h;this.a=l/g;this.b=-m/g;this.c=-h/g;this.d=k/g;this.tx=(h*this.ty-l*j)/g;this.ty=-(k*this.ty-m*j)/g;return this},transformPoint:function(j,l,g){var k=j.x*this.a+j.y*this.c+this.tx,h=j.x*this.b+j.y*this.d+this.ty;l&&(k=k+0.5>>0,h=h+0.5>>0);if(g){return{x:k,y:h}}j.x=k;j.y=h;return j}});b.Matrix=a})(window);(function(b){var a=b.Hilo,c=a.Class.create({constructor:function(d){this._targetFPS=d||30;this._interval=1000/this._targetFPS;this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(m){if(!this._intervalId){this._lastTime=+new Date;var g=this,l=this._interval,j=b.requestAnimationFrame||b[a.browser.jsVendor+"RequestAnimationFrame"];if(m&&j){var e=function(){g._tick()},h=function(){g._intervalId=setTimeout(h,l);j(e)}}else{h=function(){g._intervalId=setTimeout(h,l);g._tick()}}h()}},stop:function(){clearTimeout(this._intervalId);this._intervalId=null;this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var j=+new Date,e=j-this._lastTime,h=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1000/(this._tickTime/this._tickCount)+0.5>>0,this._tickTime=this._tickCount=0):this._tickTime+=j-this._lastTime;this._lastTime=j;for(var j=0,g=h.length;j<g;j++){h[j].tick(e)}}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(d){if(!d||"function"!=typeof d.tick){throw Error("Ticker: The tick object must implement the tick method.")}this._tickers.push(d)},removeTick:function(e){var d=this._tickers;e=d.indexOf(e);0<=e&&d.splice(e,1)}});a.Ticker=c})(window);(function(b){var a=b.Hilo,c=a.Class.create({constructor:function(d){this.init(d)},image:null,rect:null,domElement:null,init:function(j){var e=this,h=e.image;c.isDrawable(j)?e.image=j:a.copy(e,j,!0);j=e.image;if("string"===typeof j){if(h&&j===h.getAttribute("src")){j=e.image=h}else{e.image=null;var g=new Image;g.onload=function(){g.onload=null;e.init(g)};g.src=j;return}}j&&!e.rect&&(e.rect=[0,0,j.width,j.height])},Statics:{isDrawable:function(d){if(!d||!d.tagName){return !1}d=d.tagName.toLowerCase();return"img"===d||"canvas"===d||"video"===d}}});a.Drawable=c})(window);(function(b){var a=b.Hilo,c=a.Class.create({load:function(k){var g=k.src,j="jsonp"==k.type;if(j){var h=k.callbackName||"callback",e=k.callback||"jsonp"+ ++c._count;b[e]||(b[e]=function(d){delete b[e]})}j&&(g+=(-1==g.indexOf("?")?"?":"&")+h+"="+e);k.noCache&&(g+=(-1==g.indexOf("?")?"?":"&")+"t="+ +new Date);j=document.createElement("script");j.type="text/javascript";j.async=!0;j.onload=this.onLoad.bind(this);j.onerror=this.onError.bind(this);j.src=g;k.id&&(j.id=k.id);document.getElementsByTagName("head")[0].appendChild(j)},onLoad:function(d){d=d.target;d.onload=d.onerror=null;return d},onError:function(e){var d=e.target;d.onload=d.onerror=null;return e},Statics:{_count:0}});a.ScriptLoader=c})(window);(function(b){var a=b.Hilo,c=a.Class.create({load:function(g){var e=this,f=new Image;g.crossOrigin&&(f.crossOrigin=g.crossOrigin);f.onload=function(){e.onLoad(f)};f.onerror=f.onabort=e.onError.bind(f);f.src=g.src+(g.noCache?(-1==g.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(d){d=d||b.event;d.onload=d.onerror=d.onabort=null;return d},onError:function(e){var d=e.target;d.onload=d.onerror=d.onabort=null;return e}});a.ImageLoader=c})(window);(function(b){b=b.Hilo;var a=b.ImageLoader,d=b.ScriptLoader,f=b.Class.create({Mixes:b.Event,constructor:function(c){this._source=[];this.add(c)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(c){c&&(c=c instanceof Array?c:[c],this._source=this._source.concat(c));return this},get:function(e){if(e){for(var h=this._source,g=0;g<h.length;g++){var c=h[g];if(c.id===e||c.src===e){return c}}}return null},getContent:function(c){return(c=this.get(c))&&c.content},start:function(){this._loadNext();return this},_loadNext:function(){var g=this,m=g._source,l=m.length;if(g._loaded>=l){g.fire("complete")}else{if(g._currentIndex<l-1&&g._connections<g.maxConnections){var e=++g._currentIndex,m=m[e],h=g._getLoader(m);if(h){var j=h.onLoad,n=h.onError;h.onLoad=function(c){h.onLoad=j;h.onError=n;c=j&&j.call(h,c)||c.target;g._onItemLoad(e,c)};h.onError=function(c){h.onLoad=j;(h.onError=n)&&n.call(h,c);g._onItemError(e,c)};g._connections++}g._loadNext();h&&h.load(m)}}},_getLoader:function(e){var h=e.loader;if(h){return h}var g;if(!(g=e.type)){var c;if(e=e.src.match(/\/?[^/]+\.(\w+)(\?\S+)?$/i)){c=e[1].toLowerCase()}g=c||null}switch(g){case"png":case"jpg":case"jpeg":case"gif":h=new a;break;case"js":case"jsonp":h=new d}return h},_onItemLoad:function(c,g){var e=this._source[c];e.loaded=!0;e.content=g;this._connections--;this._loaded++;this.fire("load",e);this._loadNext()},_onItemError:function(c,g){var e=this._source[c];e.error=g;this._connections--;this._loaded++;this.fire("error",e);this._loadNext()},getSize:function(e){for(var j=0,h=this._source,c=0;c<h.length;c++){var g=h[c],j=j+((e?g.loaded&&g.size:g.size)||0)}return j},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});b.LoadQueue=f})(window);(function(b){var a=b.Hilo;b=a.Class.create({Mixes:a.Event,constructor:function(c){a.copy(this,c,!0);this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element){try{var d=this._element=new Audio;d.addEventListener("canplaythrough",this._onAudioEvent,!1);d.addEventListener("ended",this._onAudioEvent,!1);d.addEventListener("error",this._onAudioEvent,!1);d.src=this.src;d.volume=this.volume;d.load()}catch(f){d=this._element={},d.play=d.pause=function(){}}}return this},_onAudioEvent:function(d){var f=d.type;switch(f){case"canplaythrough":d.target.removeEventListener(f,this._onAudioEvent);this.loaded=!0;this.duration=this._element.duration;this.fire("load");this.autoPlay&&this._doPlay();break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),this.playing=!0)},play:function(){this.playing&&this.stop();this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._element.pause(),this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1);return this},setVolume:function(c){this.volume!=c&&(this.volume=c,this._element.volume=c);return this},setMute:function(c){this.muted!=c&&(this.muted=c,this._element.volume=c?0:this.volume);return this},Statics:{isSupported:null!==b.Audio}});a.HTMLAudio=b})(window);(function(f){var d=f.Hilo,j=d.Class,k=d.Event,b=function(){var c=f.AudioContext||f.webkitAudioContext,e=c?new c:null;return j.create({Mixes:k,constructor:function(a){d.copy(this,a,!0);this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=e;this._gainNode=e.createGain?e.createGain():e.createGainNode();this._gainNode.connect(e.destination);this._onAudioEvent=this._onAudioEvent.bind(this);this._onDecodeComplete=this._onDecodeComplete.bind(this);this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var a=new XMLHttpRequest;a.src=this.src;a.open("GET",this.src,!0);a.responseType="arraybuffer";a.onload=this._onAudioEvent;a.onprogress=this._onAudioEvent;a.onerror=this._onAudioEvent;a.send();this._buffer=!0}return this},_onAudioEvent:function(a){switch(a.type){case"load":a=a.target;a.onload=a.onprogress=a.onerror=null;this._context.decodeAudioData(a.response,this._onDecodeComplete,this._onDecodeError);break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"progress":this.fire(a);break;case"error":this.fire(a)}},_onDecodeComplete:function(a){this._buffer=a;this.loaded=!0;this.duration=a.duration;this.fire("load");this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var a=this._context.createBufferSource();a.start||(a.start=a.noteOn,a.stop=a.noteOff);a.buffer=this._buffer;a.onended=this._onAudioEvent;this._gainNode.gain.value=this.muted?0:this.volume;a.connect(this._gainNode);a.start(0,this._offset);this._audioNode=a;this._startTime=this._context.currentTime;this.playing=!0},_clearAudioNode:function(){var a=this._audioNode;a&&(a.onended=null,a.disconnect(0),this._audioNode=null)},play:function(){this.playing&&this.stop();this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._audioNode.stop(0),this._offset+=this._context.currentTime-this._startTime,this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1);return this},setVolume:function(a){this.volume!=a&&(this.volume=a,this._gainNode.gain.value=a);return this},setMute:function(a){this.muted!=a&&(this.muted=a,this._gainNode.gain.value=a?0:this.volume);return this},Statics:{isSupported:null!=c,enabled:!1,enable:function(){if(!this.enabled&&e){var a=e.createBufferSource();a.buffer=e.createBuffer(1,1,22050);a.connect(e.destination);a.start?a.start(0,0,0):a.noteOn(0,0,0);return this.enabled=!0}return this.enabled}}})}();d.WebAudio=b})(window);(function(b){var a=b.Hilo,d=a.HTMLAudio,f=a.WebAudio;a.WebSound={_audios:{},enableAudio:function(){f.isSupported&&f.enable()},getAudio:function(c){c=this._normalizeSource(c);var e=this._audios[c.src];e||(f.isSupported?e=new f(c):d.isSupported&&(e=new d(c)),this._audios[c.src]=e);return e},removeAudio:function(c){c="string"===typeof c?c:c.src;var e=this._audios[c];e&&(e.stop(),e.off(),this._audios[c]=null,delete this._audios[c])},_normalizeSource:function(c){var e={};"string"===typeof c?e={src:c}:a.copy(e,c);return e}}})(window);(function(b){var a=b.Hilo;b=a.Class.create({constructor:function(c){c=c||{};a.copy(this,c,!0)},renderType:null,canvas:null,stage:null,startDraw:function(c){return !0},draw:function(c){},endDraw:function(c){},transform:function(){},clear:function(g,j,f,h){},resize:function(d,f){}});a.Renderer=b})(window);(function(j){var f=j.Hilo,k=f.Class,m=f.Renderer,b=f.Drawable,l=function(){return k.create({Extends:m,constructor:function(a){l.superclass.constructor.call(this,a)},renderType:"dom",startDraw:function(c){var a=c.drawable=c.drawable||new b;a.domElement=a.domElement||f.createElement("div",{style:{position:"absolute"}});return c.visible},draw:function(a){f.setElementStyleByView(a)},resize:function(e,c){var d=this.canvas.style;d.width=e+"px";d.height=c+"px";"absolute"!=d.position&&(d.position="relative")}})}();f.DOMRenderer=l})(window);(function(j){j=j.Hilo;var f=j.Matrix,k=Math.PI/180,m=j.Class.create({Extends:j.Renderer,Statics:{MAX_BATCH_NUM:2000,ATTRIBUTE_NUM:5,isSupport:null},renderType:"webgl",gl:null,constructor:function(g){m.superclass.constructor.call(this,g);g=this.gl=this.canvas.getContext("webgl",{stencil:!0})||this.canvas.getContext("experimental-webgl",{stencil:!0});g.blendFunc(g.ONE,g.ONE_MINUS_SRC_ALPHA);g.enable(g.BLEND);g.disable(g.CULL_FACE);g.disable(g.DEPTH_TEST);g.disable(g.STENCIL_TEST);this._initShaders();this.vertex2=new Float32Array(8);this.indexs2=new Uint16Array([0,1,2,1,2,3]);this.notextureShader.active();g.bufferData(g.ELEMENT_ARRAY_BUFFER,this.indexs2,g.STATIC_DRAW);g.bufferData(g.ARRAY_BUFFER,this.vertex2,g.STREAM_DRAW);this.maxBatchNum=m.MAX_BATCH_NUM;this.positionStride=4*m.ATTRIBUTE_NUM;var c=6*this.maxBatchNum;this.vertex=new Float32Array(this.maxBatchNum*m.ATTRIBUTE_NUM*4);this.indexs=new Uint16Array(c);for(var e=0,h=0;e<c;e+=6,h+=4){this.indexs[e+0]=h+0,this.indexs[e+1]=h+1,this.indexs[e+2]=h+2,this.indexs[e+3]=h+1,this.indexs[e+4]=h+2,this.indexs[e+5]=h+3}this.batchIndex=0;this.sprites=[];this.defaultShader.active();g.bufferData(g.ELEMENT_ARRAY_BUFFER,this.indexs,g.STATIC_DRAW);g.bufferData(g.ARRAY_BUFFER,this.vertex,g.STREAM_DRAW)},context:null,startDraw:function(a){return a.visible&&0<a.alpha?(a.__webglWorldMatrix=a.__webglWorldMatrix||new f(1,0,0,1,0,0),a.__webglRenderAlpha=a.__webglRenderAlpha||1,!0):!1},draw:function(h){var e=h.drawable,g=e&&e.image,n=h.background;(this.batchIndex>=this.maxBatchNum||n)&&this._renderBatches();if(h.clipChildren){this.stencilLevel=this.stencilLevel||0;var o=this.gl;0===this.stencilLevel?(o.enable(o.STENCIL_TEST),o.clear(o.STENCIL_BUFFER_BIT),o.stencilFunc(o.ALWAYS,1,255),o.stencilOp(o.KEEP,o.REPLACE,o.REPLACE)):o.stencilOp(o.KEEP,o.INCR,o.INCR);o.colorMask(!1,!1,!1,!1);this.notextureShader.active();this._renderBackground(h,{r:1,g:1,b:1});this.stencilLevel+=1;o.colorMask(!0,!0,!0,!0);o.stencilFunc(o.LEQUAL,this.stencilLevel,255);o.stencilOp(o.KEEP,o.KEEP,o.KEEP)}n&&(this.notextureShader.active(),this._renderBackground(h,n.toColorRgb()));g&&(this.defaultShader.active(),this._renderImage(h,g,e.rect))},endDraw:function(a){a===this.stage&&this._renderBatches();a.clipChildren&&(a=this.gl,--this.stencilLevel,a.stencilFunc(a.LEQUAL,this.stencilLevel,255),0==this.stencilLevel&&(this._renderBatches(),a.disable(this.gl.STENCIL_TEST)))},transform:function(a){this._setConcatenatedMatrix(a,a.parent);0<a.alpha&&(a.__webglRenderAlpha=a.parent&&a.parent.__webglRenderAlpha?a.alpha*a.parent.__webglRenderAlpha:a.alpha)},clear:function(g,c,e,h){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},resize:function(c,a){if(this.width!==c||this.height!==a){this.width=this.canvas.width=c,this.height=this.canvas.height=a,this.gl.viewport(0,0,c,a),this.activeShader.active(!0)}},_renderBackground:function(r,n){var o=this.gl,t=r.__webglRenderAlpha;o.uniform4f(this.activeShader.u_color,n.r/255*t,n.g/255*t,n.b/255*t,t);var u=r.width,s=r.height,t=-r.pivotX,p=r.pivotY-s,q=this.vertex2;q[0]=t;q[1]=p;q[2]=t+u;q[3]=p;q[4]=t;q[5]=p+s;q[6]=t+u;q[7]=p+s;u=r.__webglWorldMatrix;for(s=0;4>s;s++){t=q[2*s],p=q[2*s+1],q[2*s]=u.a*t+u.c*p+u.tx,q[2*s+1]=u.b*t+u.d*p+u.ty}o.bufferData(o.ARRAY_BUFFER,q,o.STREAM_DRAW);o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)},_renderImage:function(t,x,y){x.texture||this.activeShader.uploadTexture(x);var v=t.width,w=t.height,u=-t.pivotX,s=-t.pivotY,r=y[2],o=y[3],q=y[4],n=y[5];if(q||n){u=u+q-0.5*r,s=s+n-0.5*o}w=this._createVertexs(x,y[0],y[1],r,o,u,s,v,w);y=this.batchIndex*this.positionStride;v=this.vertex;u=t.__webglRenderAlpha;v[y+0]=w[0];v[y+1]=w[1];v[y+2]=w[2];v[y+3]=w[3];v[y+4]=u;v[y+5]=w[4];v[y+6]=w[5];v[y+7]=w[6];v[y+8]=w[7];v[y+9]=u;v[y+10]=w[8];v[y+11]=w[9];v[y+12]=w[10];v[y+13]=w[11];v[y+14]=u;v[y+15]=w[12];v[y+16]=w[13];v[y+17]=w[14];v[y+18]=w[15];v[y+19]=u;w=t.__webglWorldMatrix;for(u=0;4>u;u++){s=v[y+5*u],r=v[y+5*u+1],v[y+5*u]=w.a*s+w.c*r+w.tx,v[y+5*u+1]=w.b*s+w.d*r+w.ty}t.texture=x.texture;this.sprites[this.batchIndex++]=t},_renderBatches:function(){var g=this.gl;g.bufferSubData(g.ARRAY_BUFFER,0,this.vertex.subarray(0,this.batchIndex*this.positionStride));for(var g=0,e=null,h=0;h<this.batchIndex;h++){var n=this.sprites[h];e&&e!==n.texture&&(this._renderBatch(g,h),g=h);e=n.texture}this._renderBatch(g,this.batchIndex);this.batchIndex=0},_renderBatch:function(g,e){var h=this.gl,n=e-g;0<n&&(h.bindTexture(h.TEXTURE_2D,this.sprites[g].texture),h.drawElements(h.TRIANGLES,6*n,h.UNSIGNED_SHORT,12*g))},_initShaders:function(){this.defaultShader=new l(this,{v:"attribute vec2 a_position;\nattribute vec2 a_TexCoord;\nattribute float a_alpha;\nuniform mat3 u_projectionTransform;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n    v_TexCoord = a_TexCoord;\n    v_alpha = a_alpha;\n}\n",f:"\nprecision mediump float;\nuniform sampler2D u_Sampler;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_alpha;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:20},{name:"a_TexCoord",count:2,offset:8,stride:20},{name:"a_alpha",count:1,offset:16,stride:20}],uniforms:["u_projectionTransform","u_Sampler"]});this.notextureShader=new l(this,{v:"attribute vec2 a_position;\nuniform mat3 u_projectionTransform;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n}\n",f:"\nprecision mediump float;\nuniform vec4 u_color;\nvoid main(){\n    gl_FragColor = u_color;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:8}],uniforms:["u_projectionTransform","u_color"]})},_createVertexs:function(z,y,w,x,v,u,t,q,r){var s=this.__tempVertexs||[],o=z.width;z=z.height;x/=o;v/=z;y/=o;w/=z;1<x+y&&(x=1-y);1<v+w&&(v=1-w);w=1-w-v;t=-r-t;o=0;s[o++]=u;s[o++]=t;s[o++]=y;s[o++]=w;s[o++]=u+q;s[o++]=t;s[o++]=y+x;s[o++]=w;s[o++]=u;s[o++]=t+r;s[o++]=y;s[o++]=w+v;s[o++]=u+q;s[o++]=t+r;s[o++]=y+x;s[o++]=w+v;return s},_setConcatenatedMatrix:function(o,e){var s=o.__webglWorldMatrix,v=1,q=0,r=360-o.rotation%360,p=o.scaleX,t=o.scaleY;r&&(q=r*k,v=Math.cos(q),q=Math.sin(q));s.a=v*p;s.b=q*p;s.c=-q*t;s.d=v*t;s.tx=o.x;s.ty=-o.y;v=e.__webglWorldMatrix;s.concat(v.a,v.b,v.c,v.d,v.tx,v.ty)}}),b={},l=function(e,c,g){this.renderer=e;this.gl=e.gl;this.program=this._createProgram(this.gl,c.v,c.f);g=g||{};this.attributes=g.attributes||[];this.uniforms=g.uniforms||[];this.vertexBuffer=this.gl.createBuffer();this.indexBuffer=this.gl.createBuffer()};l.prototype={active:function(n){var g=this,q=g.renderer,r=q.activeShader;if(r!==g||n){var p=g.gl,o=g.program;o&&p&&(r&&r.attributes.forEach(function(c){p.disableVertexAttribArray(r[c.name])}),q.activeShader=g,p.useProgram(o),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,g.indexBuffer),p.bindBuffer(p.ARRAY_BUFFER,g.vertexBuffer),g.attributes.forEach(function(c){attribute=c.name;g[attribute]=g[attribute]||p.getAttribLocation(o,attribute);p.enableVertexAttribArray(g[attribute]);p.vertexAttribPointer(g[attribute],c.count,p.FLOAT,!1,c.stride,c.offset)}),g.uniforms.forEach(function(c){g[c]=g[c]||p.getUniformLocation(o,c)}),g.width!==q.width||g.height!==q.height)&&(g.width=q.width,g.height=q.height,g.uploadProjectionTransform(!0))}},uploadTexture:function(c){var a=this.gl;if(b[c.src]){c.texture=b[c.src]}else{var e=a.createTexture();a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,e);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,1);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.uniform1i(this.u_Sampler,0);a.bindTexture(a.TEXTURE_2D,null);c.texture=e;b[c.src]=e}},uploadProjectionTransform:function(d){var c=this.gl;if(!this._projectionTransformElements||d){this._projectionTransformElements=new Float32Array([2/this.width,0,0,0,2/this.height,0,-1,1,1])}c.uniformMatrix3fv(this.u_projectionTransform,!1,this._projectionTransformElements)},_createProgram:function(g,e,h){e=this._createShader(g,g.VERTEX_SHADER,e);var n=this._createShader(g,g.FRAGMENT_SHADER,h);if(!e||!n){return null}if(h=g.createProgram()){if(g.attachShader(h,e),g.attachShader(h,n),g.linkProgram(h),g.deleteShader(n),g.deleteShader(e),!g.getProgramParameter(h,g.LINK_STATUS)){return e=g.getProgramInfoLog(h),console.log("Failed to link program: "+e),g.deleteProgram(h),null}}return h},_createShader:function(e,c,g){if(c=e.createShader(c)){if(e.shaderSource(c,g),e.compileShader(c),!e.getShaderParameter(c,e.COMPILE_STATUS)){return g=e.getShaderInfoLog(c),console.log("Failed to compile shader: "+g),e.deleteShader(c),null}}return c}};m.isSupport=function(){if(void 0===this._isSupport){var c=document.createElement("canvas");c.getContext&&(c.getContext("webgl")||c.getContext("experimental-webgl"))?this._isSupport=!0:this._isSupport=!1}return this._isSupport};j.WebGLRenderer=m})(window);(function(b){b=b.Hilo;var a=b.Class.create({Extends:b.Renderer,constructor:function(c){a.superclass.constructor.call(this,c);this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(c){return c.visible&&0<c.alpha?(this.context.save(),!0):!1},draw:function(m){var o=this.context,h=m.width,n=m.height;m.clipChildren&&(o.beginPath(),o.rect(0,0,h,n),o.clip());var l=m.background;l&&(o.fillStyle=l,o.fillRect(0,0,h,n));if(m=(l=m.drawable)&&l.image){var l=l.rect,g=l[4],j=l[5];(g||j)&&o.translate(g-0.5*sw,j-0.5*sh);o.drawImage(m,l[0],l[1],l[2],l[3],0,0,h,n)}},endDraw:function(c){this.context.restore()},transform:function(w){var y=this.context,A=w.x,x=w.y,t=w.scaleX,z=w.scaleY,q=w.pivotX,r=w.pivotY,s=w.rotation%360,B=w.align;if(B){if("function"===typeof B){w.align()}else{var C=w.parent;if(C){var j=w.width,o=w.height,p=C.width,C=C.height;switch(B){case"TL":x=A=0;break;case"T":A=p-j>>1;x=0;break;case"TR":A=p-j;x=0;break;case"L":A=0;x=C-o>>1;break;case"C":A=p-j>>1;x=C-o>>1;break;case"R":A=p-j;x=C-o>>1;break;case"BL":A=0;x=C-o;break;case"B":A=p-j>>1;x=C-o;break;case"BR":A=p-j,x=C-o}}}}0==A&&0==x||y.translate(A,x);0!=s&&y.rotate(s*Math.PI/180);1==t&&1==z||y.scale(t,z);0==q&&0==r||y.translate(-q,-r);0<w.alpha&&(y.globalAlpha*=w.alpha)},clear:function(g,j,f,h){this.context.clearRect(g,j,f,h)},resize:function(d,f){this.canvas.width=d;this.canvas.height=f}});b.CanvasRenderer=a})(window);(function(f){var d=f.Hilo,j=d.Class,k=d.Event,b=d.Matrix;f=function(){function a(D,B,z){for(var A=D.length,y=B.length,u,v,q,r,s,o,F=0,E=u=0;E<A;E++){u=D[E];v=D[E<A-1?E+1:0];F=u.y-v.y;u=v.x-u.x;v=Math.sqrt(F*F+u*u);F/=v;u/=v;v=q=D[0].x*F+D[0].y*u;for(var C=1;C<A;C++){o=D[C].x*F+D[C].y*u,o>q?q=o:o<v&&(v=o)}r=s=B[0].x*F+B[0].y*u;for(C=1;C<y;C++){o=B[C].x*F+B[C].y*u,o>s?s=o:o<r&&(r=o)}v<r?(v=r-q,F=-F,u=-u):v-=s;if(0<=v){return !1}v>z.overlap&&(z.overlap=v,z.normal.x=F,z.normal.y=u)}return z}return j.create({Mixes:k,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("View");d.copy(this,c,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var e=this,c;c=e.parent;){e=c}return e.canvas&&e.renderer?e:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(e,c){"number"===typeof c?e.addChildAt(this,c):e.addChild(this);return this},removeFromParent:function(){var c=this.parent;c&&c.removeChild(this);return this},fixSize:function(){if(!this.width||!this.height){var c=this.drawable&&this.drawable.rect;c&&(target.width=target.width||c[2],target.height=target.height||c[3])}},getBounds:function(){for(var A=this.width,z=this.height,x=this.getConcatenatedMatrix(),A=this.boundsArea||[{x:0,y:0},{x:A,y:0},{x:A,y:z},{x:0,y:z}],z=[],y,w,u,v,q,r,s,o=0,B=A.length;o<B;o++){y=x.transformPoint(A[o],!0,!0),w=y.x,u=y.y,0==o?(v=q=w,r=s=u):(v>w?v=w:q<w&&(q=w),r>u?r=u:s<u&&(s=u)),z[o]=y}z.x=v;z.y=r;z.width=q-v;z.height=s-r;return z},getConcatenatedMatrix:function(t){for(var x=new b(1,0,0,1,0,0),v=this;v!=t&&v.parent;v=v.parent){var w=1,u=0,r=v.rotation%360,s=v.pivotX,o=v.pivotY,p=v.scaleX,q=v.scaleY;r&&(u=r*Math.PI/180,w=Math.cos(u),u=Math.sin(u));0!=s&&(x.tx-=s);0!=o&&(x.ty-=o);x.concat(w*p,u*p,-u*q,w*q,v.x,v.y)}return x},hitTestPoint:function(D,B,z){var A=this.getBounds(),y=D>=A.x&&D<=A.x+A.width&&B>=A.y&&B<=A.y+A.height;if(y&&z){z=0;for(var y=!1,u,v,q,r,s=0,o=A.length;s<o;s++){var F=A[s],E=A[(s+1)%o];if(F.y==E.y&&B==F.y&&(F.x>E.x?(u=E.x,v=F.x):(u=F.x,v=E.x),D>=u&&D<=v)){y=!0;continue}F.y>E.y?(q=E.y,r=F.y):(q=F.y,r=E.y);if(!(B<q||B>r)){var C=(B-F.y)*(E.x-F.x)/(E.y-F.y)+F.x;C>D?z++:C==D&&(y=!0);F.x>D&&F.y==B&&(F=A[(o+s-1)%o],(F.y<B&&E.y>B||F.y>B&&E.y<B)&&z++)}}y=y||1==z%2}return y},hitTestObject:function(l,g){var o=this.getBounds(),n=l.getBounds(),m=o.x<=n.x+n.width&&n.x<=o.x+o.width&&o.y<=n.y+n.height&&n.y<=o.y+o.height;m&&g&&(m=(m=a(o,n,{overlap:-Infinity,normal:{x:0,y:0}}))?a(n,o,m):!1);return !!m},_render:function(e,c){this.onUpdate&&!1===this.onUpdate(c)||!e.startDraw(this)||(e.transform(this),this.render(e,c),e.endDraw(this))},_fireMouseEvent:function(e){e.eventCurrentTarget=this;this.fire(e);if("mousemove"==e.type){if(!this.__mouseOver){this.__mouseOver=!0;var c=d.copy({},e);c.type="mouseover";this.fire(c)}}else{"mouseout"==e.type&&(this.__mouseOver=!1)}c=this.parent;e._stopped||e._stopPropagationed||!c||("mouseout"==e.type||"touchout"==e.type?c.hitTestPoint(e.stageX,e.stageY,!0)||c._fireMouseEvent(e):c._fireMouseEvent(e))},onUpdate:null,render:function(e,c){this.fixSize();e.draw(this)},toString:function(){for(var e,c=this;c;){e=e?c.id+"."+e:c.id,c=c.parent}return e}})}();d.View=f})(window);(function(b){var a=b.Hilo,d=a.Drawable,f=a.Class.create({Extends:a.View,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("Container");f.superclass.constructor.call(this,c);this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(h,l){var j=this.children,g=j.length,m=h.parent;l=0>l?0:l>g?g:l;var k=this.getChildIndex(h);if(k==l){return this}0<=k?(j.splice(k,1),l=l==g?g-1:l):m&&m.removeChild(h);j.splice(l,0,h);0>k?this._updateChildren(l):this._updateChildren(k<l?k:l,(k<l?l:k)+1);h.drawable&&h.drawable.domElement&&(this._domContainerFlag=!0);return this},addChild:function(g){for(var j=this.children.length,h=arguments,e=0,k=h.length;e<k;e++){this.addChildAt(h[e],j+e)}return this},removeChildAt:function(h){var l=this.children;if(0>h||h>=l.length){return null}var j=l[h];if(j){var g=j.drawable,m=g&&g.domElement;if(m){var k=m.parentNode;k&&k.removeChild(m);g.domElement=null;this._domContainerFlag=!0}j.parent=null;j.depth=-1}l.splice(h,1);this._updateChildren(h);return j},removeChild:function(c){return this.removeChildAt(this.getChildIndex(c))},removeChildById:function(g){for(var j=this.children,h,e=0,k=j.length;e<k;e++){if(h=j[e],h.id===g){return this.removeChildAt(e),h}}return null},removeAllChildren:function(){for(;this.children.length;){this.removeChildAt(0)}return this},getChildAt:function(c){var e=this.children;return 0>c||c>=e.length?null:e[c]},getChildById:function(g){for(var j=this.children,h,e=0,k=j.length;e<k;e++){if(h=j[e],h.id===g){return h}}return null},getChildIndex:function(c){return this.children.indexOf(c)},setChildIndex:function(g,j){var h=this.children,e=h.indexOf(g);if(0<=e&&e!=j){var k=h.length;j=0>j?0:j>=k?k-1:j;h.splice(e,1);h.splice(j,0,g);this._updateChildren()}return this},swapChildren:function(g,j){var h=this.children,e=this.getChildIndex(g),k=this.getChildIndex(j);g.depth=k;h[k]=g;j.depth=e;h[e]=j},swapChildrenAt:function(g,j){var h=this.children,e=this.getChildAt(g),k=this.getChildAt(j);e.depth=j;h[j]=e;k.depth=g;h[g]=k},sortChildren:function(c){var g=this.children;if("string"==typeof c){var e=c;c=function(h,j){return j[e]-h[e]}}g.sort(c);this._updateChildren()},_updateChildren:function(g,j){var h=this.children,e;j=j||h.length;for(var k=g||0;k<j;k++){e=h[k],e.depth=k+1,e.parent=this}},contains:function(c){for(;c=c.parent;){if(c===this){return !0}}return !1},getViewAtPoint:function(s,p,m,r,q){if(this.clipChildren&&!this.hitTestPoint(s,p,m)){return null}for(var o=r?[]:null,k=this.children,l,t,j=k.length-1;0<=j;j--){if(l=k[j],!(!l||!l.visible||0>=l.alpha||q&&!l.pointerEnabled)){if(l.children&&l.children.length&&(!q||l.pointerChildren)&&(t=l.getViewAtPoint(s,p,m,r,q)),t){if(r){t.length&&(o=o.concat(t))}else{return t}}else{if(l.hitTestPoint(s,p,m)){if(r){o.push(l)}else{return l}}}}}return r&&o.length?o:null},render:function(h,m){f.superclass.render.call(this,h,m);"dom"!=h.renderType&&(this._domContainerFlag&&(this._domContainerFlag=!1,this._domContainerUpdate()),this.drawable&&this.drawable.domElement&&a.setElementStyleByView(this,!0));var k=this.children.slice(0),c,l,j;c=0;for(l=k.length;c<l;c++){j=k[c],j._render(h,m)}},_domContainerUpdate:function(){var g=this.children,h=!1;i=0;for(len=g.length;i<len;i++){if(child=g[i],child.drawable&&child.drawable.domElement){h=!0;break}}var g=this.parent,j=this.drawable,e=j&&j.domElement;h?e||(j=this.drawable=this.drawable||new d,j.domElement=j.domElement||a.createElement("div",{style:{position:"absolute"}}),g&&g._domContainerUpdate()):e&&(e&&((h=e.parentNode)&&h.removeChild(e),this.drawable=j.domElement=null),g&&g._domContainerUpdate())}});a.Container=f})(window);(function(j){var f=j.Hilo,k=f.CanvasRenderer,m=f.DOMRenderer,b=f.WebGLRenderer,l=f.Class.create({Extends:f.Container,constructor:function(g){g=g||{};this.id=this.id||g.id||f.getUid("Stage");l.superclass.constructor.call(this,g);this._initRenderer(g);var d=this.width,n=this.height,h=this.updateViewport();g.width||(d=h&&h.width||320);g.height||(n=h&&h.height||480);this.resize(d,n,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(e){var a=e.canvas,c=e.container;e=e.renderType||"canvas";"string"===typeof a&&(a=f.getElement(a));"string"===typeof c&&(c=f.getElement(c));a||(a=f.createElement("dom"===e?"div":"canvas",{style:{position:"absolute",overflow:"hidden"}}));this.canvas=a;c&&c.appendChild(a);a={canvas:a,stage:this};switch(e){case"dom":this.renderer=new m(a);break;case"webgl":b.isSupport()?this.renderer=new b(a):this.renderer=new k(a);break;default:this.renderer=new k(a)}},_render:function(z,y){if((!this.onUpdate||!1!==this.onUpdate(y))&&z.startDraw(this)){var w=this.width,x=this.height,v=this.scaleX,u=this.scaleY,t=this._height,q=this._scaleX,r=this._scaleY,s=this.canvas,o=s.style;if(this._width!==w||q!==v){this._width=w,this._scaleX=v,s.width=w,o.width=v*w+"px"}if(t!==x||r!==u){this._height=x,this._scaleY=u,s.height=x,o.height=u*x+"px"}(w=this.drawable&&this.drawable.domElement)&&!w.parentNode&&(w.style.overflow="hidden",s.appendChild(w));z.clear(0,0,this.width,this.height);this.render(z,y);z.endDraw(this)}},addTo:function(d){var c=this.canvas;c.parentNode!==d&&d.appendChild(c);return this},tick:function(c){this.paused||this._render(this.renderer,c)},resize:function(e,c,g){if(g||this.width!==e||this.height!==c){this.width=e,this.height=c,this.renderer.resize(e,c),this.updateViewport()}},enableDOMEvent:function(o,n){var s=this,t=s.canvas,r="string"===typeof o?[o]:o;n=!1!==n;for(var q=s._domListener||(s._domListener=function(c){s._onDOMEvent(c)}),p=0;p<r.length;p++){o=r[p],n?t.addEventListener(o,q,!1):t.removeEventListener(o,q)}return s},_onDOMEvent:function(o){var h=o.type,s=0==h.indexOf("touch"),v=o;if(s){var r=o.touches,v=o.changedTouches,v=r&&r.length?r[0]:v&&v.length?v[0]:null}var r=v.pageX||v.clientX,v=v.pageY||v.clientY,q=this.viewport||this.updateViewport();o.stageX=r=(r-q.left)/this.scaleX;o.stageY=v=(v-q.top)/this.scaleY;o.stopPropagation=function(){this._stopPropagationed=!0};var r=this.getViewAtPoint(r,v,!0,!1,!0)||this,v=this.canvas,q=this._eventTarget,p="mouseout"===h;if(q&&(!(q==r||q.contains&&q.contains(r))||p)){if(p="touchmove"===h?"touchout":"mousemove"===h||p||!r?"mouseout":null){var t=f.copy({},o);t.type=p;t.eventTarget=q;q._fireMouseEvent(t)}o.lastEventTarget=q;this._eventTarget=null}r&&r.pointerEnabled&&"mouseout"!==h&&(o.eventTarget=this._eventTarget=r,r._fireMouseEvent(o));s||(v.style.cursor=r&&r.pointerEnabled&&r.useHandCursor?"pointer":"");f.browser.android&&"touchmove"===h&&o.preventDefault()},updateViewport:function(){var d=this.canvas,c=null;d.parentNode&&(c=this.viewport=f.getElementRect(d));return c},_domContainerUpdate:function(){l.superclass._domContainerUpdate.call(this);var c=this.drawable&&this.drawable.domElement;c&&!c.parentNode&&this.canvas.parentNode&&this.canvas.parentNode.appendChild(c)}});f.Stage=l})(window);(function(b){var a=b.Hilo,d=a.Drawable,f=a.Class.create({Extends:a.View,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("Bitmap");f.superclass.constructor.call(this,c);this.drawable=new d(c);if(!this.width||!this.height){if(c=this.drawable.rect){this.width=c[2],this.height=c[3]}}},setImage:function(c,e){this.drawable.init({image:c,rect:e});e&&(this.width=e[2],this.height=e[3]);return this}});a.Bitmap=f})(window);(function(b){var a=b.Hilo,d=a.Drawable,f=a.Class.create({Extends:a.View,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("Sprite");f.superclass.constructor.call(this,c);this._frames=[];this._frameNames={};this.drawable=new d;c.frames&&this.addFrame(c.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(h,k){var l=null!=k?k:this._frames.length;if(h instanceof Array){for(var g=0,j=h.length;g<j;g++){this.setFrame(h[g],l+g)}}else{this.setFrame(h,l)}return this},setFrame:function(g,h){var j=this._frames,e=j.length;h=0>h?0:h>e?e:h;j[h]=g;g.name&&(this._frameNames[g.name]=g);if(0==h&&!this.width||!this.height){this.width=g.rect[2],this.height=g.rect[3]}return this},getFrame:function(c){if("number"===typeof c){var e=this._frames;return 0>c||c>=e.length?null:e[c]}return this._frameNames[c]},getFrameIndex:function(h){var k=this._frames,l=k.length,g=-1;if("number"===typeof h){g=h}else{if(h="string"===typeof h?this._frameNames[h]:h){for(var j=0;j<l;j++){if(h===k[j]){g=j;break}}}}return g},play:function(){this.paused=!1;return this},stop:function(){this.paused=!0;return this},"goto":function(g,h){var j=this._frames.length,e=this.getFrameIndex(g);this.currentFrame=0>e?0:e>=j?j-1:e;this.paused=h;this._firstRender=!0;return this},_render:function(e,h){var g=this.currentFrame,c;this._firstRender?(c=g,this._firstRender=!1):c=this._nextFrame(h);c!=g&&(this.currentFrame=c,(g=this._frames[c].callback)&&g.call(this));this.drawable.init(this._frames[c]);f.superclass._render.call(this,e,h)},_nextFrame:function(h){var k=this._frames,l=k.length,g=this.currentFrame,k=k[g],j=this._frameElapsed;h=0!=g||this.drawable?j+(this.timeBased?h:1):0;j=this._frameElapsed=h<(k.duration||this.interval)?h:0;(k.stop||!this.loop&&g>=l-1)&&this.stop();this.paused||0!=j||(null!=k.next?g=this.getFrameIndex(k.next):g>=l-1?g=0:this.drawable&&g++);return g},setFrameCallback:function(c,e){if(c=this.getFrame(c)){c.callback=e}return this}});a.Sprite=f})(window);(function(b){var a=b.Hilo,d=a.Drawable,f=a.Class.create({Extends:a.View,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("Button");f.superclass.constructor.call(this,c);this.drawable=new d(c);this.setState(f.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(c){this.enabled!=c&&(c?this.setState(f.UP):this.setState(f.DISABLED));return this},setState:function(c){if(this.state!==c){this.state=c;this.pointerEnabled=this.enabled=c!==f.DISABLED;var e;switch(c){case f.UP:e=this.upState;break;case f.OVER:e=this.overState;break;case f.DOWN:e=this.downState;break;case f.DISABLED:e=this.disabledState}e&&(this.drawable.init(e),a.copy(this,e,!0))}return this},fire:function(c,e){if(this.enabled){switch("string"===typeof c?c:c.type){case"mousedown":case"touchstart":case"touchmove":this.setState(f.DOWN);break;case"mouseover":this.setState(f.OVER);break;case"mouseup":this.overState?this.setState(f.OVER):this.upState&&this.setState(f.UP);break;case"touchend":case"touchout":case"mouseout":this.setState(f.UP)}return f.superclass.fire.call(this,c,e)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});a.Button=f})(window);(function(k){var j=k.Hilo;k=j.Class;var m=j.Drawable,o=j.View,b=j.createElement("canvas"),n=b&&b.getContext("2d"),l=k.create({Extends:o,constructor:function(c){c=c||{};this.id=this.id||c.id||j.getUid("Text");l.superclass.constructor.call(this,c);c.font||(this.font="16px arial");this._fontHeight=l.measureFontHeight(this.font);c.width?(this.width=c.width,this._autoWidth=!1):(this.width=512,this._autoWidth=!0);c.height?(this.height=c.height,this._autoHeight=!1):(this.height=512,this._autoHeight=!0)},text:null,color:"#000",textAlign:null,outline:!1,lineSpacing:0,font:null,cache:function(){var a=!0;this._text!==this.text&&(this._text=this.text,a=!0);this._color!==this.color&&(this._color=this.color,a=!0);this._font!==this.font&&(this._font=this.font,a=!0);a&&(b.width=this.width,b.height=this.height,n.clearRect(0,0,b.width,b.height),this._draw(n),a=new Image,a.src=b.toDataURL(),this.drawable=this.drawable||new m,this.drawable.init(a))},setFont:function(c){this.font!==c&&(this.font=c,this._fontHeight=l.measureFontHeight(c));return this},render:function(f,h){if("canvas"===f.renderType){this._draw(f.context)}else{if("dom"===f.renderType){var p=this.drawable.domElement,g=p.style;g.font=this.font;g.textAlign=this.textAlign;g.color=this.color;g.width=this._autoWidth?null:this.width+"px";g.height=this._autoHeight?null:this.height+"px";g.lineHeight=this._fontHeight+this.lineSpacing+"px";g["word-break"]="break-all";g["word-wrap"]="break-word";this._text!==this.text&&(p.innerHTML=this.text.replace("\n","</br>"))}else{this.cache()}f.draw(this)}},_draw:function(C){var A=this.text.toString();if(A){C.font=this.font;C.textAlign=this.textAlign;C.textBaseline="top";var z=A.split(/\r\n|\r|\n|<br(?:[ \/])*>/),y=0,v=0,u=this._fontHeight+this.lineSpacing,q,r,s,A=[];q=0;for(len=z.length;q<len;q++){if(r=z[q],s=C.measureText(r).width,s<=this.width||this._autoWidth){A.push({text:r,y:v}),y<s&&(y=s),v+=u}else{s="";var d=0,E,D,B;D=0;for(wlen=r.length;D<wlen;D++){B=r[D],E=C.measureText(s+B).width,E>this.width?(A.push({text:s,y:v}),y<d&&(y=d),v+=u,s=B):(d=E,s+=B),D==wlen-1&&(A.push({text:s,y:v}),s!==B&&y<E&&(y=E),v+=u)}}}this._autoWidth&&(this.width=y);this._autoHeight&&(this.height=v);(z=this.background)&&C!==n&&(C.fillStyle=z,C.fillRect(0,0,this.width,this.height));this.outline?C.strokeStyle=this.color:C.fillStyle=this.color;for(q=0;q<A.length;q++){r=A[q],this._drawTextLine(C,r.text,r.y)}}},_drawTextLine:function(g,r,q){var p=0,h=this.width;switch(this.textAlign){case"center":p=h>>1;break;case"right":p=h}this.outline?g.strokeText(r,p,q):g.fillText(r,p,q)},Statics:{measureFontHeight:function(e){var g=document.documentElement,f=j.createElement("div",{style:{font:e,position:"absolute"},innerHTML:"M"});g.appendChild(f);e=f.offsetHeight;g.removeChild(f);return e}}});j.Text=l})(window);(function(b){var a=b.Hilo,d=a.Bitmap,f=a.Class.create({Extends:a.Container,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("Label");f.superclass.constructor.call(this,c);if(c=c.text+""){this.text="",this.setText(c)}this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(k){k=k.toString();var p=k.length;if(this.text!=k){this.text=k;var o,j,n,l=n=0,m=0;for(o=0;o<p;o++){if(j=k.charAt(o),j=this.glyphs[j]){m=n+(0<n?this.letterSpacing:0),this.children[o]?(n=this.children[o],n.setImage(j.image,j.rect)):(n=this._createBitmap(j),this.addChild(n)),n.x=m,n=m+j.rect[2],l=Math.max(l,j.rect[3])}}for(o=this.children.length-1;o>=p;o--){this._releaseBitmap(this.children[o]),this.children[o].removeFromParent()}this.width=n;this.height=l;this.setTextAlign();return this}},_createBitmap:function(c){var e;f._pool.length?(e=f._pool.pop(),e.setImage(c.image,c.rect)):e=new d({image:c.image,rect:c.rect});return e},_releaseBitmap:function(c){f._pool.push(c)},setTextAlign:function(c){this.textAlign=c||this.textAlign;switch(this.textAlign){case"center":this.pivotX=0.5*this.width;break;case"right":this.pivotX=this.width;break;default:this.pivotX=0}return this},hasGlyphs:function(h){var k=this.glyphs;if(!k){return !1}h=h.toString();var j=h.length,g;for(g=0;g<j;g++){if(!k[h.charAt(g)]){return !1}}return !0},Statics:{_pool:[],createGlyphs:function(k,q,p,j){var o=k.toString();p=p||o.length;var m=q.width/p;j=q.height/(j||1);var n={},l=0;for(k=k.length;l<k;l++){charStr=o.charAt(l),n[charStr]={image:q,rect:[l%p*m,j*Math.floor(l/p),m,j]}}return n}}});a.Label=f})(window);(function(b){var a=b.Hilo,d=a.Drawable,f=a.Class.create({Extends:a.View,constructor:function(c){c=c||{};this.id=this.id||c.id||a.getUid("DOMElement");f.superclass.constructor.call(this,c);this.drawable=new d;(this.drawable.domElement=c.element||a.createElement("div",{style:{position:"absolute"}})).id=this.id},_render:function(e,g){this.onUpdate&&!1===this.onUpdate(g)||this.visible&&this.render(e,g)},render:function(e,g){"dom"!=e.renderType?a.setElementStyleByView(this):e.draw(this)}});a.DOMElement=f})(window);(function(b){b=b.Hilo;var a=b.Class,c=function(){function d(f,h){var g={image:f.image,rect:f.rect};h&&(g.name=h.name||null,g.duration=h.duration||0,g.stop=!!h.stop,g.next=h.next||null);return g}return a.create({constructor:function(q){var o;var m=q.frames;if(m){o=[];var p;if(m instanceof Array){for(var l=0,k=m.length;l<k;l++){p=m[l],o[l]={image:q.image,rect:p}}}else{p=m.frameWidth;for(var k=m.frameHeight,f=q.width/p|0,l=q.height/k|0,m=m.numFrames||f*l,l=0;l<m;l++){o[l]={image:q.image,rect:[l%f*p,(l/f|0)*k,p,k]}}}}else{o=null}this._frames=o;var s;o=this._frames;if(q=q.sprites){var m={},t;for(s in q){l=q[s];if("number"===typeof l){p=d(o[l])}else{if(l instanceof Array){for(p=[],k=0,f=l.length;k<f;k++){t=l[k];var j;"number"===typeof t?t=d(o[t]):(j=t.rect,"number"===typeof j&&(j=o[t.rect]),t=d(j,t));p[k]=t}}else{for(p=[],k=l.from;k<=l.to;k++){p[k-l.from]=d(o[k],l[k])}}}m[s]=p}s=m}else{s=null}this._sprites=s},_frames:null,_sprites:null,getFrame:function(e){var f=this._frames;return f&&f[e]},getSprite:function(e){var f=this._sprites;return f&&f[e]}})}();b.TextureAtlas=c})(window);