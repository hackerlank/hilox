(function(a){a.console=a.console||{log:function(){}};a=Array.prototype;var b=a.slice;a.indexOf=a.indexOf||function(g,h){h=h||0;var c=this.length,f;if(0==c||h>=c){return -1}0>h&&(h=c+h);for(f=h;f<c;f++){if(this[f]===g){return f}}return -1};a=Function.prototype;a.bind=a.bind||function(h){function j(){var d=g.concat(b.call(arguments));return f.apply(this instanceof j?this:h,d)}var f=this,g=b.call(arguments,1),k=function(){};k.prototype=f.prototype;j.prototype=new k;return j}})(window);(function(a){for(var b=0,c=["ms","moz","webkit","o"],h=0;h<c.length&&!a.requestAnimationFrame;++h){a.requestAnimationFrame=a[c[h]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[c[h]+"CancelAnimationFrame"]||a[c[h]+"CancelRequestAnimationFrame"]}a.requestAnimationFrame||(a.requestAnimationFrame=function(d,e){var j=(new Date).getTime(),g=Math.max(0,16-(j-b)),f=a.setTimeout(function(){d(j+g)},g);b=j+g;return f});a.cancelAnimationFrame||(a.cancelAnimationFrame=function(d){clearTimeout(d)})})(window);(function(a){var b=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.toColorRgb=function(){var c=this.toLowerCase();return c&&b.test(c)?4===c.length?{r:parseInt("0x"+c.charAt(1)+c.charAt(1)),g:parseInt("0x"+c.charAt(2)+c.charAt(2)),b:parseInt("0x"+c.charAt(3)+c.charAt(3))}:{r:parseInt("0x"+c.slice(1,3)),g:parseInt("0x"+c.slice(3,5)),b:parseInt("0x"+c.slice(5,7))}:{r:0,g:0,b:0}}})(window);(function(a){var b=function(){var f=document,g=f.documentElement,c=0;return{getUid:function(d){var e=++c;return d?d+"_"+e:e},viewToString:function(d){for(var e;d;){e=e?d.id+"."+e:d.id,d=d.parent}return e},copy:function(e,k,j){for(var d in k){if(!j||e.hasOwnProperty(d)||void 0!==e[d]){e[d]=k[d]}}return e},browser:function(){var d=navigator.userAgent,d={iphone:/iphone/i.test(d),ipad:/ipad/i.test(d),ipod:/ipod/i.test(d),ios:/iphone|ipad|ipod/i.test(d),android:/android/i.test(d),webkit:/webkit/i.test(d),chrome:/chrome/i.test(d),safari:/safari/i.test(d),firefox:/firefox/i.test(d),ie:/msie/i.test(d),opera:/opera/i.test(d),supportTouch:"ontouchstart" in a,supportCanvas:null!=f.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation" in a,supportDeviceMotion:"ondevicemotion" in a};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),d.supportStorage=!0}catch(e){}d.jsVendor=d.webkit?"webkit":d.firefox?"Moz":d.opera?"O":d.ie?"ms":"";d.cssVendor="-"+d.jsVendor+"-";return d}(),event:function(){var d="ontouchstart" in a;return{POINTER_START:d?"touchstart":"mousedown",POINTER_MOVE:d?"touchmove":"mousemove",POINTER_END:d?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElement:function(d){return f.getElementById(d)},getElementRect:function(q){try{var n=q.getBoundingClientRect()}catch(o){n={top:q.offsetTop,left:q.offsetLeft,width:q.offsetWidth,height:q.offsetHeight}}var k=(a.pageXOffset||g.scrollLeft)-(g.clientLeft||0)||0,v=(a.pageYOffset||g.scrollTop)-(g.clientTop||0)||0,d=a.getComputedStyle?a.getComputedStyle(q):q.currentStyle,s=parseInt;q=s(d.paddingLeft)+s(d.borderLeftWidth)||0;var j=s(d.paddingTop)+s(d.borderTopWidth)||0,m=s(d.paddingRight)+s(d.borderRightWidth)||0,d=s(d.paddingBottom)+s(d.borderBottomWidth)||0,s=n.top||0,l=n.left||0;return{left:l+k+q,top:s+v+j,width:n.right-m-l-q,height:n.bottom-d-s-j}},createElement:function(e,m){var k=f.createElement(e),d,l,j;for(d in m){if(l=m[d],"style"===d){for(j in l){k.style[j]=l[j]}}else{k[d]=l}}return k},setElementStyleByView:function(z,x){var p=b.browser.jsVendor,y=!1,j=z.parent,B=z.drawable,y=B.domElement,w=y.style,t=z._stateCache||(z._stateCache={});if(!z.width&&!z.height){var s=B.rect;s&&(s[2]||s[3])&&(z.width=s[2],z.height=s[3])}j&&(s=j.drawable&&j.drawable.domElement)&&s!=y.parentNode&&s.appendChild(y);this.cacheStateIfChanged(z,["visible"],t)&&(w.display=z.visible?"":"none");this.cacheStateIfChanged(z,["alpha"],t)&&(w.opacity=z.alpha);if(z.visible&&!(0>=z.alpha)){this.cacheStateIfChanged(z,["width"],t)&&(w.width=z.width+"px");this.cacheStateIfChanged(z,["height"],t)&&(w.height=z.height+"px");this.cacheStateIfChanged(z,["depth"],t)&&(w.zIndex=z.depth+1);this.cacheStateIfChanged(z,["clipChildren"],t)&&(w.overflow=z.clipChildren?"hidden":null);if(y=this.cacheStateIfChanged(z,["pivotX","pivotY"],t)){var j=z.pivotX,o=z.pivotY;if(s=B.rect){var n=s[2],m=s[3],A=s[4],s=s[5];if(A||s){j-=A-0.5*n,o-=s-0.5*m}}w[p+"TransformOrigin"]=j+"px "+o+"px"}if(this.cacheStateIfChanged(z,["x","y","rotation","scaleX","scaleY"],t)||y){w[p+"Transform"]="translate("+(z.x-z.pivotX)+"px, "+(z.y-z.pivotY)+"px)rotate("+z.rotation+"deg)scale("+z.scaleX+", "+z.scaleY+")"}if(x){w.pointerEvents="none"}else{if(w.pointerEvents||(w.pointerEvents="none"),this.cacheStateIfChanged(z,["background"],t)&&(w.backgroundColor=z.background),p=B.image){if(p=p.src,p!==t.image&&(t.image=p,w.backgroundImage="url("+p+")"),s=B.rect){B=s[0],p=s[1],B!==t.sx&&(t.sx=B,w.backgroundPositionX=-B+"px"),p!==t.sy&&(t.sy=p,w.backgroundPositionY=-p+"px")}}}}},cacheStateIfChanged:function(k,q,m){var j,n,l,p,o=!1;j=0;for(n=q.length;j<n;j++){l=q[j],p=k[l],p!=m[l]&&(m[l]=p,o=!0)}return o}}}();b.undefined=void 0;a.Hilo=b})(window);(function(a){a=a.Hilo;var b=function(){var l=function(q){var o={},d,p;for(d in q){p=q[d],m.hasOwnProperty(d)?m[d].call(this,p):o[d]=p}g(this.prototype,o)},m={Extends:function(p){var e=this.prototype,o=f(p.prototype);g(this,p);g(o,e);o.constructor=this;this.prototype=o;this.superclass=p.prototype},Mixes:function(o){o instanceof Array||(o=[o]);for(var e=this.prototype,d;d=o.shift();){g(e,d.prototype||d)}},Statics:function(d){g(this,d)}},f=function(){if(Object.__proto__){return function(e){return{__proto__:e}}}var d=function(){};return function(c){d.prototype=c;return new d}}(),g=function(t){for(var h=1,o=arguments.length;h<o;h++){var s=arguments[h],r,p;for(p in s){var q=s[p];!q||"object"!==typeof q||void 0===q.value&&"function"!==typeof q.get&&"function"!==typeof q.set?t[p]=q:(r=r||{},r[p]=q)}r&&k(t,r)}return t};try{var n=Object.defineProperty,k=Object.defineProperties;n({},"$",{value:0})}catch(j){"__defineGetter__" in Object&&(n=function(o,e,d){"value" in d&&(o[e]=d.value);"get" in d&&o.__defineGetter__(e,d.get);"set" in d&&o.__defineSetter__(e,d.set);return o},k=function(e,c){for(var d in c){c.hasOwnProperty(d)&&n(e,d,c[d])}return e})}return{create:function(e){e=e||{};var d=e.hasOwnProperty("constructor")?e.constructor:function(){};l.call(d,e);return d},mix:g}}();a.Class=b})(window);(function(a){var b=a.Hilo,c=b.Class.create({constructor:function(d,e,f){this.type=d;this.target=e;this.detail=f;this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}});if(a=a.Event){a=a.prototype;var h=a.stopImmediatePropagation;a.stopImmediatePropagation=function(){h&&h.call(this);this._stopped=!0}}b.Event={_listeners:null,on:function(d,e,j){var g=this._listeners=this._listeners||{};d=g[d]=g[d]||[];for(var g=0,f=d.length;g<f;g++){if(d[g].listener===e){return}}d.push({listener:e,once:j});return this},off:function(d,e){if(0==arguments.length){return this._listeners=null,this}var j=this._listeners&&this._listeners[d];if(j){if(1==arguments.length){return delete this._listeners[d],this}for(var g=0,f=j.length;g<f;g++){if(j[g].listener===e){j.splice(g,1);0===j.length&&delete this._listeners[d];break}}}return this},fire:function(e,f){var n,j;"string"===typeof e?j=e:(n=e,j=e.type);var g=this._listeners;if(!g){return !1}var k=g[j];if(k){k=k.slice(0);n=n||new c(j,this,f);if(n._stopped){return !1}for(var m=0;m<k.length;m++){var l=k[m];l.listener.call(this,n);l.once&&k.splice(m--,1)}0==k.length&&delete g[j];return !0}return !1}}})(window);(function(a){a=a.Hilo;var b=a.Class.create({constructor:function(k,l,f,g,m,j){this.a=k;this.b=l;this.c=f;this.d=g;this.tx=m;this.ty=j},concat:function(s){var v=arguments,x=this.a,y=this.b,w=this.c,n=this.d,A=this.tx,j=this.ty;if(6<=v.length){var z=v[0],l=v[1],o=v[2],q=v[3],m=v[4],v=v[5]}else{z=s.a,l=s.b,o=s.c,q=s.d,m=s.tx,v=s.ty}this.a=x*z+y*o;this.b=x*l+y*q;this.c=w*z+n*o;this.d=w*l+n*q;this.tx=A*z+j*o+m;this.ty=A*l+j*q+v;return this},rotate:function(m){var n=Math.sin(m);m=Math.cos(m);var f=this.a,g=this.b,o=this.c,k=this.d,j=this.tx,l=this.ty;this.a=f*m-g*n;this.b=f*n+g*m;this.c=o*m-k*n;this.d=o*n+k*m;this.tx=j*m-l*n;this.ty=j*n+l*m;return this},scale:function(c,f){this.a*=c;this.d*=f;this.c*=c;this.b*=f;this.tx*=c;this.ty*=f;return this},translate:function(c,f){this.tx+=c;this.ty+=f;return this},identity:function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this},invert:function(){var k=this.a,l=this.b,f=this.c,g=this.d,m=this.tx,j=k*g-l*f;this.a=g/j;this.b=-l/j;this.c=-f/j;this.d=k/j;this.tx=(f*this.ty-g*m)/j;this.ty=-(k*this.ty-l*m)/j;return this},transformPoint:function(h,j,f){var g=h.x*this.a+h.y*this.c+this.tx,k=h.x*this.b+h.y*this.d+this.ty;j&&(g=g+0.5>>0,k=k+0.5>>0);if(f){return{x:g,y:k}}h.x=g;h.y=k;return h}});a.Matrix=b})(window);(function(a){var b=a.Hilo,c=b.Class.create({constructor:function(e){this._targetFPS=e||30;this._interval=1000/this._targetFPS;this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(k){if(!this._intervalId){this._lastTime=+new Date;var e=this,f=this._interval,l=a.requestAnimationFrame||a[b.browser.jsVendor+"RequestAnimationFrame"];if(k&&l){var j=function(){e._tick()},g=function(){e._intervalId=setTimeout(g,f);l(j)}}else{g=function(){e._intervalId=setTimeout(g,f);e._tick()}}g()}},stop:function(){clearTimeout(this._intervalId);this._intervalId=null;this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var g=+new Date,e=g-this._lastTime,f=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1000/(this._tickTime/this._tickCount)+0.5>>0,this._tickTime=this._tickCount=0):this._tickTime+=g-this._lastTime;this._lastTime=g;for(var g=0,h=f.length;g<h;g++){f[g].tick(e)}}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(e){if(!e||"function"!=typeof e.tick){throw Error("Ticker: The tick object must implement the tick method.")}this._tickers.push(e)},removeTick:function(f){var e=this._tickers;f=e.indexOf(f);0<=f&&e.splice(f,1)}});b.Ticker=c})(window);(function(a){var b=a.Hilo,c=b.Class.create({constructor:function(e){this.init(e)},image:null,rect:null,domElement:null,init:function(g){var e=this,f=e.image;c.isDrawable(g)?e.image=g:b.copy(e,g,!0);g=e.image;if("string"===typeof g){if(f&&g===f.getAttribute("src")){g=e.image=f}else{e.image=null;var h=new Image;h.onload=function(){h.onload=null;e.init(h)};h.src=g;return}}g&&!e.rect&&(e.rect=[0,0,g.width,g.height])},Statics:{isDrawable:function(e){if(!e||!e.tagName){return !1}e=e.tagName.toLowerCase();return"img"===e||"canvas"===e||"video"===e}}});b.Drawable=c})(window);(function(a){var b=a.Hilo,c=b.Class.create({load:function(j){var e=j.src,f="jsonp"==j.type;if(f){var k=j.callbackName||"callback",g=j.callback||"jsonp"+ ++c._count;a[g]||(a[g]=function(d){delete a[g]})}f&&(e+=(-1==e.indexOf("?")?"?":"&")+k+"="+g);j.noCache&&(e+=(-1==e.indexOf("?")?"?":"&")+"t="+ +new Date);f=document.createElement("script");f.type="text/javascript";f.async=!0;f.onload=this.onLoad.bind(this);f.onerror=this.onError.bind(this);f.src=e;j.id&&(f.id=j.id);document.getElementsByTagName("head")[0].appendChild(f)},onLoad:function(e){e=e.target;e.onload=e.onerror=null;return e},onError:function(f){var e=f.target;e.onload=e.onerror=null;return f},Statics:{_count:0}});b.ScriptLoader=c})(window);(function(a){var b=a.Hilo,c=b.Class.create({load:function(g){var e=this,f=new Image;g.crossOrigin&&(f.crossOrigin=g.crossOrigin);f.onload=function(){e.onLoad(f)};f.onerror=f.onabort=e.onError.bind(f);f.src=g.src+(g.noCache?(-1==g.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(e){e=e||a.event;e.onload=e.onerror=e.onabort=null;return e},onError:function(f){var e=f.target;e.onload=e.onerror=e.onabort=null;return f}});b.ImageLoader=c})(window);(function(a){a=a.Hilo;var b=a.ImageLoader,c=a.ScriptLoader,h=a.Class.create({Mixes:a.Event,constructor:function(d){this._source=[];this.add(d)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(d){d&&(d=d instanceof Array?d:[d],this._source=this._source.concat(d));return this},get:function(d){if(d){for(var e=this._source,g=0;g<e.length;g++){var f=e[g];if(f.id===d||f.src===d){return f}}}return null},getContent:function(d){return(d=this.get(d))&&d.content},start:function(){this._loadNext();return this},_loadNext:function(){var e=this,f=e._source,m=f.length;if(e._loaded>=m){e.fire("complete")}else{if(e._currentIndex<m-1&&e._connections<e.maxConnections){var j=++e._currentIndex,f=f[j],g=e._getLoader(f);if(g){var k=g.onLoad,l=g.onError;g.onLoad=function(d){g.onLoad=k;g.onError=l;d=k&&k.call(g,d)||d.target;e._onItemLoad(j,d)};g.onError=function(d){g.onLoad=k;(g.onError=l)&&l.call(g,d);e._onItemError(j,d)};e._connections++}e._loadNext();g&&g.load(f)}}},_getLoader:function(d){var e=d.loader;if(e){return e}var g;if(!(g=d.type)){var f;if(d=d.src.match(/\/?[^/]+\.(\w+)(\?\S+)?$/i)){f=d[1].toLowerCase()}g=f||null}switch(g){case"png":case"jpg":case"jpeg":case"gif":e=new b;break;case"js":case"jsonp":e=new c}return e},_onItemLoad:function(d,e){var f=this._source[d];f.loaded=!0;f.content=e;this._connections--;this._loaded++;this.fire("load",f);this._loadNext()},_onItemError:function(d,e){var f=this._source[d];f.error=e;this._connections--;this._loaded++;this.fire("error",f);this._loadNext()},getSize:function(d){for(var e=0,j=this._source,g=0;g<j.length;g++){var f=j[g],e=e+((d?f.loaded&&f.size:f.size)||0)}return e},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});a.LoadQueue=h})(window);(function(a){var b=a.Hilo;a=b.Class.create({Mixes:b.Event,constructor:function(c){b.copy(this,c,!0);this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element){try{var c=this._element=new Audio;c.addEventListener("canplaythrough",this._onAudioEvent,!1);c.addEventListener("ended",this._onAudioEvent,!1);c.addEventListener("error",this._onAudioEvent,!1);c.src=this.src;c.volume=this.volume;c.load()}catch(f){c=this._element={},c.play=c.pause=function(){}}}return this},_onAudioEvent:function(c){var f=c.type;switch(f){case"canplaythrough":c.target.removeEventListener(f,this._onAudioEvent);this.loaded=!0;this.duration=this._element.duration;this.fire("load");this.autoPlay&&this._doPlay();break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),this.playing=!0)},play:function(){this.playing&&this.stop();this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._element.pause(),this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1);return this},setVolume:function(c){this.volume!=c&&(this.volume=c,this._element.volume=c);return this},setMute:function(c){this.muted!=c&&(this.muted=c,this._element.volume=c?0:this.volume);return this},Statics:{isSupported:null!==a.Audio}});b.HTMLAudio=a})(window);(function(c){var h=c.Hilo,j=h.Class,k=h.Event,a=function(){var d=c.AudioContext||c.webkitAudioContext,e=d?new d:null;return j.create({Mixes:k,constructor:function(b){h.copy(this,b,!0);this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=e;this._gainNode=e.createGain?e.createGain():e.createGainNode();this._gainNode.connect(e.destination);this._onAudioEvent=this._onAudioEvent.bind(this);this._onDecodeComplete=this._onDecodeComplete.bind(this);this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var b=new XMLHttpRequest;b.src=this.src;b.open("GET",this.src,!0);b.responseType="arraybuffer";b.onload=this._onAudioEvent;b.onprogress=this._onAudioEvent;b.onerror=this._onAudioEvent;b.send();this._buffer=!0}return this},_onAudioEvent:function(b){switch(b.type){case"load":b=b.target;b.onload=b.onprogress=b.onerror=null;this._context.decodeAudioData(b.response,this._onDecodeComplete,this._onDecodeError);break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"progress":this.fire(b);break;case"error":this.fire(b)}},_onDecodeComplete:function(b){this._buffer=b;this.loaded=!0;this.duration=b.duration;this.fire("load");this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var b=this._context.createBufferSource();b.start||(b.start=b.noteOn,b.stop=b.noteOff);b.buffer=this._buffer;b.onended=this._onAudioEvent;this._gainNode.gain.value=this.muted?0:this.volume;b.connect(this._gainNode);b.start(0,this._offset);this._audioNode=b;this._startTime=this._context.currentTime;this.playing=!0},_clearAudioNode:function(){var b=this._audioNode;b&&(b.onended=null,b.disconnect(0),this._audioNode=null)},play:function(){this.playing&&this.stop();this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._audioNode.stop(0),this._offset+=this._context.currentTime-this._startTime,this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1);return this},setVolume:function(b){this.volume!=b&&(this.volume=b,this._gainNode.gain.value=b);return this},setMute:function(b){this.muted!=b&&(this.muted=b,this._gainNode.gain.value=b?0:this.volume);return this},Statics:{isSupported:null!=d,enabled:!1,enable:function(){if(!this.enabled&&e){var b=e.createBufferSource();b.buffer=e.createBuffer(1,1,22050);b.connect(e.destination);b.start?b.start(0,0,0):b.noteOn(0,0,0);return this.enabled=!0}return this.enabled}}})}();h.WebAudio=a})(window);(function(a){var b=a.Hilo,c=b.HTMLAudio,h=b.WebAudio;b.WebSound={_audios:{},enableAudio:function(){h.isSupported&&h.enable()},getAudio:function(d){d=this._normalizeSource(d);var e=this._audios[d.src];e||(h.isSupported?e=new h(d):c.isSupported&&(e=new c(d)),this._audios[d.src]=e);return e},removeAudio:function(d){d="string"===typeof d?d:d.src;var e=this._audios[d];e&&(e.stop(),e.off(),this._audios[d]=null,delete this._audios[d])},_normalizeSource:function(d){var e={};"string"===typeof d?e={src:d}:b.copy(e,d);return e}}})(window);(function(a){var b=a.Hilo;a=b.Class.create({constructor:function(c){c=c||{};b.copy(this,c,!0)},renderType:null,canvas:null,stage:null,startDraw:function(c){return !0},draw:function(c){},endDraw:function(c){},transform:function(){},clear:function(g,h,c,f){},resize:function(c,f){}});b.Renderer=a})(window);(function(j){var k=j.Hilo,l=k.Class,m=k.Renderer,c=k.Drawable,h=function(){return l.create({Extends:m,constructor:function(a){h.superclass.constructor.call(this,a)},renderType:"dom",startDraw:function(b){var a=b.drawable=b.drawable||new c;a.domElement=a.domElement||k.createElement("div",{style:{position:"absolute"}});return b.visible},draw:function(a){k.setElementStyleByView(a)},resize:function(e,d){var a=this.canvas.style;a.width=e+"px";a.height=d+"px";"absolute"!=a.position&&(a.position="relative")}})}();k.DOMRenderer=h})(window);(function(j){j=j.Hilo;var k=j.Matrix,l=Math.PI/180,m=j.Class.create({Extends:j.Renderer,Statics:{MAX_BATCH_NUM:2000,ATTRIBUTE_NUM:5,isSupport:null},renderType:"webgl",gl:null,constructor:function(g){m.superclass.constructor.call(this,g);g=this.gl=this.canvas.getContext("webgl",{stencil:!0})||this.canvas.getContext("experimental-webgl",{stencil:!0});g.blendFunc(g.ONE,g.ONE_MINUS_SRC_ALPHA);g.enable(g.BLEND);g.disable(g.CULL_FACE);g.disable(g.DEPTH_TEST);g.disable(g.STENCIL_TEST);this._initShaders();this.vertex2=new Float32Array(8);this.indexs2=new Uint16Array([0,1,2,1,2,3]);this.notextureShader.active();g.bufferData(g.ELEMENT_ARRAY_BUFFER,this.indexs2,g.STATIC_DRAW);g.bufferData(g.ARRAY_BUFFER,this.vertex2,g.STREAM_DRAW);this.maxBatchNum=m.MAX_BATCH_NUM;this.positionStride=4*m.ATTRIBUTE_NUM;var f=6*this.maxBatchNum;this.vertex=new Float32Array(this.maxBatchNum*m.ATTRIBUTE_NUM*4);this.indexs=new Uint16Array(f);for(var d=0,e=0;d<f;d+=6,e+=4){this.indexs[d+0]=e+0,this.indexs[d+1]=e+1,this.indexs[d+2]=e+2,this.indexs[d+3]=e+1,this.indexs[d+4]=e+2,this.indexs[d+5]=e+3}this.batchIndex=0;this.sprites=[];this.defaultShader.active();g.bufferData(g.ELEMENT_ARRAY_BUFFER,this.indexs,g.STATIC_DRAW);g.bufferData(g.ARRAY_BUFFER,this.vertex,g.STREAM_DRAW)},context:null,startDraw:function(a){return a.visible&&0<a.alpha?(a===this.stage&&this.clear(),a.__webglWorldMatrix=a.__webglWorldMatrix||new k(1,0,0,1,0,0),a.__webglRenderAlpha=a.__webglRenderAlpha||1,!0):!1},draw:function(q){var n=q.drawable,f=n&&n.image,n=n&&n.rect,g=q.background,p=q.width,o=q.height;!n||p||o||(q.width=n[2],q.height=n[3]);(this.batchIndex>=this.maxBatchNum||g)&&this._renderBatches();q.clipChildren&&(this.stencilLevel=this.stencilLevel||0,p=this.gl,0===this.stencilLevel?(p.enable(p.STENCIL_TEST),p.clear(p.STENCIL_BUFFER_BIT),p.stencilFunc(p.ALWAYS,1,255),p.stencilOp(p.KEEP,p.REPLACE,p.REPLACE)):p.stencilOp(p.KEEP,p.INCR,p.INCR),p.colorMask(!1,!1,!1,!1),this.notextureShader.active(),this._renderBackground(q,{r:1,g:1,b:1}),this.stencilLevel+=1,p.colorMask(!0,!0,!0,!0),p.stencilFunc(p.LEQUAL,this.stencilLevel,255),p.stencilOp(p.KEEP,p.KEEP,p.KEEP));g&&(this.notextureShader.active(),this._renderBackground(q,g.toColorRgb()));f&&(this.defaultShader.active(),this._renderImage(q,f,n))},endDraw:function(a){a===this.stage&&this._renderBatches();a.clipChildren&&(a=this.gl,--this.stencilLevel,a.stencilFunc(a.LEQUAL,this.stencilLevel,255),0==this.stencilLevel&&(this._renderBatches(),a.disable(this.gl.STENCIL_TEST)))},transform:function(a){this._setConcatenatedMatrix(a,a.parent);0<a.alpha&&(a.__webglRenderAlpha=a.parent&&a.parent.__webglRenderAlpha?a.alpha*a.parent.__webglRenderAlpha:a.alpha)},clear:function(g,f,d,e){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},resize:function(b,a){if(this.width!==b||this.height!==a){this.width=this.canvas.width=b,this.height=this.canvas.height=a,this.gl.viewport(0,0,b,a),this.activeShader.active(!0)}},_renderBackground:function(u,p){var n=this.gl,o=u.__webglRenderAlpha;n.uniform4f(this.activeShader.u_color,p.r/255*o,p.g/255*o,p.b/255*o,o);var t=u.width,s=u.height,o=-u.pivotX,q=u.pivotY-s,r=this.vertex2;r[0]=o;r[1]=q;r[2]=o+t;r[3]=q;r[4]=o;r[5]=q+s;r[6]=o+t;r[7]=q+s;t=u.__webglWorldMatrix;for(s=0;4>s;s++){o=r[2*s],q=r[2*s+1],r[2*s]=t.a*o+t.c*q+t.tx,r[2*s+1]=t.b*o+t.d*q+t.ty}n.bufferData(n.ARRAY_BUFFER,r,n.STREAM_DRAW);n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0)},_renderImage:function(w,r,x){r.texture||this.activeShader.uploadTexture(r);var y=x[2],v=x[3],u=x[4],t=x[5],s=w.width,p=w.height,o=-w.pivotX,n=-w.pivotY;if(u||t){o=o+u-0.5*y,n=n+t-0.5*v}v=this._createVertexs(r,x[0],x[1],y,v,o,n,s,p);x=this.batchIndex*this.positionStride;y=this.vertex;u=w.__webglRenderAlpha;y[x+0]=v[0];y[x+1]=v[1];y[x+2]=v[2];y[x+3]=v[3];y[x+4]=u;y[x+5]=v[4];y[x+6]=v[5];y[x+7]=v[6];y[x+8]=v[7];y[x+9]=u;y[x+10]=v[8];y[x+11]=v[9];y[x+12]=v[10];y[x+13]=v[11];y[x+14]=u;y[x+15]=v[12];y[x+16]=v[13];y[x+17]=v[14];y[x+18]=v[15];y[x+19]=u;v=w.__webglWorldMatrix;for(u=0;4>u;u++){t=y[x+5*u],s=y[x+5*u+1],y[x+5*u]=v.a*t+v.c*s+v.tx,y[x+5*u+1]=v.b*t+v.d*s+v.ty}w.texture=r.texture;this.sprites[this.batchIndex++]=w},_renderBatches:function(){var n=this.gl;n.bufferSubData(n.ARRAY_BUFFER,0,this.vertex.subarray(0,this.batchIndex*this.positionStride));for(var n=0,e=null,f=0;f<this.batchIndex;f++){var g=this.sprites[f];e&&e!==g.texture&&(this._renderBatch(n,f),n=f);e=g.texture}this._renderBatch(n,this.batchIndex);this.batchIndex=0},_renderBatch:function(n,e){var f=this.gl,g=e-n;0<g&&(f.bindTexture(f.TEXTURE_2D,this.sprites[n].texture),f.drawElements(f.TRIANGLES,6*g,f.UNSIGNED_SHORT,12*n))},_initShaders:function(){this.defaultShader=new h(this,{v:"attribute vec2 a_position;\nattribute vec2 a_TexCoord;\nattribute float a_alpha;\nuniform mat3 u_projectionTransform;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n    v_TexCoord = a_TexCoord;\n    v_alpha = a_alpha;\n}\n",f:"\nprecision mediump float;\nuniform sampler2D u_Sampler;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_alpha;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:20},{name:"a_TexCoord",count:2,offset:8,stride:20},{name:"a_alpha",count:1,offset:16,stride:20}],uniforms:["u_projectionTransform","u_Sampler"]});this.notextureShader=new h(this,{v:"attribute vec2 a_position;\nuniform mat3 u_projectionTransform;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n}\n",f:"\nprecision mediump float;\nuniform vec4 u_color;\nvoid main(){\n    gl_FragColor = u_color;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:8}],uniforms:["u_projectionTransform","u_color"]})},_createVertexs:function(w,x,y,v,u,t,s,o,r){var p=this.__tempVertexs||[],n=w.width;w=w.height;v/=n;u/=w;x/=n;y/=w;1<v+x&&(v=1-x);1<u+y&&(u=1-y);y=1-y-u;s=-r-s;n=0;p[n++]=t;p[n++]=s;p[n++]=x;p[n++]=y;p[n++]=t+o;p[n++]=s;p[n++]=x+v;p[n++]=y;p[n++]=t;p[n++]=s+r;p[n++]=x;p[n++]=y+u;p[n++]=t+o;p[n++]=s+r;p[n++]=x+v;p[n++]=y+u;return p},_setConcatenatedMatrix:function(u,o){var p=u.__webglWorldMatrix,s=1,r=0,q=360-u.rotation%360,t=u.scaleX,e=u.scaleY;q&&(r=q*l,s=Math.cos(r),r=Math.sin(r));p.a=s*t;p.b=r*t;p.c=-r*e;p.d=s*e;p.tx=u.x;p.ty=-u.y;s=o.__webglWorldMatrix;p.concat(s.a,s.b,s.c,s.d,s.tx,s.ty)}}),c={},h=function(f,d,e){this.renderer=f;this.gl=f.gl;this.program=this._createProgram(this.gl,d.v,d.f);e=e||{};this.attributes=e.attributes||[];this.uniforms=e.uniforms||[];this.vertexBuffer=this.gl.createBuffer();this.indexBuffer=this.gl.createBuffer()};h.prototype={active:function(r){var g=this,n=g.renderer,q=n.activeShader;if(q!==g||r){var p=g.gl,o=g.program;o&&p&&(q&&q.attributes.forEach(function(a){p.disableVertexAttribArray(q[a.name])}),n.activeShader=g,p.useProgram(o),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,g.indexBuffer),p.bindBuffer(p.ARRAY_BUFFER,g.vertexBuffer),g.attributes.forEach(function(a){attribute=a.name;g[attribute]=g[attribute]||p.getAttribLocation(o,attribute);p.enableVertexAttribArray(g[attribute]);p.vertexAttribPointer(g[attribute],a.count,p.FLOAT,!1,a.stride,a.offset)}),g.uniforms.forEach(function(a){g[a]=g[a]||p.getUniformLocation(o,a)}),g.width!==n.width||g.height!==n.height)&&(g.width=n.width,g.height=n.height,g.uploadProjectionTransform(!0))}},uploadTexture:function(f){var b=this.gl;if(c[f.src]){f.texture=c[f.src]}else{var e=b.createTexture();b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,e);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,1);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,f);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.uniform1i(this.u_Sampler,0);b.bindTexture(b.TEXTURE_2D,null);f.texture=e;c[f.src]=e}},uploadProjectionTransform:function(d){var b=this.gl;if(!this._projectionTransformElements||d){this._projectionTransformElements=new Float32Array([2/this.width,0,0,0,2/this.height,0,-1,1,1])}b.uniformMatrix3fv(this.u_projectionTransform,!1,this._projectionTransformElements)},_createProgram:function(n,f,e){f=this._createShader(n,n.VERTEX_SHADER,f);var g=this._createShader(n,n.FRAGMENT_SHADER,e);if(!f||!g){return null}if(e=n.createProgram()){if(n.attachShader(e,f),n.attachShader(e,g),n.linkProgram(e),n.deleteShader(g),n.deleteShader(f),!n.getProgramParameter(e,n.LINK_STATUS)){return f=n.getProgramInfoLog(e),console.log("Failed to link program: "+f),n.deleteProgram(e),null}}return e},_createShader:function(f,e,d){if(e=f.createShader(e)){if(f.shaderSource(e,d),f.compileShader(e),!f.getShaderParameter(e,f.COMPILE_STATUS)){return d=f.getShaderInfoLog(e),console.log("Failed to compile shader: "+d),f.deleteShader(e),null}}return e}};m.isSupport=function(){if(void 0===this._isSupport){var a=document.createElement("canvas");a.getContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))?this._isSupport=!0:this._isSupport=!1}return this._isSupport};j.WebGLRenderer=m})(window);(function(a){a=a.Hilo;var b=a.Class.create({Extends:a.Renderer,constructor:function(c){b.superclass.constructor.call(this,c);this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(c){return c.visible&&0<c.alpha?(c===this.stage&&this.clear(0,0,c.width,c.height),this.context.save(),!0):!1},draw:function(n){var o=this.context,r=n.width,s=n.height;n.clipChildren&&(o.beginPath(),o.rect(0,0,r,s),o.clip());var q=n.background;q&&(o.fillStyle=q,o.fillRect(0,0,r,s));var k=n.drawable;if(q=k&&k.image){var k=k.rect,u=k[2],m=k[3],l=k[4],j=k[5];r||s||(r=n.width=u,s=n.height=m);(l||j)&&o.translate(l-0.5*u,j-0.5*m);o.drawImage(q,k[0],k[1],u,m,0,0,r,s)}},endDraw:function(c){this.context.restore()},transform:function(x){var y=this.context,A=x.x,B=x.y,z=x.scaleX,u=x.scaleY,C=x.pivotX,w=x.pivotY,v=x.rotation%360,j=x.align;if(j){if("function"===typeof j){x.align()}else{var o=x.parent;if(o){var q=x.width,s=x.height,r=o.width,o=o.height;switch(j){case"TL":B=A=0;break;case"T":A=r-q>>1;B=0;break;case"TR":A=r-q;B=0;break;case"L":A=0;B=o-s>>1;break;case"C":A=r-q>>1;B=o-s>>1;break;case"R":A=r-q;B=o-s>>1;break;case"BL":A=0;B=o-s;break;case"B":A=r-q>>1;B=o-s;break;case"BR":A=r-q,B=o-s}}}}0==A&&0==B||y.translate(A,B);0!=v&&y.rotate(v*Math.PI/180);1==z&&1==u||y.scale(z,u);0==C&&0==w||y.translate(-C,-w);0<x.alpha&&(y.globalAlpha*=x.alpha)},clear:function(g,h,c,f){this.context.clearRect(g,h,c,f)},resize:function(c,f){this.canvas.width=c;this.canvas.height=f}});a.CanvasRenderer=b})(window);(function(c){var h=c.Hilo,j=h.Class,k=h.Event,a=h.Matrix;c=function(){function b(z,C,A){for(var y=z.length,u=C.length,t,s,o,r,p,n,E=0,D=t=0;D<y;D++){t=z[D];s=z[D<y-1?D+1:0];E=t.y-s.y;t=s.x-t.x;s=Math.sqrt(E*E+t*t);E/=s;t/=s;s=o=z[0].x*E+z[0].y*t;for(var B=1;B<y;B++){n=z[B].x*E+z[B].y*t,n>o?o=n:n<s&&(s=n)}r=p=C[0].x*E+C[0].y*t;for(B=1;B<u;B++){n=C[B].x*E+C[B].y*t,n>p?p=n:n<r&&(r=n)}s<r?(s=r-o,E=-E,t=-t):s-=p;if(0<=s){return !1}s>A.overlap&&(A.overlap=s,A.normal.x=E,A.normal.y=t)}return A}return j.create({Mixes:k,constructor:function(d){d=d||{};this.id=this.id||d.id||h.getUid("View");h.copy(this,d,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var e=this,d;d=e.parent;){e=d}return e.canvas?e:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(e,d){"number"===typeof d?e.addChildAt(this,d):e.addChild(this);return this},removeFromParent:function(){var d=this.parent;d&&d.removeChild(this);return this},getBounds:function(){for(var x=this.width,z=this.height,y=this.getConcatenatedMatrix(),x=this.boundsArea||[{x:0,y:0},{x:x,y:0},{x:x,y:z},{x:0,y:z}],z=[],w,u,t,s,o,r,p,n=0,A=x.length;n<A;n++){w=y.transformPoint(x[n],!0,!0),u=w.x,t=w.y,0==n?(s=o=u,r=p=t):(s>u?s=u:o<u&&(o=u),r>t?r=t:p<t&&(p=t)),z[n]=w}z.x=s;z.y=r;z.width=o-s;z.height=p-r;return z},getConcatenatedMatrix:function(w){for(var x=new a(1,0,0,1,0,0),v=this;v!=w&&v.parent;v=v.parent){var u=1,t=0,s=v.rotation%360,o=v.pivotX,p=v.pivotY,r=v.scaleX,q=v.scaleY;s&&(t=s*Math.PI/180,u=Math.cos(t),t=Math.sin(t));0!=o&&(x.tx-=o);0!=p&&(x.ty-=p);x.concat(u*r,t*r,-t*q,u*q,v.x,v.y)}return x},hitTestPoint:function(z,C,A){var y=this.getBounds(),u=z>=y.x&&z<=y.x+y.width&&C>=y.y&&C<=y.y+y.height;if(u&&A){A=0;for(var u=!1,t,s,o,r,p=0,n=y.length;p<n;p++){var E=y[p],D=y[(p+1)%n];if(E.y==D.y&&C==E.y&&(E.x>D.x?(t=D.x,s=E.x):(t=E.x,s=D.x),z>=t&&z<=s)){u=!0;continue}E.y>D.y?(o=D.y,r=E.y):(o=E.y,r=D.y);if(!(C<o||C>r)){var B=(C-E.y)*(D.x-E.x)/(D.y-E.y)+E.x;B>z?A++:B==z&&(u=!0);E.x>z&&E.y==C&&(E=y[(n+p-1)%n],(E.y<C&&D.y>C||E.y>C&&D.y<C)&&A++)}}u=u||1==A%2}return u},hitTestObject:function(o,g){var n=this.getBounds(),m=o.getBounds(),l=n.x<=m.x+m.width&&m.x<=n.x+n.width&&n.y<=m.y+m.height&&m.y<=n.y+n.height;l&&g&&(l=(l=b(n,m,{overlap:-Infinity,normal:{x:0,y:0}}))?b(m,n,l):!1);return !!l},_render:function(e,d){this.onUpdate&&!1===this.onUpdate(d)||!e.startDraw(this)||(e.transform(this),this.render(e,d),e.endDraw(this))},_fireMouseEvent:function(e){e.eventCurrentTarget=this;this.fire(e);if("mousemove"==e.type){if(!this.__mouseOver){this.__mouseOver=!0;var d=h.copy({},e);d.type="mouseover";this.fire(d)}}else{"mouseout"==e.type&&(this.__mouseOver=!1)}d=this.parent;e._stopped||e._stopPropagationed||!d||("mouseout"==e.type||"touchout"==e.type?d.hitTestPoint(e.stageX,e.stageY,!0)||d._fireMouseEvent(e):d._fireMouseEvent(e))},onUpdate:null,render:function(e,d){e.draw(this)},toString:function(){return h.viewToString(this)}})}();h.View=c})(window);(function(a){var b=a.Hilo,c=b.Drawable,h=b.Class.create({Extends:b.View,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("Container");h.superclass.constructor.call(this,d);this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(g,j){var n=this.children,m=n.length,l=g.parent;j=0>j?0:j>m?m:j;var k=this.getChildIndex(g);if(k==j){return this}0<=k?(n.splice(k,1),j=j==m?m-1:j):l&&l.removeChild(g);n.splice(j,0,g);0>k?this._updateChildren(j):this._updateChildren(k<j?k:j,(k<j?j:k)+1);g.drawable&&g.drawable.domElement&&this.setDOMContainer(!0);return this},addChild:function(f){for(var g=this.children.length,l=arguments,k=0,j=l.length;k<j;k++){this.addChildAt(l[k],g+k)}return this},removeChildAt:function(g){var j=this.children;if(0>g||g>=j.length){return null}var n=j[g];if(n){var m=n.drawable,l=m&&m.domElement;if(l){var k=l.parentNode;k&&k.removeChild(l);m.domElement=null;this.setDOMContainer(!1)}n.parent=null;n.depth=-1}j.splice(g,1);this._updateChildren(g);return n},removeChild:function(d){return this.removeChildAt(this.getChildIndex(d))},removeChildById:function(f){for(var g=this.children,l,k=0,j=g.length;k<j;k++){if(l=g[k],l.id===f){return this.removeChildAt(k),l}}return null},removeAllChildren:function(){for(;this.children.length;){this.removeChildAt(0)}return this},getChildAt:function(d){var e=this.children;return 0>d||d>=e.length?null:e[d]},getChildById:function(f){for(var g=this.children,l,k=0,j=g.length;k<j;k++){if(l=g[k],l.id===f){return l}}return null},getChildIndex:function(d){return this.children.indexOf(d)},setChildIndex:function(f,g){var l=this.children,k=l.indexOf(f);if(0<=k&&k!=g){var j=l.length;g=0>g?0:g>=j?j-1:g;l.splice(k,1);l.splice(g,0,f);this._updateChildren()}return this},swapChildren:function(f,g){var l=this.children,k=this.getChildIndex(f),j=this.getChildIndex(g);f.depth=j;l[j]=f;g.depth=k;l[k]=g},swapChildrenAt:function(f,g){var l=this.children,k=this.getChildAt(f),j=this.getChildAt(g);k.depth=g;l[g]=k;j.depth=f;l[f]=j},sortChildren:function(d){var e=this.children;if("string"==typeof d){var f=d;d=function(j,g){return g[f]-j[f]}}e.sort(d);this._updateChildren()},_updateChildren:function(f,g){var l=this.children,k;g=g||l.length;for(var j=f||0;j<g;j++){k=l[j],k.depth=j+1,k.parent=this}},contains:function(d){for(;d=d.parent;){if(d===this){return !0}}return !1},getViewAtPoint:function(u,v,t,s,r){if(this.clipChildren&&!this.hitTestPoint(u,v,t)){return null}for(var q=s?[]:null,o=this.children,j,k,l=o.length-1;0<=l;l--){if(j=o[l],!(!j||!j.visible||0>=j.alpha||r&&!j.pointerEnabled)){if(j.children&&j.children.length&&(!r||j.pointerChildren)&&(k=j.getViewAtPoint(u,v,t,s,r)),k){if(s){k.length&&(q=q.concat(k))}else{return k}}else{if(j.hitTestPoint(u,v,t)){if(s){q.push(j)}else{return j}}}}}return s&&q.length?q:null},render:function(d,f){h.superclass.render.call(this,d,f);"dom"!=d.renderType&&this.drawable&&this.drawable.domElement&&b.setElementStyleByView(this,!0);var m=this.children.slice(0),l,k,j;l=0;for(k=m.length;l<k;l++){j=m[l],j.parent===this&&j._render(d,f)}},setDOMContainer:function(e){var f=this.parent,j=this.drawable,g=j&&j.domElement;if(e){j=this.drawable=this.drawable||new c,j.domElement=j.domElement||b.createElement("div",{style:{position:"absolute"}}),f&&f.setDOMContainer(!0)}else{e=!1;i=0;for(len=children.length;i<len;i++){if(child=children[i],child.drawable&&child.drawable.domElement){e=!0;break}}e||(g&&g&&((e=g.parentNode)&&e.removeChild(g),this.drawable=j.domElement=null),f&&f.setDOMContainer(!1))}}});b.Container=h})(window);(function(j){var k=j.Hilo,l=k.CanvasRenderer,m=k.DOMRenderer,c=k.WebGLRenderer,h=k.Class.create({Extends:k.Container,constructor:function(n){n=n||{};this.id=this.id||n.id||k.getUid("Stage");h.superclass.constructor.call(this,n);this._initRenderer(n);var a=this.width,g=this.height,f=this.updateViewport();n.width||(a=f&&f.width||320);n.height||(g=f&&f.height||480);this.resize(a,g,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(e){var b=e.canvas,d=e.container;e=e.renderType||"canvas";"string"===typeof b&&(b=k.getElement(b));"string"===typeof d&&(d=k.getElement(d));b||(b=k.createElement("dom"===e?"div":"canvas",{style:{position:"absolute",overflow:"hidden"}}));this.canvas=b;d&&d.appendChild(b);b={canvas:b,stage:this};switch(e){case"dom":this.renderer=new m(b);break;case"webgl":c.isSupport()?this.renderer=new c(b):this.renderer=new l(b);break;default:this.renderer=new l(b)}},_render:function(w,y){if((!this.onUpdate||!1!==this.onUpdate(y))&&w.startDraw(this)){var x=this.width,v=this.height,u=this.scaleX,t=this.scaleY,s=this._height,o=this._scaleX,r=this._scaleY,p=this.canvas,n=p.style;if(this._width!==x||o!==u){this._width=x,this._scaleX=u,p.width=x,n.width=u*x+"px"}if(s!==v||r!==t){this._height=v,this._scaleY=t,p.height=v,n.height=t*v+"px"}(x=this.drawable&&this.drawable.domElement)&&!x.parentNode&&(x.style.overflow="hidden",p.appendChild(x));this.render(w,y);w.endDraw(this)}},addTo:function(d){var b=this.canvas;b.parentNode!==d&&d.appendChild(b);return this},tick:function(a){this.paused||this._render(this.renderer,a)},enableDOMEvent:function(t,o){var n=this,s=n.canvas,r="string"===typeof t?[t]:t;o=!1!==o;for(var q=n._domListener||(n._domListener=function(a){n._onDOMEvent(a)}),p=0;p<r.length;p++){t=r[p],o?s.addEventListener(t,q,!1):s.removeEventListener(t,q)}return n},_onDOMEvent:function(u){var p=u.type,o=0==p.indexOf("touch"),s=u;if(o){var r=u.touches,s=u.changedTouches,s=r&&r.length?r[0]:s&&s.length?s[0]:null}var r=s.pageX||s.clientX,s=s.pageY||s.clientY,q=this.viewport||this.updateViewport();u.stageX=r=(r-q.left)/this.scaleX;u.stageY=s=(s-q.top)/this.scaleY;u.stopPropagation=function(){this._stopPropagationed=!0};var r=this.getViewAtPoint(r,s,!0,!1,!0)||this,s=this.canvas,q=this._eventTarget,t="mouseout"===p;if(q&&(!(q==r||q.contains&&q.contains(r))||t)){if(t="touchmove"===p?"touchout":"mousemove"===p||t||!r?"mouseout":null){var f=k.copy({},u);f.type=t;f.eventTarget=q;q._fireMouseEvent(f)}u.lastEventTarget=q;this._eventTarget=null}r&&r.pointerEnabled&&"mouseout"!==p&&(u.eventTarget=this._eventTarget=r,r._fireMouseEvent(u));o||(s.style.cursor=r&&r.pointerEnabled&&r.useHandCursor?"pointer":"");k.browser.android&&"touchmove"===p&&u.preventDefault()},updateViewport:function(){var e=this.canvas,d=null;e.parentNode&&(d=this.viewport=k.getElementRect(e));return d},resize:function(f,e,g){if(g||this.width!==f||this.height!==e){this.width=f,this.height=e,this.renderer.resize(f,e),this.updateViewport()}},setDOMContainer:function(a){h.superclass.setDOMContainer.call(this,a);a&&(a=this.drawable&&this.drawable.domElement)&&!a.parentNode&&this.canvas.parentNode&&this.canvas.parentNode.appendChild(a)}});k.Stage=h})(window);(function(a){var b=a.Hilo,c=b.Drawable,h=b.Class.create({Extends:b.View,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("Bitmap");h.superclass.constructor.call(this,d);this.drawable=new c(d);if(!this.width||!this.height){if(d=this.drawable.rect){this.width=d[2],this.height=d[3]}}},setImage:function(d,e){this.drawable.init({image:d,rect:e});e&&(this.width=e[2],this.height=e[3]);return this}});b.Bitmap=h})(window);(function(a){var b=a.Hilo,c=b.Drawable,h=b.Class.create({Extends:b.View,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("Sprite");h.superclass.constructor.call(this,d);this._frames=[];this._frameNames={};this.drawable=new c;d.frames&&this.addFrame(d.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(f,g){var l=null!=g?g:this._frames.length;if(f instanceof Array){for(var k=0,j=f.length;k<j;k++){this.setFrame(f[k],l+k)}}else{this.setFrame(f,l)}return this},setFrame:function(e,f){var j=this._frames,g=j.length;f=0>f?0:f>g?g:f;j[f]=e;e.name&&(this._frameNames[e.name]=e);if(0==f&&!this.width||!this.height){this.width=e.rect[2],this.height=e.rect[3]}return this},getFrame:function(d){if("number"===typeof d){var e=this._frames;return 0>d||d>=e.length?null:e[d]}return this._frameNames[d]},getFrameIndex:function(f){var g=this._frames,l=g.length,k=-1;if("number"===typeof f){k=f}else{if(f="string"===typeof f?this._frameNames[f]:f){for(var j=0;j<l;j++){if(f===g[j]){k=j;break}}}}return k},play:function(){this.paused=!1;return this},stop:function(){this.paused=!0;return this},"goto":function(e,f){var j=this._frames.length,g=this.getFrameIndex(e);this.currentFrame=0>g?0:g>=j?j-1:g;this.paused=f;this._firstRender=!0;return this},_render:function(d,f){var j=this.currentFrame,g;this._firstRender?(g=j,this._firstRender=!1):g=this._nextFrame(f);g!=j&&(this.currentFrame=g,(j=this._frames[g].callback)&&j.call(this));if(this.onEnterFrame){this.onEnterFrame(g)}this.drawable.init(this._frames[g]);h.superclass._render.call(this,d,f)},_nextFrame:function(f){var g=this._frames,l=g.length,k=this.currentFrame,g=g[k],j=this._frameElapsed;f=0!=k||this.drawable?j+(this.timeBased?f:1):0;j=this._frameElapsed=f<(g.duration||this.interval)?f:0;(g.stop||!this.loop&&k>=l-1)&&this.stop();this.paused||0!=j||(null!=g.next?k=this.getFrameIndex(g.next):k>=l-1?k=0:this.drawable&&k++);return k},setFrameCallback:function(d,e){if(d=this.getFrame(d)){d.callback=e}return this},onEnterFrame:null});b.Sprite=h})(window);(function(a){var b=a.Hilo,c=b.Drawable,h=b.Class.create({Extends:b.View,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("Button");h.superclass.constructor.call(this,d);this.drawable=new c(d);this.setState(h.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(d){this.enabled!=d&&(d?this.setState(h.UP):this.setState(h.DISABLED));return this},setState:function(d){if(this.state!==d){this.state=d;this.pointerEnabled=this.enabled=d!==h.DISABLED;var e;switch(d){case h.UP:e=this.upState;break;case h.OVER:e=this.overState;break;case h.DOWN:e=this.downState;break;case h.DISABLED:e=this.disabledState}e&&(this.drawable.init(e),b.copy(this,e,!0))}return this},fire:function(d,e){if(this.enabled){switch("string"===typeof d?d:d.type){case"mousedown":case"touchstart":case"touchmove":this.setState(h.DOWN);break;case"mouseover":this.setState(h.OVER);break;case"mouseup":this.overState?this.setState(h.OVER):this.upState&&this.setState(h.UP);break;case"touchend":case"touchout":case"mouseout":this.setState(h.UP)}return h.superclass.fire.call(this,d,e)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});b.Button=h})(window);(function(j){var k=j.Hilo;j=k.Class;var l=k.View,m=k.createElement("canvas"),c=m&&m.getContext("2d"),h=j.create({Extends:l,constructor:function(a){a=a||{};this.id=this.id||a.id||k.getUid("Text");h.superclass.constructor.call(this,a);a.font||(this.font="12px arial");this._fontHeight=h.measureFontHeight(this.font)},text:null,color:"#000",textAlign:null,textVAlign:null,outline:!1,lineSpacing:0,maxWidth:200,font:null,textWidth:0,textHeight:0,cacheDirty:!0,cache:function(b){(b||this._cacheDirty||!this._cacheImage)&&this.updateCache()},updateCache:function(){m.width=this.width;m.height=this.height;this._draw(c);this._cacheImage=new Image;this._cacheImage.src=m.toDataURL();this.drawable=this.drawable||new Drawable;this.drawable.init(this._cacheImage);this.cacheDirty=!1},setCacheDirty:function(b){this._cacheDirty=b},setFont:function(a){this.font!==a&&(this.font=a,this._fontHeight=h.measureFontHeight(a),this.setCacheDirty(!0));return this},render:function(g,f){if("canvas"===g.renderType){this._draw(g.context)}else{if("dom"===g.renderType){var o=this.drawable.domElement,n=o.style;n.font=this.font;n.textAlign=this.textAlign;n.color=this.color;n.width=this.width+"px";n.height=this.height+"px";n.lineHeight=this._fontHeight+this.lineSpacing+"px";o.innerHTML=this.text}else{this.cache()}g.draw(this)}},_draw:function(B){var A=this.text.toString();if(A){B.font=this.font;B.textAlign=this.textAlign;B.textBaseline="top";var z=A.split(/\r\n|\r|\n|<br(?:[ \/])*>/),y=0,x=0,u=this._fontHeight+this.lineSpacing,p,r,t,A=[];p=0;for(len=z.length;p<len;p++){if(r=z[p],t=B.measureText(r).width,t<=this.maxWidth){A.push({text:r,y:x}),y<t&&(y=t),x+=u}else{t="";var s=0,o,D,C;D=0;for(wlen=r.length;D<wlen;D++){C=r[D],o=B.measureText(t+C).width,o>this.maxWidth?(A.push({text:t,y:x}),y<s&&(y=s),x+=u,t=C):(s=o,t+=C),D==wlen-1&&(A.push({text:t,y:x}),t!==C&&y<o&&(y=o),x+=u)}}}this.textWidth=y;this.textHeight=x;this.width||(this.width=y);this.height||(this.height=x);z=0;switch(this.textVAlign){case"middle":z=this.height-this.textHeight>>1;break;case"bottom":z=this.height-this.textHeight}if(p=this.background){B.fillStyle=p,B.fillRect(0,0,this.width,this.height)}this.outline?B.strokeStyle=this.color:B.fillStyle=this.color;for(p=0;p<A.length;p++){r=A[p],this._drawTextLine(B,r.text,z+r.y)}}},_drawTextLine:function(n,g,q){var p=0,o=this.width;switch(this.textAlign){case"center":p=o>>1;break;case"right":case"end":p=o}this.outline?n.strokeText(g,p,q):n.fillText(g,p,q)},Statics:{measureFontHeight:function(f){var e=document.documentElement,g=k.createElement("div",{style:{font:f,position:"absolute"},innerHTML:"M"});e.appendChild(g);f=g.offsetHeight;e.removeChild(g);return f}}});k.Text=h})(window);(function(a){var b=a.Hilo,c=b.Bitmap,h=b.Class.create({Extends:b.Container,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("BitmapText");h.superclass.constructor.call(this,d);if(d=d.text+""){this.text="",this.setText(d)}this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(j){j=j.toString();var k=j.length;if(this.text!=j){this.text=j;var p,o,n,m=n=0,l=0;for(p=0;p<k;p++){if(o=j.charAt(p),o=this.glyphs[o]){l=n+(0<n?this.letterSpacing:0),this.children[p]?(n=this.children[p],n.setImage(o.image,o.rect)):(n=this._createBitmap(o),this.addChild(n)),n.x=l,n=l+o.rect[2],m=Math.max(m,o.rect[3])}}for(p=this.children.length-1;p>=k;p--){this._releaseBitmap(this.children[p]),this.children[p].removeFromParent()}this.width=n;this.height=m;this.setTextAlign();return this}},_createBitmap:function(d){var e;h._pool.length?(e=h._pool.pop(),e.setImage(d.image,d.rect)):e=new c({image:d.image,rect:d.rect});return e},_releaseBitmap:function(d){h._pool.push(d)},setTextAlign:function(d){this.textAlign=d||this.textAlign;switch(this.textAlign){case"center":this.pivotX=0.5*this.width;break;case"right":this.pivotX=this.width;break;default:this.pivotX=0}return this},hasGlyphs:function(e){var f=this.glyphs;if(!f){return !1}e=e.toString();var j=e.length,g;for(g=0;g<j;g++){if(!f[e.charAt(g)]){return !1}}return !0},Statics:{_pool:[],createGlyphs:function(j,k,r,q){var o=j.toString();r=r||o.length;var m=k.width/r;q=k.height/(q||1);var l={},n=0;for(j=j.length;n<j;n++){charStr=o.charAt(n),l[charStr]={image:k,rect:[n%r*m,q*Math.floor(n/r),m,q]}}return l}}});b.BitmapText=h})(window);(function(a){var b=a.Hilo,c=b.Drawable,h=b.Class.create({Extends:b.View,constructor:function(d){d=d||{};this.id=this.id||d.id||b.getUid("DOMElement");h.superclass.constructor.call(this,d);this.drawable=new c;(this.drawable.domElement=d.element||b.createElement("div",{style:{position:"absolute"}})).id=this.id},_render:function(d,e){this.onUpdate&&!1===this.onUpdate(e)||this.visible&&this.render(d,e)},render:function(d,e){"dom"!=d.renderType?b.setElementStyleByView(this):d.draw(this)}});b.DOMElement=h})(window);(function(a){a=a.Hilo;var b=a.Class,c=function(){function e(d,f){var g={image:d.image,rect:d.rect};f&&(g.name=f.name||null,g.duration=f.duration||0,g.stop=!!f.stop,g.next=f.next||null);return g}return b.create({constructor:function(r){var s;var q=r.frames;if(q){s=[];var o;if(q instanceof Array){for(var l=0,k=q.length;l<k;l++){o=q[l],s[l]={image:r.image,rect:o}}}else{o=q.frameWidth;for(var k=q.frameHeight,t=r.width/o|0,l=r.height/k|0,q=q.numFrames||t*l,l=0;l<q;l++){s[l]={image:r.image,rect:[l%t*o,(l/t|0)*k,o,k]}}}}else{s=null}this._frames=s;var d;s=this._frames;if(r=r.sprites){var q={},h;for(d in r){l=r[d];if("number"===typeof l){o=e(s[l])}else{if(l instanceof Array){for(o=[],k=0,t=l.length;k<t;k++){h=l[k];var j;"number"===typeof h?h=e(s[h]):(j=h.rect,"number"===typeof j&&(j=s[h.rect]),h=e(j,h));o[k]=h}}else{for(o=[],k=l.from;k<=l.to;k++){o[k-l.from]=e(s[k],l[k])}}}q[d]=o}d=q}else{d=null}this._sprites=d},_frames:null,_sprites:null,getFrame:function(d){var f=this._frames;return f&&f[d]},getSprite:function(d){var f=this._sprites;return f&&f[d]},Statics:{createSpriteFrames:function(x,y,w,v,u,t,s){if("[object Array]"===Object.prototype.toString.call(x)){y=[];for(var h=0,j=x.length;h<j;h++){y=y.concat(this.createSpriteFrames.apply(this,x[h]))}}else{if("string"===typeof y){var o=y.split(",");y=[];for(var r=0,q=o.length;r<q;r++){if(j=o[r].split("-"),1==j.length){y.push(parseInt(j[0]))}else{for(h=parseInt(j[0]),j=parseInt(j[1]);h<=j;h++){y.push(h)}}}}o=Math.floor(w.width/v);for(h=0;h<y.length;h++){r=y[h],y[h]={rect:[r%o*v,u*Math.floor(r/o),v,u],image:w,duration:s}}y[0].name=x;t?y[y.length-1].next=x:y[y.length-1].stop=!0}return y}}})}();a.TextureAtlas=c})(window);