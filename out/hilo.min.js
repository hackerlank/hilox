(function(a){a.console=a.console||{log:function(){}};a=Array.prototype;var b=a.slice;a.indexOf=a.indexOf||function(g,i){i=i||0;var d=this.length,h;if(0==d||i>=d){return -1}0>i&&(i=d+i);for(h=i;h<d;h++){if(this[h]===g){return h}}return -1};a=Function.prototype;a.bind=a.bind||function(g){function k(){var c=i.concat(b.call(arguments));return f.apply(this instanceof k?this:g,c)}var f=this,i=b.call(arguments,1),j=function(){};j.prototype=f.prototype;k.prototype=new j;return k}})(window);(function(b){for(var d=0,a=["ms","moz","webkit","o"],e=0;e<a.length&&!b.requestAnimationFrame;++e){b.requestAnimationFrame=b[a[e]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[a[e]+"CancelAnimationFrame"]||b[a[e]+"CancelRequestAnimationFrame"]}b.requestAnimationFrame||(b.requestAnimationFrame=function(f,h){var i=(new Date).getTime(),c=Math.max(0,16-(i-d)),g=b.setTimeout(function(){f(i+c)},c);d=i+c;return g});b.cancelAnimationFrame||(b.cancelAnimationFrame=function(c){clearTimeout(c)})})(window);(function(a){var b=function(){var e=document,f=e.documentElement,d=0;return{getUid:function(g){var h=++d;if(g){var c=g.charCodeAt(g.length-1);48<=c&&57>=c&&(g+="_");return g+h}return h},viewToString:function(c){for(var g;c;){g=g?c.id+"."+g:c.id,c=c.parent}return g},copy:function(h,i,c){for(var g in i){if(!c||h.hasOwnProperty(g)||void 0!==h[g]){h[g]=i[g]}}return h},browser:function(){var l=navigator.userAgent,l={iphone:/iphone/i.test(l),ipad:/ipad/i.test(l),ipod:/ipod/i.test(l),ios:/iphone|ipad|ipod/i.test(l),android:/android/i.test(l),webkit:/webkit/i.test(l),chrome:/chrome/i.test(l),safari:/safari/i.test(l),firefox:/firefox/i.test(l),ie:/msie/i.test(l),opera:/opera/i.test(l),supportTouch:"ontouchstart" in a,supportCanvas:null!=e.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation" in a,supportDeviceMotion:"ondevicemotion" in a};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),l.supportStorage=!0}catch(g){}var m=l.jsVendor=l.webkit?"webkit":l.firefox?"Moz":l.opera?"O":l.ie?"ms":"",c=l.cssVendor="-"+m+"-",h=e.createElement("div"),i=h.style,j=void 0!=i[m+"Transform"];if(m=void 0!=i[m+"Perspective"]){h.id="test3d",i=e.createElement("style"),i.textContent="@media ("+c+"transform-3d){#test3d{height:3px}}",e.head.appendChild(i),f.appendChild(h),m=3==h.offsetHeight,e.head.removeChild(i),f.removeChild(h)}l.supportTransform=j;l.supportTransform3D=m;return l}(),event:function(){var c="ontouchstart" in a;return{POINTER_START:c?"touchstart":"mousedown",POINTER_MOVE:c?"touchmove":"mousemove",POINTER_END:c?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElementRect:function(m){try{var n=m.getBoundingClientRect()}catch(q){n={top:m.offsetTop,left:m.offsetLeft,width:m.offsetWidth,height:m.offsetHeight}}var o=(a.pageXOffset||f.scrollLeft)-(f.clientLeft||0)||0,i=(a.pageYOffset||f.scrollTop)-(f.clientTop||0)||0,s=a.getComputedStyle?getComputedStyle(m):m.currentStyle,c=parseInt;m=c(s.paddingLeft)+c(s.borderLeftWidth)||0;var g=c(s.paddingTop)+c(s.borderTopWidth)||0,l=c(s.paddingRight)+c(s.borderRightWidth)||0,s=c(s.paddingBottom)+c(s.borderBottomWidth)||0,c=n.top||0,j=n.left||0;return{left:j+o+m,top:c+i+g,width:n.right-l-j-m,height:n.bottom-s-c-g}},createElement:function(j,l){var g=e.createElement(j),i,h,m;for(i in l){if(h=l[i],"style"===i){for(m in h){g.style[m]=h[m]}}else{g[i]=h}}return g},getElement:function(c){return e.getElementById(c)},setElementStyleByView:function(j){var l=j.drawable,g=l.domElement.style,i=j._stateCache||(j._stateCache={}),h=b.browser.jsVendor,m=!1;this.cacheStateIfChanged(j,["visible"],i)&&(g.display=j.visible?"":"none");this.cacheStateIfChanged(j,["alpha"],i)&&(g.opacity=j.alpha);if(j.visible&&!(0>=j.alpha)){this.cacheStateIfChanged(j,["width"],i)&&(g.width=j.width+"px");this.cacheStateIfChanged(j,["height"],i)&&(g.height=j.height+"px");this.cacheStateIfChanged(j,["depth"],i)&&(g.zIndex=j.depth+1);if(m=this.cacheStateIfChanged(j,["pivotX","pivotY"],i)){g[h+"TransformOrigin"]=j.pivotX+"px "+j.pivotY+"px"}if(this.cacheStateIfChanged(j,["x","y","rotation","scaleX","scaleY"],i)||m){g[h+"Transform"]=this.getTransformCSS(j)}this.cacheStateIfChanged(j,["background"],i)&&(g.backgroundColor=j.background);g.pointerEvents||(g.pointerEvents="none");if(m=l.image){if(m=m.src,m!==i.image&&(i.image=m,g.backgroundImage="url("+m+")"),m=l.rect){l=m[0],m=m[1],l!==i.sx&&(i.sx=l,g.backgroundPositionX=-l+"px"),m!==i.sy&&(i.sy=m,g.backgroundPositionY=-m+"px")}}if(j=j.mask){if(l=j.drawable.domElement.style.backgroundImage,l!==i.maskImage&&(i.maskImage=l,g[h+"MaskImage"]=l,g[h+"MaskRepeat"]="no-repeat"),l=j.x,j=j.y,l!==i.maskX||j!==i.maskY){i.maskX=l,i.maskY=j,g[h+"MaskPosition"]=l+"px "+j+"px"}}}},cacheStateIfChanged:function(h,n,g){var i,o,j,m,l=!1;i=0;for(o=n.length;i<o;i++){j=n[i],m=h[j],m!=g[j]&&(g[j]=m,l=!0)}return l},getTransformCSS:function(g){var h=this.browser.supportTransform3D,c=h?"3d":"";return"translate"+c+"("+(g.x-g.pivotX)+"px, "+(g.y-g.pivotY)+(h?"px, 0px)":"px)")+"rotate"+c+(h?"(0, 0, 1, ":"(")+g.rotation+"deg)scale"+c+"("+g.scaleX+", "+g.scaleY+(h?", 1)":")")}}}();b.undefined=void 0;a.Hilo=b})(window);(function(a){a=a.Hilo;var b=function(){var j=function(c){var k={},e,f;for(e in c){f=c[e],n.hasOwnProperty(e)?n[e].call(this,f):k[e]=f}l(this.prototype,k)},n={Extends:function(e){var f=this.prototype,k=h(e.prototype);l(this,e);l(k,f);k.constructor=this;this.prototype=k;this.superclass=e.prototype},Mixes:function(c){c instanceof Array||(c=[c]);for(var f=this.prototype,e;e=c.shift();){l(f,e.prototype||e)}},Statics:function(c){l(this,c)}},h=function(){if(Object.__proto__){return function(d){return{__proto__:d}}}var c=function(){};return function(e){c.prototype=e;return new c}}(),l=function(s){for(var k=1,r=arguments.length;k<r;k++){var t=arguments[k],q,o;for(o in t){var p=t[o];!p||"object"!==typeof p||void 0===p.value&&"function"!==typeof p.get&&"function"!==typeof p.set?s[o]=p:(q=q||{},q[o]=p)}q&&g(s,q)}return s};try{var m=Object.defineProperty,g=Object.defineProperties;m({},"$",{value:0})}catch(i){"__defineGetter__" in Object&&(m=function(c,f,e){"value" in e&&(c[f]=e.value);"get" in e&&c.__defineGetter__(f,e.get);"set" in e&&c.__defineSetter__(f,e.set);return c},g=function(c,d){for(var e in d){d.hasOwnProperty(e)&&m(c,e,d[e])}return c})}return{create:function(c){c=c||{};var d=c.hasOwnProperty("constructor")?c.constructor:function(){};j.call(d,c);return d},mix:l}}();a.Class=b})(window);(function(b){var d=b.Hilo,a=d.Class.create({constructor:function(c,f,g){this.type=c;this.target=f;this.detail=g;this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}});if(b=b.Event){b=b.prototype;var e=b.stopImmediatePropagation;b.stopImmediatePropagation=function(){e&&e.call(this);this._stopped=!0}}d.Event={_listeners:null,on:function(f,h,i){var c=this._listeners=this._listeners||{};f=c[f]=c[f]||[];for(var c=0,g=f.length;c<g;c++){if(f[c].listener===h){return}}f.push({listener:h,once:i});return this},off:function(f,h){if(0==arguments.length){return this._listeners=null,this}var i=this._listeners&&this._listeners[f];if(i){if(1==arguments.length){return delete this._listeners[f],this}for(var c=0,g=i.length;c<g;c++){if(i[c].listener===h){i.splice(c,1);0===i.length&&delete this._listeners[f];break}}}return this},fire:function(g,l){var m,f;"string"===typeof g?f=g:(m=g,f=g.type);var h=this._listeners;if(!h){return !1}var n=h[f];if(n){n=n.slice(0);m=m||new a(f,this,l);if(m._stopped){return !1}for(var i=0;i<n.length;i++){var j=n[i];j.listener.call(this,m);j.once&&n.splice(i--,1)}0==n.length&&delete h[f];return !0}return !1}}})(window);(function(a){a=a.Hilo;var b=a.Class.create({constructor:function(i,l,h,j,k,g){this.a=i;this.b=l;this.c=h;this.d=j;this.tx=k;this.ty=g},concat:function(s){var w=arguments,y=this.a,t=this.b,v=this.c,x=this.d,m=this.tx,z=this.ty;if(6<=w.length){var h=w[0],j=w[1],o=w[2],i=w[3],l=w[4],w=w[5]}else{h=s.a,j=s.b,o=s.c,i=s.d,l=s.tx,w=s.ty}this.a=y*h+t*o;this.b=y*j+t*i;this.c=v*h+x*o;this.d=v*j+x*i;this.tx=m*h+z*o+l;this.ty=m*j+z*i+w;return this},rotate:function(l){var o=Math.sin(l);l=Math.cos(l);var h=this.a,m=this.b,n=this.c,g=this.d,i=this.tx,j=this.ty;this.a=h*l-m*o;this.b=h*o+m*l;this.c=n*l-g*o;this.d=n*o+g*l;this.tx=i*l-j*o;this.ty=i*o+j*l;return this},scale:function(d,e){this.a*=d;this.d*=e;this.c*=d;this.b*=e;this.tx*=d;this.ty*=e;return this},translate:function(d,e){this.tx+=d;this.ty+=e;return this},identity:function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this},invert:function(){var i=this.a,l=this.b,h=this.c,j=this.d,k=this.tx,g=i*j-l*h;this.a=j/g;this.b=-l/g;this.c=-h/g;this.d=i/g;this.tx=(h*this.ty-j*k)/g;this.ty=-(i*this.ty-l*k)/g;return this},transformPoint:function(h,k,g){var i=h.x*this.a+h.y*this.c+this.tx,j=h.x*this.b+h.y*this.d+this.ty;k&&(i=i+0.5>>0,j=j+0.5>>0);if(g){return{x:i,y:j}}h.x=i;h.y=j;return h}});a.Matrix=b})(window);(function(b){var c=b.Hilo,a=c.Class.create({constructor:function(d){this._targetFPS=d||30;this._interval=1000/this._targetFPS;this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(l){if(!this._intervalId){this._lastTime=+new Date;var g=this,i=this._interval,j=b.requestAnimationFrame||b[c.browser.jsVendor+"RequestAnimationFrame"];if(l&&j){var f=function(){g._tick()},h=function(){g._intervalId=setTimeout(h,i);j(f)}}else{h=function(){g._intervalId=setTimeout(h,i);g._tick()}}h()}},stop:function(){clearTimeout(this._intervalId);this._intervalId=null;this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var i=+new Date,f=i-this._lastTime,g=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1000/(this._tickTime/this._tickCount)+0.5>>0,this._tickTime=this._tickCount=0):this._tickTime+=i-this._lastTime;this._lastTime=i;for(var i=0,h=g.length;i<h;i++){g[i].tick(f)}}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(d){if(!d||"function"!=typeof d.tick){throw Error("Ticker: The tick object must implement the tick method.")}this._tickers.push(d)},removeTick:function(e){var d=this._tickers;e=d.indexOf(e);0<=e&&d.splice(e,1)}});c.Ticker=a})(window);(function(b){var c=b.Hilo,a=c.Class.create({constructor:function(d){this.init(d)},image:null,rect:null,init:function(i){var f=this,g=f.image;a.isDrawable(i)?f.image=i:c.copy(f,i,!0);i=f.image;if("string"===typeof i){if(g&&i===g.getAttribute("src")){i=f.image=g}else{f.image=null;var h=new Image;h.onload=function(){h.onload=null;f.init(h)};h.src=i;return}}i&&!f.rect&&(f.rect=[0,0,i.width,i.height])},Statics:{isDrawable:function(d){if(!d||!d.tagName){return !1}d=d.tagName.toLowerCase();return"img"===d||"canvas"===d||"video"===d}}});c.Drawable=a})(window);(function(b){var c=b.Hilo,a=c.Class.create({load:function(j){var g=j.src,h="jsonp"==j.type;if(h){var i=j.callbackName||"callback",f=j.callback||"jsonp"+ ++a._count;b[f]||(b[f]=function(d){delete b[f]})}h&&(g+=(-1==g.indexOf("?")?"?":"&")+i+"="+f);j.noCache&&(g+=(-1==g.indexOf("?")?"?":"&")+"t="+ +new Date);h=document.createElement("script");h.type="text/javascript";h.async=!0;h.onload=this.onLoad.bind(this);h.onerror=this.onError.bind(this);h.src=g;j.id&&(h.id=j.id);document.getElementsByTagName("head")[0].appendChild(h)},onLoad:function(d){d=d.target;d.onload=d.onerror=null;return d},onError:function(e){var d=e.target;d.onload=d.onerror=null;return e},Statics:{_count:0}});c.ScriptLoader=a})(window);(function(b){var c=b.Hilo,a=c.Class.create({load:function(g){var d=this,f=new Image;g.crossOrigin&&(f.crossOrigin=g.crossOrigin);f.onload=function(){d.onLoad(f)};f.onerror=f.onabort=d.onError.bind(f);f.src=g.src+(g.noCache?(-1==g.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(d){d=d||b.event;d.onload=d.onerror=d.onabort=null;return d},onError:function(e){var d=e.target;d.onload=d.onerror=d.onabort=null;return e}});c.ImageLoader=a})(window);(function(b){b=b.Hilo;var d=b.ImageLoader,a=b.ScriptLoader,e=b.Class.create({Mixes:b.Event,constructor:function(c){this._source=[];this.add(c)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(c){c&&(c=c instanceof Array?c:[c],this._source=this._source.concat(c));return this},get:function(f){if(f){for(var g=this._source,h=0;h<g.length;h++){var c=g[h];if(c.id===f||c.src===f){return c}}}return null},getContent:function(c){return(c=this.get(c))&&c.content},start:function(){this._loadNext();return this},_loadNext:function(){var g=this,j=g._source,l=j.length;if(g._loaded>=l){g.fire("complete")}else{if(g._currentIndex<l-1&&g._connections<g.maxConnections){var f=++g._currentIndex,j=j[f],h=g._getLoader(j);if(h){var m=h.onLoad,i=h.onError;h.onLoad=function(c){h.onLoad=m;h.onError=i;c=m&&m.call(h,c)||c.target;g._onItemLoad(f,c)};h.onError=function(c){h.onLoad=m;(h.onError=i)&&i.call(h,c);g._onItemError(f,c)};g._connections++}g._loadNext();h&&h.load(j)}}},_getLoader:function(f){var g=f.loader;if(g){return g}var h;if(!(h=f.type)){var c;if(f=f.src.match(/\/?[^/]+\.(\w+)(\?\S+)?$/i)){c=f[1].toLowerCase()}h=c||null}switch(h){case"png":case"jpg":case"jpeg":case"gif":g=new d;break;case"js":case"jsonp":g=new a}return g},_onItemLoad:function(c,f){var g=this._source[c];g.loaded=!0;g.content=f;this._connections--;this._loaded++;this.fire("load",g);this._loadNext()},_onItemError:function(c,f){var g=this._source[c];g.error=f;this._connections--;this._loaded++;this.fire("error",g);this._loadNext()},getSize:function(f){for(var h=0,i=this._source,c=0;c<i.length;c++){var g=i[c],h=h+((f?g.loaded&&g.size:g.size)||0)}return h},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});b.LoadQueue=e})(window);(function(a){var b=a.Hilo;a=b.Class.create({Mixes:b.Event,constructor:function(c){b.copy(this,c,!0);this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element){try{var d=this._element=new Audio;d.addEventListener("canplaythrough",this._onAudioEvent,!1);d.addEventListener("ended",this._onAudioEvent,!1);d.addEventListener("error",this._onAudioEvent,!1);d.src=this.src;d.volume=this.volume;d.load()}catch(e){d=this._element={},d.play=d.pause=function(){}}}return this},_onAudioEvent:function(d){var e=d.type;switch(e){case"canplaythrough":d.target.removeEventListener(e,this._onAudioEvent);this.loaded=!0;this.duration=this._element.duration;this.fire("load");this.autoPlay&&this._doPlay();break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),this.playing=!0)},play:function(){this.playing&&this.stop();this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._element.pause(),this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1);return this},setVolume:function(c){this.volume!=c&&(this.volume=c,this._element.volume=c);return this},setMute:function(c){this.muted!=c&&(this.muted=c,this._element.volume=c?0:this.volume);return this},Statics:{isSupported:null!==a.Audio}});b.HTMLAudio=a})(window);(function(e){var i=e.Hilo,d=i.Class,j=i.Event,b=function(){var c=e.AudioContext||e.webkitAudioContext,f=c?new c:null;return d.create({Mixes:j,constructor:function(a){i.copy(this,a,!0);this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=f;this._gainNode=f.createGain?f.createGain():f.createGainNode();this._gainNode.connect(f.destination);this._onAudioEvent=this._onAudioEvent.bind(this);this._onDecodeComplete=this._onDecodeComplete.bind(this);this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var a=new XMLHttpRequest;a.src=this.src;a.open("GET",this.src,!0);a.responseType="arraybuffer";a.onload=this._onAudioEvent;a.onprogress=this._onAudioEvent;a.onerror=this._onAudioEvent;a.send();this._buffer=!0}return this},_onAudioEvent:function(a){switch(a.type){case"load":a=a.target;a.onload=a.onprogress=a.onerror=null;this._context.decodeAudioData(a.response,this._onDecodeComplete,this._onDecodeError);break;case"ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case"progress":this.fire(a);break;case"error":this.fire(a)}},_onDecodeComplete:function(a){this._buffer=a;this.loaded=!0;this.duration=a.duration;this.fire("load");this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var a=this._context.createBufferSource();a.start||(a.start=a.noteOn,a.stop=a.noteOff);a.buffer=this._buffer;a.onended=this._onAudioEvent;this._gainNode.gain.value=this.muted?0:this.volume;a.connect(this._gainNode);a.start(0,this._offset);this._audioNode=a;this._startTime=this._context.currentTime;this.playing=!0},_clearAudioNode:function(){var a=this._audioNode;a&&(a.onended=null,a.disconnect(0),this._audioNode=null)},play:function(){this.playing&&this.stop();this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._audioNode.stop(0),this._offset+=this._context.currentTime-this._startTime,this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1);return this},setVolume:function(a){this.volume!=a&&(this.volume=a,this._gainNode.gain.value=a);return this},setMute:function(a){this.muted!=a&&(this.muted=a,this._gainNode.gain.value=a?0:this.volume);return this},Statics:{isSupported:null!=c,enabled:!1,enable:function(){if(!this.enabled&&f){var a=f.createBufferSource();a.buffer=f.createBuffer(1,1,22050);a.connect(f.destination);a.start?a.start(0,0,0):a.noteOn(0,0,0);return this.enabled=!0}return this.enabled}}})}();i.WebAudio=b})(window);(function(b){var d=b.Hilo,a=d.HTMLAudio,e=d.WebAudio;d.WebSound={_audios:{},enableAudio:function(){e.isSupported&&e.enable()},getAudio:function(c){c=this._normalizeSource(c);var f=this._audios[c.src];f||(e.isSupported?f=new e(c):a.isSupported&&(f=new a(c)),this._audios[c.src]=f);return f},removeAudio:function(c){c="string"===typeof c?c:c.src;var f=this._audios[c];f&&(f.stop(),f.off(),this._audios[c]=null,delete this._audios[c])},_normalizeSource:function(c){var f={};"string"===typeof c?f={src:c}:d.copy(f,c);return f}}})(window);(function(a){var b=a.Hilo;a=b.Class.create({constructor:function(c){c=c||{};b.copy(this,c,!0)},renderType:null,canvas:null,stage:null,startDraw:function(c){},draw:function(c){},endDraw:function(c){},transform:function(){},clear:function(g,i,d,h){},resize:function(d,e){}});b.Renderer=a})(window);(function(i){var j=i.Hilo,d=j.Class,l=j.Renderer,b=j.Drawable,k=function(){function a(f,m){var s=f.tagName||"div",r=m.image,t=f.width||r&&r.width,o=f.height||r&&r.height,p=j.createElement(s),n=p.style;f.id&&(p.id=f.id);n.position="absolute";n.left=(f.left||0)+"px";n.top=(f.top||0)+"px";n.width=t+"px";n.height=o+"px";if("canvas"==s){p.width=t,p.height=o,r&&(s=p.getContext("2d"),t=m.rect||[0,0,t,o],s.drawImage(r,t[0],t[1],t[2],t[3],f.x||0,f.y||0,f.width||t[2],f.height||t[3]))}else{n.opacity=void 0!=f.alpha?f.alpha:1;if(f===this.stage||f.clipChildren){n.overflow="hidden"}r&&r.src&&(n.backgroundImage="url("+r.src+")",n.backgroundPosition=-(f.rectX||0)+"px "+-(f.rectY||0)+"px")}return p}return d.create({Extends:l,constructor:function(c){k.superclass.constructor.call(this,c)},renderType:"dom",startDraw:function(c){var e=c.drawable=c.drawable||new b,e=e.domElement=e.domElement||a(c,e);c.visible!=c._visible&&(e.style.display=c.visible?null:"none",c._visible=c.visible);return !0},draw:function(c){var h=c.parent,f=c.drawable.domElement,g=f.parentNode;h?(h=h.drawable.domElement,h!=g&&h.appendChild(f),c.width||c.height||(f=c.drawable.rect)&&(f[2]||f[3])&&(c.width=f[2],c.height=f[3])):c!==this.stage||g||(f.style.overflow="hidden",this.canvas.appendChild(f))},transform:function(f){j.setElementStyleByView(f);if(f===this.stage){var h=this.canvas.style,o=f._scaleX,n=f._scaleY,p=f.scaleX,m=f.scaleY;if(!o&&1!=p||o&&o!=p){f._scaleX=p,h.width=p*f.width+"px"}if(!n&&1!=m||n&&n!=m){f._scaleY=m,h.height=m*f.height+"px"}}},resize:function(c,e){var f=this.canvas.style;f.width=c+"px";f.height=e+"px";"absolute"!=f.position&&(f.position="relative")}})}();j.DOMRenderer=k})(window);(function(j){var k=j.Hilo,i=k.Matrix,n=Math.PI/180,b=k.Class.create({Extends:k.Renderer,Statics:{MAX_BATCH_NUM:2000,ATTRIBUTE_NUM:5,isSupport:null},renderType:"webgl",gl:null,constructor:function(a){b.superclass.constructor.call(this,a);a=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl");this.maxBatchNum=b.MAX_BATCH_NUM;this.positionStride=4*b.ATTRIBUTE_NUM;var g=6*this.maxBatchNum;this.positions=new Float32Array(this.maxBatchNum*b.ATTRIBUTE_NUM*4);this.indexs=new Uint16Array(g);for(var f=0,h=0;f<g;f+=6,h+=4){this.indexs[f+0]=h+0,this.indexs[f+1]=h+1,this.indexs[f+2]=h+2,this.indexs[f+3]=h+1,this.indexs[f+4]=h+2,this.indexs[f+5]=h+3}this.batchIndex=0;this.sprites=[];a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.clearColor(0,0,0,0);a.disable(a.DEPTH_TEST);a.disable(a.CULL_FACE);a.enable(a.BLEND);this._initShaders();this.defaultShader.active();this.positionBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indexs,a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.positionBuffer);a.bufferData(a.ARRAY_BUFFER,this.positions,a.DYNAMIC_DRAW);a.vertexAttribPointer(this.a_position,2,a.FLOAT,!1,this.positionStride,0);a.vertexAttribPointer(this.a_TexCoord,2,a.FLOAT,!1,this.positionStride,8);a.vertexAttribPointer(this.a_alpha,1,a.FLOAT,!1,this.positionStride,16)},context:null,startDraw:function(a){return a.visible&&0<a.alpha?(a===this.stage&&this.clear(),!0):!1},draw:function(o){var u=o.width,p=o.height,t=o.background;(this.batchIndex>=this.maxBatchNum||t)&&this._renderBatches();var v=o.drawable;if(t=v&&v.image){t.texture||this.activeShader.uploadTexture(t);var v=v.rect,s=v[2],r=v[3];u||p||(u=o.width=s,p=o.height=r);v=this._createVertexs(t,v[0],v[1],s,r,-o.pivotX,-o.pivotY,u,p);u=this.batchIndex*this.positionStride;p=this.positions;s=o.__webglRenderAlpha;p[u+0]=v[0];p[u+1]=v[1];p[u+2]=v[2];p[u+3]=v[3];p[u+4]=s;p[u+5]=v[4];p[u+6]=v[5];p[u+7]=v[6];p[u+8]=v[7];p[u+9]=s;p[u+10]=v[8];p[u+11]=v[9];p[u+12]=v[10];p[u+13]=v[11];p[u+14]=s;p[u+15]=v[12];p[u+16]=v[13];p[u+17]=v[14];p[u+18]=v[15];p[u+19]=s;v=o.__webglWorldMatrix;for(s=0;4>s;s++){var r=p[u+5*s],q=p[u+5*s+1];p[u+5*s]=v.a*r+v.c*q+v.tx;p[u+5*s+1]=v.b*r+v.d*q+v.ty}o.texture=t.texture;this.sprites[this.batchIndex++]=o}},endDraw:function(a){a===this.stage&&this._renderBatches()},transform:function(f){var q=f.drawable;if(q&&q.domElement){k.setElementStyleByView(f)}else{var q=f.scaleX,h=f.scaleY;if(f===this.stage){var p=this.canvas.style,r=f._scaleX,o=f._scaleY;if(!r&&1!=q||r&&r!=q){f._scaleX=q,p.width=q*f.width+"px"}if(!o&&1!=h||o&&o!=h){f._scaleY=h,p.height=h*f.height+"px"}f.__webglWorldMatrix=f.__webglWorldMatrix||new i(1,0,0,1,0,0)}else{f.__webglWorldMatrix=f.__webglWorldMatrix||new i(1,0,0,1,0,0),this._setConcatenatedMatrix(f,f.parent)}0<f.alpha&&(f.__webglRenderAlpha=f.parent&&f.parent.__webglRenderAlpha?f.alpha*f.parent.__webglRenderAlpha:f.alpha)}},clear:function(c,h,f,g){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},resize:function(a,c){if(this.width!==a||this.height!==c){this.width=this.canvas.width=a,this.height=this.canvas.height=c,this.gl.viewport(0,0,a,c),this.canvasHalfWidth=0.5*a,this.canvasHalfHeight=0.5*c,this._uploadProjectionTransform(!0)}},_renderBatches:function(){var c=this.gl;c.bufferSubData(c.ARRAY_BUFFER,0,this.positions.subarray(0,this.batchIndex*this.positionStride));for(var c=0,h=null,f=0;f<this.batchIndex;f++){var g=this.sprites[f];h&&h!==g.texture&&(this._renderBatch(c,f),c=f);h=g.texture}this._renderBatch(c,this.batchIndex);this.batchIndex=0},_renderBatch:function(c,h){var f=this.gl,g=h-c;0<g&&(f.bindTexture(f.TEXTURE_2D,this.sprites[c].texture),f.drawElements(f.TRIANGLES,6*g,f.UNSIGNED_SHORT,12*c))},_uploadProjectionTransform:function(a){if(!this._projectionTransformElements||a){this._projectionTransformElements=new Float32Array([1/this.canvasHalfWidth,0,0,0,1/this.canvasHalfHeight,0,-1,1,1])}this.gl.uniformMatrix3fv(this.u_projectionTransform,!1,this._projectionTransformElements)},_initShaders:function(){this.defaultShader=new m(this,{v:"attribute vec2 a_position;\nattribute vec2 a_TexCoord;\nattribute float a_alpha;\nuniform mat3 u_projectionTransform;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n    v_TexCoord = a_TexCoord;\n    v_alpha = a_alpha;\n}\n",f:"\nprecision mediump float;\nuniform sampler2D u_Sampler;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_alpha;\n}\n"},{attributes:["a_position","a_TexCoord","a_alpha"],uniforms:["u_projectionTransform","u_Alpha","u_Sampler"]})},_createVertexs:function(x,v,y,u,w,s,r,q,z){var o=this.__tempVertexs||[],p=x.width;x=x.height;u/=p;w/=x;v/=p;y/=x;1<u+v&&(u=1-v);1<w+y&&(w=1-y);y=1-y-w;r=-z-r;p=0;o[p++]=s;o[p++]=r;o[p++]=v;o[p++]=y;o[p++]=s+q;o[p++]=r;o[p++]=v+u;o[p++]=y;o[p++]=s;o[p++]=r+z;o[p++]=v;o[p++]=y+w;o[p++]=s+q;o[p++]=r+z;o[p++]=v+u;o[p++]=y+w;return o},_setConcatenatedMatrix:function(c,t){var o=c.__webglWorldMatrix,s=1,r=0,q=360-c.rotation%360,p=c.scaleX,u=c.scaleY;q&&(r=q*n,s=Math.cos(r),r=Math.sin(r));o.a=s*p;o.b=r*p;o.c=-r*u;o.d=s*u;o.tx=c.x;o.ty=-c.y;s=t.__webglWorldMatrix;o.concat(s.a,s.b,s.c,s.d,s.tx,s.ty)}}),l={},m=function(c,e,f){this.renderer=c;this.gl=c.gl;this.program=this._createProgram(this.gl,e.v,e.f);f=f||{};this.attributes=f.attributes||[];this.uniforms=f.uniforms||[]};m.prototype={active:function(){var c=this.renderer,f=this.gl,e=this.program;e&&f&&(c.activeShader=this,f.useProgram(e),this.attributes.forEach(function(a){c[a]=f.getAttribLocation(e,a);f.enableVertexAttribArray(c[a])}),this.uniforms.forEach(function(a){c[a]=f.getUniformLocation(e,a)}),this.width!==c.width||this.height!==c.height)&&(this.width=c.width,this.height=c.height,c._uploadProjectionTransform())},uploadTexture:function(e){var g=this.gl,f=this.renderer;if(l[e.src]){e.texture=l[e.src]}else{var h=g.createTexture(),f=f.u_Sampler;g.activeTexture(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,h);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,1);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,e);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE);g.uniform1i(f,0);g.bindTexture(g.TEXTURE_2D,null);e.texture=h;l[e.src]=h}},_createProgram:function(c,h,f){h=this._createShader(c,c.VERTEX_SHADER,h);var g=this._createShader(c,c.FRAGMENT_SHADER,f);if(!h||!g){return null}if(f=c.createProgram()){if(c.attachShader(f,h),c.attachShader(f,g),c.linkProgram(f),c.deleteShader(g),c.deleteShader(h),!c.getProgramParameter(f,c.LINK_STATUS)){return h=c.getProgramInfoLog(f),console.log("Failed to link program: "+h),c.deleteProgram(f),null}}return f},_createShader:function(c,f,e){if(f=c.createShader(f)){if(c.shaderSource(f,e),c.compileShader(f),!c.getShaderParameter(f,c.COMPILE_STATUS)){return e=c.getShaderInfoLog(f),console.log("Failed to compile shader: "+e),c.deleteShader(f),null}}return f}};b.isSupport=function(){if(void 0===this._isSupport){var a=document.createElement("canvas");a.getContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))?this._isSupport=!0:this._isSupport=!1}return this._isSupport};k.WebGLRenderer=b})(window);(function(b){var c=b.Hilo,a=c.Class.create({Extends:c.Renderer,constructor:function(d){a.superclass.constructor.call(this,d);this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(d){return d.visible&&0<d.alpha?(d===this.stage&&this.clear(0,0,d.width,d.height),this.context.save(),!0):!1},draw:function(r){var t=this.context,o=r.width,q=r.height,s=r.background;s&&(t.fillStyle=s,t.fillRect(0,0,o,q));var j=r.drawable;if(s=j&&j.image){var j=j.rect,n=j[2],m=j[3],i=j[4],l=j[5];n&&m&&(o||q||(o=r.width=n,q=r.height=m),(i||l)&&t.translate(i-0.5*n,l-0.5*m),t.drawImage(s,j[0],j[1],n,m,0,0,o,q))}},endDraw:function(d){this.context.restore()},transform:function(y){var A=y.drawable;if(A&&A.domElement){c.setElementStyleByView(y)}else{var A=this.context,w=y.scaleX,x=y.scaleY;if(y===this.stage){var z=this.canvas.style,s=y._scaleX,v=y._scaleY;if(!s&&1!=w||s&&s!=w){y._scaleX=w,z.width=w*y.width+"px"}if(!v&&1!=x||v&&v!=x){y._scaleY=x,z.height=x*y.height+"px"}}else{var z=y.x,s=y.y,v=y.pivotX,f=y.pivotY,j=y.rotation%360,u=y.mask;u&&(u._render(this),A.clip());if(u=y.align){if("function"===typeof u){y.align()}else{var i=y.parent;if(i){var l=y.width,B=y.height,o=i.width,i=i.height;switch(u){case"TL":s=z=0;break;case"T":z=o-l>>1;s=0;break;case"TR":z=o-l;s=0;break;case"L":z=0;s=i-B>>1;break;case"C":z=o-l>>1;s=i-B>>1;break;case"R":z=o-l;s=i-B>>1;break;case"BL":z=0;s=i-B;break;case"B":z=o-l>>1;s=i-B;break;case"BR":z=o-l,s=i-B}}}}0==z&&0==s||A.translate(z,s);0!=j&&A.rotate(j*Math.PI/180);1==w&&1==x||A.scale(w,x);0==v&&0==f||A.translate(-v,-f)}0<y.alpha&&(A.globalAlpha*=y.alpha)}},clear:function(i,f,g,h){this.context.clearRect(i,f,g,h)},resize:function(e,d){this.canvas.width=e;this.canvas.height=d}});c.CanvasRenderer=a})(window);(function(e){var i=e.Hilo,d=i.Class,j=i.Event,b=i.Matrix;e=function(){function a(w,z,B){for(var u=w.length,y=z.length,s,r,q,k,D,o,p=0,C=s=0;C<u;C++){s=w[C];r=w[C<u-1?C+1:0];p=s.y-r.y;s=r.x-s.x;r=Math.sqrt(p*p+s*s);p/=r;s/=r;r=q=w[0].x*p+w[0].y*s;for(var A=1;A<u;A++){o=w[A].x*p+w[A].y*s,o>q?q=o:o<r&&(r=o)}k=D=z[0].x*p+z[0].y*s;for(A=1;A<y;A++){o=z[A].x*p+z[A].y*s,o>D?D=o:o<k&&(k=o)}r<k?(r=k-q,p=-p,s=-s):r-=D;if(0<=r){return !1}r>B.overlap&&(B.overlap=r,B.normal.x=p,B.normal.y=s)}return B}return d.create({Mixes:j,constructor:function(c){c=c||{};this.id=this.id||c.id||i.getUid("View");i.copy(this,c,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,mask:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var f=this,c;c=f.parent;){f=c}return f.canvas?f:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(f,c){"number"===typeof c?f.addChildAt(this,c):f.addChild(this);return this},removeFromParent:function(){var c=this.parent;c&&c.removeChild(this);return this},getBounds:function(){for(var v=this.width,x=this.height,y=this.getConcatenatedMatrix(),v=this.boundsArea||[{x:0,y:0},{x:v,y:0},{x:v,y:x},{x:0,y:x}],x=[],u,w,s,r,q,k,z,o=0,p=v.length;o<p;o++){u=y.transformPoint(v[o],!0,!0),w=u.x,s=u.y,0==o?(r=q=w,k=z=s):(r>w?r=w:q<w&&(q=w),k>s?k=s:z<s&&(z=s)),x[o]=u}x.x=r;x.y=k;x.width=q-r;x.height=z-k;return x},getConcatenatedMatrix:function(s){for(var v=new b(1,0,0,1,0,0),r=this;r!=s&&r.parent;r=r.parent){var u=1,p=0,o=r.rotation%360,m=r.pivotX,k=r.pivotY,l=r.scaleX,w=r.scaleY;o&&(p=o*Math.PI/180,u=Math.cos(p),p=Math.sin(p));0!=m&&(v.tx-=m);0!=k&&(v.ty-=k);v.concat(u*l,p*l,-p*w,u*w,r.x,r.y)}return v},hitTestPoint:function(w,z,B){var u=this.getBounds(),y=w>=u.x&&w<=u.x+u.width&&z>=u.y&&z<=u.y+u.height;if(y&&B){B=0;for(var y=!1,s,r,q,k,D=0,o=u.length;D<o;D++){var p=u[D],C=u[(D+1)%o];if(p.y==C.y&&z==p.y&&(p.x>C.x?(s=C.x,r=p.x):(s=p.x,r=C.x),w>=s&&w<=r)){y=!0;continue}p.y>C.y?(q=C.y,k=p.y):(q=p.y,k=C.y);if(!(z<q||z>k)){var A=(z-p.y)*(C.x-p.x)/(C.y-p.y)+p.x;A>w?B++:A==w&&(y=!0);p.x>w&&p.y==z&&(p=u[(o+D-1)%o],(p.y<z&&C.y>z||p.y>z&&C.y<z)&&B++)}}y=y||1==B%2}return y},hitTestObject:function(l,g){var h=this.getBounds(),m=l.getBounds(),k=h.x<=m.x+m.width&&m.x<=h.x+h.width&&h.y<=m.y+m.height&&m.y<=h.y+h.height;k&&g&&(k=(k=a(h,m,{overlap:-Infinity,normal:{x:0,y:0}}))?a(m,h,k):!1);return !!k},_render:function(f,c){this.onUpdate&&!1===this.onUpdate(c)||!f.startDraw(this)||(f.transform(this),this.render(f,c),f.endDraw(this))},_fireMouseEvent:function(f){f.eventCurrentTarget=this;this.fire(f);if("mousemove"==f.type){if(!this.__mouseOver){this.__mouseOver=!0;var c=i.copy({},f);c.type="mouseover";this.fire(c)}}else{"mouseout"==f.type&&(this.__mouseOver=!1)}c=this.parent;f._stopped||f._stopPropagationed||!c||("mouseout"==f.type||"touchout"==f.type?c.hitTestPoint(f.stageX,f.stageY,!0)||c._fireMouseEvent(f):c._fireMouseEvent(f))},onUpdate:null,render:function(f,c){f.draw(this)},toString:function(){return i.viewToString(this)}})}();i.View=e})(window);(function(b){var c=b.Hilo,a=c.Class.create({Extends:c.View,constructor:function(d){d=d||{};this.id=this.id||d.id||c.getUid("Container");a.superclass.constructor.call(this,d);this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(l,h){var j=this.children,k=j.length,g=l.parent;h=0>h?0:h>k?k:h;var i=this.getChildIndex(l);if(i==h){return this}0<=i?(j.splice(i,1),h=h==k?k-1:h):g&&g.removeChild(l);j.splice(h,0,l);0>i?this._updateChildren(h):this._updateChildren(i<h?i:h,(i<h?h:i)+1);return this},addChild:function(j){for(var g=this.children.length,h=arguments,i=0,f=h.length;i<f;i++){this.addChildAt(h[i],g+i)}return this},removeChildAt:function(l){var h=this.children;if(0>l||l>=h.length){return null}var j=h[l];if(j){var k=j.drawable,g=k&&k.domElement;if(g){var i=g.parentNode;i&&i.removeChild(g);k.domElement=null}j.parent=null;j.depth=-1}h.splice(l,1);this._updateChildren(l);return j},removeChild:function(d){return this.removeChildAt(this.getChildIndex(d))},removeChildById:function(j){for(var g=this.children,h,i=0,f=g.length;i<f;i++){if(h=g[i],h.id===j){return this.removeChildAt(i),h}}return null},removeAllChildren:function(){for(;this.children.length;){this.removeChildAt(0)}return this},getChildAt:function(e){var d=this.children;return 0>e||e>=d.length?null:d[e]},getChildById:function(j){for(var g=this.children,h,i=0,f=g.length;i<f;i++){if(h=g[i],h.id===j){return h}}return null},getChildIndex:function(d){return this.children.indexOf(d)},setChildIndex:function(j,g){var h=this.children,i=h.indexOf(j);if(0<=i&&i!=g){var f=h.length;g=0>g?0:g>=f?f-1:g;h.splice(i,1);h.splice(g,0,j);this._updateChildren()}return this},swapChildren:function(j,g){var h=this.children,i=this.getChildIndex(j),f=this.getChildIndex(g);j.depth=f;h[f]=j;g.depth=i;h[i]=g},swapChildrenAt:function(j,g){var h=this.children,i=this.getChildAt(j),f=this.getChildAt(g);i.depth=g;h[g]=i;f.depth=j;h[j]=f},sortChildren:function(g){var d=this.children;if("string"==typeof g){var f=g;g=function(h,e){return e[f]-h[f]}}d.sort(g);this._updateChildren()},_updateChildren:function(j,g){var h=this.children,i;g=g||h.length;for(var f=j||0;f<g;f++){i=h[f],i.depth=f+1,i.parent=this}},contains:function(d){for(;d=d.parent;){if(d===this){return !0}}return !1},getViewAtPoint:function(o,r,m,n,q){for(var l=n?[]:null,k=this.children,j,i,s=k.length-1;0<=s;s--){if(j=k[s],!(!j||!j.visible||0>=j.alpha||q&&!j.pointerEnabled)){if(j.children&&j.children.length&&(!q||j.pointerChildren)&&(i=j.getViewAtPoint(o,r,m,n,q)),i){if(n){i.length&&(l=l.concat(i))}else{return i}}else{if(j.hitTestPoint(o,r,m)){if(n){l.push(j)}else{return j}}}}}return n&&l.length?l:null},render:function(l,h){a.superclass.render.call(this,l,h);var j=this.children.slice(0),k,g,i;k=0;for(g=j.length;k<g;k++){i=j[k],i.parent===this&&i._render(l,h)}}});c.Container=a})(window);(function(i){var j=i.Hilo,d=j.CanvasRenderer,l=j.DOMRenderer,b=j.WebGLRenderer,k=j.Class.create({Extends:j.Container,constructor:function(g){g=g||{};this.id=this.id||g.id||j.getUid("Stage");k.superclass.constructor.call(this,g);this._initRenderer(g);var e=this.width,f=this.height,h=this.updateViewport();g.width||(e=h&&h.width||320);g.height||(f=h&&h.height||480);this.resize(e,f,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(f){var a=f.canvas,c=f.container;f=f.renderType||"canvas";"string"===typeof a&&(a=j.getElement(a));"string"===typeof c&&(c=j.getElement(c));a?a.getContext||(f="dom"):a=j.createElement("dom"===f?"div":"canvas",{style:{position:"absolute"}});this.canvas=a;c&&c.appendChild(a);a={canvas:a,stage:this};switch(f){case"dom":this.renderer=new l(a);break;case"webgl":b.isSupport()?this.renderer=new b(a):this.renderer=new d(a);break;default:this.renderer=new d(a)}},addTo:function(c){var a=this.canvas;a.parentNode!==c&&c.appendChild(a);return this},tick:function(a){this.paused||this._render(this.renderer,a)},enableDOMEvent:function(q,h){var m=this,p=m.canvas,r="string"===typeof q?[q]:q;h=!1!==h;for(var o=m._domListener||(m._domListener=function(a){m._onDOMEvent(a)}),n=0;n<r.length;n++){q=r[n],h?p.addEventListener(q,o,!1):p.removeEventListener(q,o)}return m},_onDOMEvent:function(s){var f=s.type,m=0==f.indexOf("touch"),r=s;if(m){var t=s.touches,r=s.changedTouches,r=t&&t.length?t[0]:r&&r.length?r[0]:null}var t=r.pageX||r.clientX,r=r.pageY||r.clientY,o=this.viewport||this.updateViewport();s.stageX=t=(t-o.left)/this.scaleX;s.stageY=r=(r-o.top)/this.scaleY;s.stopPropagation=function(){this._stopPropagationed=!0};var t=this.getViewAtPoint(t,r,!0,!1,!0)||this,r=this.canvas,o=this._eventTarget,n="mouseout"===f;if(o&&(!(o==t||o.contains&&o.contains(t))||n)){if(n="touchmove"===f?"touchout":"mousemove"===f||n||!t?"mouseout":null){var p=j.copy({},s);p.type=n;p.eventTarget=o;o._fireMouseEvent(p)}s.lastEventTarget=o;this._eventTarget=null}t&&t.pointerEnabled&&"mouseout"!==f&&(s.eventTarget=this._eventTarget=t,t._fireMouseEvent(s));m||(r.style.cursor=t&&t.pointerEnabled&&t.useHandCursor?"pointer":"");j.browser.android&&"touchmove"===f&&s.preventDefault()},updateViewport:function(){var e=this.canvas,c=null;e.parentNode&&(c=this.viewport=j.getElementRect(e));return c},resize:function(f,c,g){if(g||this.width!==f||this.height!==c){this.width=f,this.height=c,this.renderer.resize(f,c),this.updateViewport()}}});j.Stage=k})(window);(function(b){var d=b.Hilo,a=d.Drawable,e=d.Class.create({Extends:d.View,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("Bitmap");e.superclass.constructor.call(this,c);this.drawable=new a(c);if(!this.width||!this.height){if(c=this.drawable.rect){this.width=c[2],this.height=c[3]}}},setImage:function(c,f){this.drawable.init({image:c,rect:f});f&&(this.width=f[2],this.height=f[3]);return this}});d.Bitmap=e})(window);(function(b){var d=b.Hilo,a=d.Drawable,e=d.Class.create({Extends:d.View,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("Sprite");e.superclass.constructor.call(this,c);this._frames=[];this._frameNames={};this.drawable=new a;c.frames&&this.addFrame(c.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(g,h){var i=null!=h?h:this._frames.length;if(g instanceof Array){for(var f=0,j=g.length;f<j;f++){this.setFrame(g[f],i+f)}}else{this.setFrame(g,i)}return this},setFrame:function(f,g){var h=this._frames,c=h.length;g=0>g?0:g>c?c:g;h[g]=f;f.name&&(this._frameNames[f.name]=f);if(0==g&&!this.width||!this.height){this.width=f.rect[2],this.height=f.rect[3]}return this},getFrame:function(c){if("number"===typeof c){var f=this._frames;return 0>c||c>=f.length?null:f[c]}return this._frameNames[c]},getFrameIndex:function(g){var h=this._frames,i=h.length,f=-1;if("number"===typeof g){f=g}else{if(g="string"===typeof g?this._frameNames[g]:g){for(var j=0;j<i;j++){if(g===h[j]){f=j;break}}}}return f},play:function(){this.paused=!1;return this},stop:function(){this.paused=!0;return this},"goto":function(f,g){var h=this._frames.length,c=this.getFrameIndex(f);this.currentFrame=0>c?0:c>=h?h-1:c;this.paused=g;this._firstRender=!0;return this},_render:function(f,g){var h=this.currentFrame,c;this._firstRender?(c=h,this._firstRender=!1):c=this._nextFrame(g);c!=h&&(this.currentFrame=c,(h=this._frames[c].callback)&&h.call(this));if(this.onEnterFrame){this.onEnterFrame(c)}this.drawable.init(this._frames[c]);e.superclass._render.call(this,f,g)},_nextFrame:function(g){var h=this._frames,i=h.length,f=this.currentFrame,h=h[f],j=this._frameElapsed;g=0!=f||this.drawable?j+(this.timeBased?g:1):0;j=this._frameElapsed=g<(h.duration||this.interval)?g:0;(h.stop||!this.loop&&f>=i-1)&&this.stop();this.paused||0!=j||(null!=h.next?f=this.getFrameIndex(h.next):f>=i-1?f=0:this.drawable&&f++);return f},setFrameCallback:function(c,f){if(c=this.getFrame(c)){c.callback=f}return this},onEnterFrame:null});d.Sprite=e})(window);(function(b){var d=b.Hilo,a=d.Drawable,e=d.Class.create({Extends:d.View,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("Button");e.superclass.constructor.call(this,c);this.drawable=new a(c);this.setState(e.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(c){this.enabled!=c&&(c?this.setState(e.UP):this.setState(e.DISABLED));return this},setState:function(c){if(this.state!==c){this.state=c;this.pointerEnabled=this.enabled=c!==e.DISABLED;var f;switch(c){case e.UP:f=this.upState;break;case e.OVER:f=this.overState;break;case e.DOWN:f=this.downState;break;case e.DISABLED:f=this.disabledState}f&&(this.drawable.init(f),d.copy(this,f,!0))}return this},fire:function(c,f){if(this.enabled){switch("string"===typeof c?c:c.type){case"mousedown":case"touchstart":case"touchmove":this.setState(e.DOWN);break;case"mouseover":this.setState(e.OVER);break;case"mouseup":this.overState?this.setState(e.OVER):this.upState&&this.setState(e.UP);break;case"touchend":case"touchout":case"mouseout":this.setState(e.UP)}return e.superclass.fire.call(this,c,f)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});d.Button=e})(window);(function(i){var j=i.Hilo;i=j.Class;var d=j.View,l=j.createElement("canvas"),b=l&&l.getContext("2d"),k=i.create({Extends:d,constructor:function(c){c=c||{};this.id=this.id||c.id||j.getUid("Text");k.superclass.constructor.call(this,c);c.font||(this.font="12px arial");this._fontHeight=k.measureFontHeight(this.font)},text:null,color:"#000",textAlign:null,textVAlign:null,outline:!1,lineSpacing:0,maxWidth:200,font:null,textWidth:0,textHeight:0,cacheDirty:!0,cache:function(c){(c||this._cacheDirty||!this._cacheImage)&&this.updateCache()},updateCache:function(){l.width=this.width;l.height=this.height;this._draw(b);this._cacheImage=new Image;this._cacheImage.src=l.toDataURL();this.drawable=this.drawable||new Drawable;this.drawable.init(this._cacheImage);this.cacheDirty=!1},setCacheDirty:function(c){this._cacheDirty=c},setFont:function(c){this.font!==c&&(this.font=c,this._fontHeight=k.measureFontHeight(c),this.setCacheDirty(!0));return this},render:function(g,f){if("canvas"===g.renderType){this._draw(g.context)}else{if("dom"===g.renderType){var h=this.drawable.domElement,m=h.style;m.font=this.font;m.textAlign=this.textAlign;m.color=this.color;m.width=this.width+"px";m.height=this.height+"px";m.lineHeight=this._fontHeight+this.lineSpacing+"px";h.innerHTML=this.text}else{this.cache()}g.draw(this)}},_draw:function(B){var A=this.text.toString();if(A){B.font=this.font;B.textAlign=this.textAlign;B.textBaseline="top";var y=A.split(/\r\n|\r|\n|<br(?:[ \/])*>/),z=0,x=0,w=this._fontHeight+this.lineSpacing,u,o,p,A=[];u=0;for(len=y.length;u<len;u++){if(o=y[u],p=B.measureText(o).width,p<=this.maxWidth){A.push({text:o,y:x}),z<p&&(z=p),x+=w}else{p="";var D=0,r,s,C;s=0;for(wlen=o.length;s<wlen;s++){C=o[s],r=B.measureText(p+C).width,r>this.maxWidth?(A.push({text:p,y:x}),z<D&&(z=D),x+=w,p=C):(D=r,p+=C),s==wlen-1&&(A.push({text:p,y:x}),p!==C&&z<r&&(z=r),x+=w)}}}this.textWidth=z;this.textHeight=x;this.width||(this.width=z);this.height||(this.height=x);y=0;switch(this.textVAlign){case"middle":y=this.height-this.textHeight>>1;break;case"bottom":y=this.height-this.textHeight}if(u=this.background){B.fillStyle=u,B.fillRect(0,0,this.width,this.height)}this.outline?B.strokeStyle=this.color:B.fillStyle=this.color;for(u=0;u<A.length;u++){o=A[u],this._drawTextLine(B,o.text,y+o.y)}}},_drawTextLine:function(h,g,n){var o=0,m=this.width;switch(this.textAlign){case"center":o=m>>1;break;case"right":case"end":o=m}this.outline?h.strokeText(g,o,n):h.fillText(g,o,n)},Statics:{measureFontHeight:function(f){var c=document.documentElement,g=j.createElement("div",{style:{font:f,position:"absolute"},innerHTML:"M"});c.appendChild(g);f=g.offsetHeight;c.removeChild(g);return f}}});j.Text=k})(window);(function(b){var d=b.Hilo,a=d.Bitmap,e=d.Class.create({Extends:d.Container,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("BitmapText");e.superclass.constructor.call(this,c);if(c=c.text+""){this.text="",this.setText(c)}this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(i){i=i.toString();var l=i.length;if(this.text!=i){this.text=i;var m,h,n,k=n=0,j=0;for(m=0;m<l;m++){if(h=i.charAt(m),h=this.glyphs[h]){j=n+(0<n?this.letterSpacing:0),this.children[m]?(n=this.children[m],n.setImage(h.image,h.rect)):(n=this._createBitmap(h),this.addChild(n)),n.x=j,n=j+h.rect[2],k=Math.max(k,h.rect[3])}}for(m=this.children.length-1;m>=l;m--){this._releaseBitmap(this.children[m]),this.children[m].removeFromParent()}this.width=n;this.height=k;this.setTextAlign();return this}},_createBitmap:function(c){var f;e._pool.length?(f=e._pool.pop(),f.setImage(c.image,c.rect)):f=new a({image:c.image,rect:c.rect});return f},_releaseBitmap:function(c){e._pool.push(c)},setTextAlign:function(c){this.textAlign=c||this.textAlign;switch(this.textAlign){case"center":this.pivotX=0.5*this.width;break;case"right":this.pivotX=this.width;break;default:this.pivotX=0}return this},hasGlyphs:function(f){var g=this.glyphs;if(!g){return !1}f=f.toString();var h=f.length,c;for(c=0;c<h;c++){if(!g[f.charAt(c)]){return !1}}return !0},Statics:{_pool:[],createGlyphs:function(j,n,o,i){var p=j.toString();o=o||p.length;var m=n.width/o;i=n.height/(i||1);var l={},k=0;for(j=j.length;k<j;k++){charStr=p.charAt(k),l[charStr]={image:n,rect:[k%o*m,i*Math.floor(k/o),m,i]}}return l}}});d.BitmapText=e})(window);(function(b){var d=b.Hilo,a=d.Drawable,e=d.Class.create({Extends:d.View,constructor:function(c){c=c||{};this.id=this.id||c.id||d.getUid("DOMElement");e.superclass.constructor.call(this,c);this.drawable=new a;(this.drawable.domElement=c.element||d.createElement("div")).id=this.id},_render:function(c,f){this.onUpdate&&!1===this.onUpdate(f)||(c.transform(this),this.visible&&0<this.alpha&&this.render(c,f))},render:function(h,j){var k=h.canvas;if(k.getContext){var g=this.depth,l=k.nextSibling,i;if(!this.drawable.domElement.parentNode){for(;l&&3!=l.nodeType;){i=parseInt(l.style.zIndex)||0;if(0>=i||i>g){break}l=l.nextSibling}k.parentNode.insertBefore(this.drawable.domElement,l)}}else{h.draw(this)}}});d.DOMElement=e})(window);(function(b){b=b.Hilo;var c=b.Class,a=function(){function d(e,g){var f={image:e.image,rect:e.rect};g&&(f.name=g.name||null,f.duration=g.duration||0,f.stop=!!g.stop,f.next=g.next||null);return f}return c.create({constructor:function(s){var n;var o=s.frames;if(o){n=[];var r;if(o instanceof Array){for(var m=0,l=o.length;m<l;m++){r=o[m],n[m]={image:s.image,rect:r}}}else{r=o.frameWidth;for(var l=o.frameHeight,k=s.width/r|0,m=s.height/l|0,o=o.numFrames||k*m,m=0;m<o;m++){n[m]={image:s.image,rect:[m%k*r,(m/k|0)*l,r,l]}}}}else{n=null}this._frames=n;var j;n=this._frames;if(s=s.sprites){var o={},t;for(j in s){m=s[j];if("number"===typeof m){r=d(n[m])}else{if(m instanceof Array){for(r=[],l=0,k=m.length;l<k;l++){t=m[l];var i;"number"===typeof t?t=d(n[t]):(i=t.rect,"number"===typeof i&&(i=n[t.rect]),t=d(i,t));r[l]=t}}else{for(r=[],l=m.from;l<=m.to;l++){r[l-m.from]=d(n[l],m[l])}}}o[j]=r}j=o}else{j=null}this._sprites=j},_frames:null,_sprites:null,getFrame:function(e){var f=this._frames;return f&&f[e]},getSprite:function(e){var f=this._sprites;return f&&f[e]},Statics:{createSpriteFrames:function(u,r,o,s,m,l,k){if("[object Array]"===Object.prototype.toString.call(u)){r=[];for(var i=0,v=u.length;i<v;i++){r=r.concat(this.createSpriteFrames.apply(this,u[i]))}}else{if("string"===typeof r){var e=r.split(",");r=[];for(var j=0,x=e.length;j<x;j++){if(v=e[j].split("-"),1==v.length){r.push(parseInt(v[0]))}else{for(i=parseInt(v[0]),v=parseInt(v[1]);i<=v;i++){r.push(i)}}}}e=Math.floor(o.width/s);for(i=0;i<r.length;i++){j=r[i],r[i]={rect:[j%e*s,m*Math.floor(j/e),s,m],image:o,duration:k}}r[0].name=u;l?r[r.length-1].next=u:r[r.length-1].stop=!0}return r}}})}();b.TextureAtlas=a})(window);