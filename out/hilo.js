(function(g){g.console=g.console||{log:function(){}};g=Array.prototype;var h=g.slice;g.indexOf=g.indexOf||function(e,c){c=c||0;var a=this.length,d;if(0==a||c>=a)return-1;0>c&&(c=a+c);for(d=c;d<a;d++)if(this[d]===e)return d;return-1};g=Function.prototype;g.bind=g.bind||function(e){function c(){var b=d.concat(h.call(arguments));return a.apply(this instanceof c?this:e,b)}var a=this,d=h.call(arguments,1),f=function(){};f.prototype=a.prototype;c.prototype=new f;return c}})(window);
(function(g){for(var h=0,e=["ms","moz","webkit","o"],c=0;c<e.length&&!g.requestAnimationFrame;++c)g.requestAnimationFrame=g[e[c]+"RequestAnimationFrame"],g.cancelAnimationFrame=g[e[c]+"CancelAnimationFrame"]||g[e[c]+"CancelRequestAnimationFrame"];g.requestAnimationFrame||(g.requestAnimationFrame=function(a,d){var f=(new Date).getTime(),b=Math.max(0,16-(f-h)),k=g.setTimeout(function(){a(f+b)},b);h=f+b;return k});g.cancelAnimationFrame||(g.cancelAnimationFrame=function(a){clearTimeout(a)})})(window);
(function(g){var h=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.toColorRgb=function(){var e=this.toLowerCase();return e&&h.test(e)?4===e.length?{r:parseInt("0x"+e.charAt(1)+e.charAt(1)),g:parseInt("0x"+e.charAt(2)+e.charAt(2)),b:parseInt("0x"+e.charAt(3)+e.charAt(3))}:{r:parseInt("0x"+e.slice(1,3)),g:parseInt("0x"+e.slice(3,5)),b:parseInt("0x"+e.slice(5,7))}:{r:0,g:0,b:0}}})(window);(function(g){var h=function(){var e=document,c=e.documentElement,a=0;return{getUid:function(d){var f=++a;return d?d+"_"+f:f},copy:function(a,f,b){for(var k in f)if(!b||a.hasOwnProperty(k)||void 0!==a[k])a[k]=f[k];return a},browser:function(){var a=navigator.userAgent,a={iphone:/iphone/i.test(a),ipad:/ipad/i.test(a),ipod:/ipod/i.test(a),ios:/iphone|ipad|ipod/i.test(a),android:/android/i.test(a),webkit:/webkit/i.test(a),chrome:/chrome/i.test(a),safari:/safari/i.test(a),firefox:/firefox/i.test(a),ie:/msie/i.test(a),
opera:/opera/i.test(a),supportTouch:"ontouchstart"in g,supportCanvas:null!=e.createElement("canvas").getContext,supportStorage:!1,supportOrientation:"orientation"in g,supportDeviceMotion:"ondevicemotion"in g};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),a.supportStorage=!0}catch(f){}a.jsVendor=a.webkit?"webkit":a.firefox?"Moz":a.opera?"O":a.ie?"ms":"";a.cssVendor="-"+a.jsVendor+"-";return a}(),event:function(){var a="ontouchstart"in g;return{POINTER_START:a?"touchstart":
"mousedown",POINTER_MOVE:a?"touchmove":"mousemove",POINTER_END:a?"touchend":"mouseup"}}(),align:{TOP_LEFT:"TL",TOP:"T",TOP_RIGHT:"TR",LEFT:"L",CENTER:"C",RIGHT:"R",BOTTOM_LEFT:"BL",BOTTOM:"B",BOTTOM_RIGHT:"BR"},getElement:function(a){return e.getElementById(a)},getElementRect:function(a){try{var f=a.getBoundingClientRect()}catch(e){f={top:a.offsetTop,left:a.offsetLeft,width:a.offsetWidth,height:a.offsetHeight}}var b=(g.pageXOffset||c.scrollLeft)-(c.clientLeft||0)||0,k=(g.pageYOffset||c.scrollTop)-
(c.clientTop||0)||0,q=g.getComputedStyle?g.getComputedStyle(a):a.currentStyle,r=parseInt;a=r(q.paddingLeft)+r(q.borderLeftWidth)||0;var v=r(q.paddingTop)+r(q.borderTopWidth)||0,u=r(q.paddingRight)+r(q.borderRightWidth)||0,q=r(q.paddingBottom)+r(q.borderBottomWidth)||0,r=f.top||0,h=f.left||0;return{left:h+b+a,top:r+k+v,width:f.right-u-h-a,height:f.bottom-q-r-v}},createElement:function(a,f){var b=e.createElement(a),k,q,r;for(k in f)if(q=f[k],"style"===k)for(r in q)b.style[r]=q[r];else b[k]=q;return b},
setElementStyleByView:function(a,f){var b=h.browser.jsVendor,k=!1,q=a.parent,r=a.drawable,k=r.domElement,c=k.style,e=a._stateCache||(a._stateCache={});q&&(q=q.drawable&&q.drawable.domElement)&&q!=k.parentNode&&q.appendChild(k);this.cacheStateIfChanged(a,["visible"],e)&&(c.display=a.visible?"":"none");this.cacheStateIfChanged(a,["alpha"],e)&&(c.opacity=a.alpha);if(a.visible&&!(0>=a.alpha)){this.cacheStateIfChanged(a,["width"],e)&&(c.width=(a.width||0)+"px");this.cacheStateIfChanged(a,["height"],e)&&
(c.height=(a.height||0)+"px");this.cacheStateIfChanged(a,["depth"],e)&&(c.zIndex=a.depth+1);this.cacheStateIfChanged(a,["clipChildren"],e)&&(c.overflow=a.clipChildren?"hidden":null);if(k=this.cacheStateIfChanged(a,["pivotX","pivotY"],e)){var q=a.pivotX,g=a.pivotY,m=r.rect;if(m){var l=m[2],p=m[3],t=m[4],m=m[5];if(t||m)q-=t-.5*l,g-=m-.5*p}c[b+"TransformOrigin"]=q+"px "+g+"px"}if(this.cacheStateIfChanged(a,["x","y","rotation","scaleX","scaleY"],e)||k)c[b+"Transform"]="translate("+(a.x-a.pivotX)+"px, "+
(a.y-a.pivotY)+"px)rotate("+a.rotation+"deg)scale("+a.scaleX+", "+a.scaleY+")";if(f)c.pointerEvents="none";else if(c.pointerEvents||(c.pointerEvents="none"),this.cacheStateIfChanged(a,["background"],e)&&(c.backgroundColor=a.background),b=r.image)if(b=b.src,b!==e.image&&(e.image=b,c.backgroundImage="url("+b+")"),m=r.rect)r=m[0],b=m[1],r!==e.sx&&(e.sx=r,c.backgroundPositionX=-r+"px"),b!==e.sy&&(e.sy=b,c.backgroundPositionY=-b+"px")}},cacheStateIfChanged:function(a,f,b){var k,q,r,c,e=!1;k=0;for(q=f.length;k<
q;k++)r=f[k],c=a[r],c!=b[r]&&(b[r]=c,e=!0);return e}}}();h.undefined=void 0;g.Hilo=h})(window);(function(g){g=g.Hilo;var h=function(){var e=function(b){var f={},a,e;for(a in b)e=b[a],c.hasOwnProperty(a)?c[a].call(this,e):f[a]=e;d(this.prototype,f)},c={Extends:function(b){var f=this.prototype,c=a(b.prototype);d(this,b);d(c,f);c.constructor=this;this.prototype=c;this.superclass=b.prototype},Mixes:function(b){b instanceof Array||(b=[b]);for(var f=this.prototype,a;a=b.shift();)d(f,a.prototype||a)},Statics:function(b){d(this,b)}},a=function(){if(Object.__proto__)return function(b){return{__proto__:b}};
var b=function(){};return function(f){b.prototype=f;return new b}}(),d=function(f){for(var a=1,d=arguments.length;a<d;a++){var c=arguments[a],e,h;for(h in c){var g=c[h];!g||"object"!==typeof g||void 0===g.value&&"function"!==typeof g.get&&"function"!==typeof g.set?f[h]=g:(e=e||{},e[h]=g)}e&&b(f,e)}return f};try{var f=Object.defineProperty,b=Object.defineProperties;f({},"$",{value:0})}catch(k){"__defineGetter__"in Object&&(f=function(b,f,a){"value"in a&&(b[f]=a.value);"get"in a&&b.__defineGetter__(f,
a.get);"set"in a&&b.__defineSetter__(f,a.set);return b},b=function(b,a){for(var k in a)a.hasOwnProperty(k)&&f(b,k,a[k]);return b})}return{create:function(b){b=b||{};var f=b.hasOwnProperty("constructor")?b.constructor:function(){};e.call(f,b);return f},mix:d}}();g.Class=h})(window);(function(g){var h=g.Hilo,e=h.Class.create({constructor:function(a,d,f){this.type=a;this.target=d;this.detail=f;this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}});if(g=g.Event){g=g.prototype;var c=g.stopImmediatePropagation;g.stopImmediatePropagation=function(){c&&c.call(this);this._stopped=!0}}h.Event={_listeners:null,on:function(a,d,f){var b=this._listeners=this._listeners||{};a=b[a]=b[a]||[];for(var b=0,k=a.length;b<k;b++)if(a[b].listener===
d)return;a.push({listener:d,once:f});return this},off:function(a,d){if(0==arguments.length)return this._listeners=null,this;var f=this._listeners&&this._listeners[a];if(f){if(1==arguments.length)return delete this._listeners[a],this;for(var b=0,k=f.length;b<k;b++)if(f[b].listener===d){f.splice(b,1);0===f.length&&delete this._listeners[a];break}}return this},fire:function(a,d){var f,b;"string"===typeof a?b=a:(f=a,b=a.type);var k=this._listeners;if(!k)return!1;var q=k[b];if(q){q=q.slice(0);f=f||new e(b,
this,d);if(f._stopped)return!1;for(var c=0;c<q.length;c++){var v=q[c];v.listener.call(this,f);v.once&&q.splice(c--,1)}0==q.length&&delete k[b];return!0}return!1}}})(window);(function(g){g=g.Hilo;var h=g.Class.create({constructor:function(e,c,a,d,f,b){this.a=e;this.b=c;this.c=a;this.d=d;this.tx=f;this.ty=b},concat:function(e){var c=arguments,a=this.a,d=this.b,f=this.c,b=this.d,k=this.tx,q=this.ty;if(6<=c.length)var r=c[0],v=c[1],h=c[2],g=c[3],m=c[4],c=c[5];else r=e.a,v=e.b,h=e.c,g=e.d,m=e.tx,c=e.ty;this.a=a*r+d*h;this.b=a*v+d*g;this.c=f*r+b*h;this.d=f*v+b*g;this.tx=k*r+q*h+m;this.ty=k*v+q*g+c;return this},rotate:function(e){var c=Math.sin(e);e=Math.cos(e);var a=this.a,
d=this.b,f=this.c,b=this.d,k=this.tx,q=this.ty;this.a=a*e-d*c;this.b=a*c+d*e;this.c=f*e-b*c;this.d=f*c+b*e;this.tx=k*e-q*c;this.ty=k*c+q*e;return this},scale:function(e,c){this.a*=e;this.d*=c;this.c*=e;this.b*=c;this.tx*=e;this.ty*=c;return this},translate:function(e,c){this.tx+=e;this.ty+=c;return this},identity:function(){this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;return this},invert:function(){var e=this.a,c=this.b,a=this.c,d=this.d,f=this.tx,b=e*d-c*a;this.a=d/b;this.b=-c/b;this.c=-a/b;this.d=
e/b;this.tx=(a*this.ty-d*f)/b;this.ty=-(e*this.ty-c*f)/b;return this},transformPoint:function(e,c,a){var d=e.x*this.a+e.y*this.c+this.tx,f=e.x*this.b+e.y*this.d+this.ty;c&&(d=d+.5>>0,f=f+.5>>0);if(a)return{x:d,y:f};e.x=d;e.y=f;return e}});g.Matrix=h})(window);(function(g){var h=g.Hilo,e=h.Class.create({constructor:function(c){this._targetFPS=c||30;this._interval=1E3/this._targetFPS;this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(c){if(!this._intervalId){this._lastTime=+new Date;var a=this,d=this._interval,f=g.requestAnimationFrame||g[h.browser.jsVendor+"RequestAnimationFrame"];if(c&&f)var b=function(){a._tick()},k=function(){a._intervalId=setTimeout(k,
d);f(b)};else k=function(){a._intervalId=setTimeout(k,d);a._tick()};k()}},stop:function(){clearTimeout(this._intervalId);this._intervalId=null;this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var c=+new Date,a=c-this._lastTime,d=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1E3/(this._tickTime/this._tickCount)+.5>>0,this._tickTime=this._tickCount=0):this._tickTime+=c-this._lastTime;this._lastTime=c;for(var c=
0,f=d.length;c<f;c++)d[c].tick(a)}},getMeasuredFPS:function(){return this._measuredFPS},addTick:function(c){if(!c||"function"!=typeof c.tick)throw Error("Ticker: The tick object must implement the tick method.");this._tickers.push(c)},removeTick:function(c){var a=this._tickers;c=a.indexOf(c);0<=c&&a.splice(c,1)}});h.Ticker=e})(window);(function(g){var h=g.Hilo,e=h.Class.create({constructor:function(c){this.init(c)},image:null,rect:null,domElement:null,init:function(c){var a=this,d=a.image;e.isDrawable(c)?a.image=c:h.copy(a,c,!0);c=a.image;if("string"===typeof c)if(d&&c===d.getAttribute("src"))c=a.image=d;else{a.image=null;var f=new Image;f.onload=function(){f.onload=null;a.init(f)};f.src=c;return}c&&!a.rect&&(a.rect=[0,0,c.width,c.height])},Statics:{isDrawable:function(c){if(!c||!c.tagName)return!1;c=c.tagName.toLowerCase();return"img"===
c||"canvas"===c||"video"===c}}});h.Drawable=e})(window);(function(g){var h=g.Hilo,e=h.Class.create({load:function(c){var a=c.src,d="jsonp"==c.type;if(d){var f=c.callbackName||"callback",b=c.callback||"jsonp"+ ++e._count;g[b]||(g[b]=function(f){delete g[b]})}d&&(a+=(-1==a.indexOf("?")?"?":"&")+f+"="+b);c.noCache&&(a+=(-1==a.indexOf("?")?"?":"&")+"t="+ +new Date);d=document.createElement("script");d.type="text/javascript";d.async=!0;d.onload=this.onLoad.bind(this);d.onerror=this.onError.bind(this);d.src=a;c.id&&(d.id=c.id);document.getElementsByTagName("head")[0].appendChild(d)},
onLoad:function(c){c=c.target;c.onload=c.onerror=null;return c},onError:function(c){var a=c.target;a.onload=a.onerror=null;return c},Statics:{_count:0}});h.ScriptLoader=e})(window);(function(g){var h=g.Hilo,e=h.Class.create({load:function(c){var a=this,d=new Image;c.crossOrigin&&(d.crossOrigin=c.crossOrigin);d.onload=function(){a.onLoad(d)};d.onerror=d.onabort=a.onError.bind(d);d.src=c.src+(c.noCache?(-1==c.src.indexOf("?")?"?":"&")+"t="+ +new Date:"")},onLoad:function(c){c=c||g.event;c.onload=c.onerror=c.onabort=null;return c},onError:function(c){var a=c.target;a.onload=a.onerror=a.onabort=null;return c}});h.ImageLoader=e})(window);(function(g){g=g.Hilo;var h=g.ImageLoader,e=g.ScriptLoader,c=g.Class.create({Mixes:g.Event,constructor:function(a){this._source=[];this.add(a)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(a){a&&(a=a instanceof Array?a:[a],this._source=this._source.concat(a));return this},get:function(a){if(a)for(var d=this._source,f=0;f<d.length;f++){var b=d[f];if(b.id===a||b.src===a)return b}return null},getContent:function(a){return(a=this.get(a))&&a.content},start:function(){this._loadNext();
return this},_loadNext:function(){var a=this,d=a._source,f=d.length;if(a._loaded>=f)a.fire("complete");else if(a._currentIndex<f-1&&a._connections<a.maxConnections){var b=++a._currentIndex,d=d[b],k=a._getLoader(d);if(k){var q=k.onLoad,c=k.onError;k.onLoad=function(f){k.onLoad=q;k.onError=c;f=q&&q.call(k,f)||f.target;a._onItemLoad(b,f)};k.onError=function(f){k.onLoad=q;(k.onError=c)&&c.call(k,f);a._onItemError(b,f)};a._connections++}a._loadNext();k&&k.load(d)}},_getLoader:function(a){var d=a.loader;
if(d)return d;var f;if(!(f=a.type)){var b;if(a=a.src.match(/\/?[^/]+\.(\w+)(\?\S+)?$/i))b=a[1].toLowerCase();f=b||null}switch(f){case "png":case "jpg":case "jpeg":case "gif":d=new h;break;case "js":case "jsonp":d=new e}return d},_onItemLoad:function(a,d){var f=this._source[a];f.loaded=!0;f.content=d;this._connections--;this._loaded++;this.fire("load",f);this._loadNext()},_onItemError:function(a,d){var f=this._source[a];f.error=d;this._connections--;this._loaded++;this.fire("error",f);this._loadNext()},
getSize:function(a){for(var d=0,f=this._source,b=0;b<f.length;b++)var k=f[b],d=d+((a?k.loaded&&k.size:k.size)||0);return d},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length}});g.LoadQueue=c})(window);(function(g){var h=g.Hilo;g=h.Class.create({Mixes:h.Event,constructor:function(e){h.copy(this,e,!0);this._onAudioEvent=this._onAudioEvent.bind(this)},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_element:null,load:function(){if(!this._element)try{var e=this._element=new Audio;e.addEventListener("canplaythrough",this._onAudioEvent,!1);e.addEventListener("ended",this._onAudioEvent,!1);e.addEventListener("error",this._onAudioEvent,!1);e.src=this.src;e.volume=this.volume;
e.load()}catch(c){e=this._element={},e.play=e.pause=function(){}}return this},_onAudioEvent:function(e){var c=e.type;switch(c){case "canplaythrough":e.target.removeEventListener(c,this._onAudioEvent);this.loaded=!0;this.duration=this._element.duration;this.fire("load");this.autoPlay&&this._doPlay();break;case "ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case "error":this.fire("error")}},_doPlay:function(){this.playing||(this._element.volume=this.muted?0:this.volume,this._element.play(),
this.playing=!0)},play:function(){this.playing&&this.stop();this._element?this.loaded&&this._doPlay():(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._element.pause(),this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._element.pause(),this._element.currentTime=0,this.playing=!1);return this},setVolume:function(e){this.volume!=e&&(this.volume=e,this._element.volume=e);return this},setMute:function(e){this.muted!=
e&&(this.muted=e,this._element.volume=e?0:this.volume);return this},Statics:{isSupported:null!==g.Audio}});h.HTMLAudio=g})(window);(function(g){var h=g.Hilo,e=h.Class,c=h.Event,a=function(){var a=g.AudioContext||g.webkitAudioContext,f=a?new a:null;return e.create({Mixes:c,constructor:function(b){h.copy(this,b,!0);this._init()},src:null,loop:!1,autoPlay:!1,loaded:!1,playing:!1,duration:0,volume:1,muted:!1,_context:null,_gainNode:null,_buffer:null,_audioNode:null,_startTime:0,_offset:0,_init:function(){this._context=f;this._gainNode=f.createGain?f.createGain():f.createGainNode();this._gainNode.connect(f.destination);this._onAudioEvent=
this._onAudioEvent.bind(this);this._onDecodeComplete=this._onDecodeComplete.bind(this);this._onDecodeError=this._onDecodeError.bind(this)},load:function(){if(!this._buffer){var b=new XMLHttpRequest;b.src=this.src;b.open("GET",this.src,!0);b.responseType="arraybuffer";b.onload=this._onAudioEvent;b.onprogress=this._onAudioEvent;b.onerror=this._onAudioEvent;b.send();this._buffer=!0}return this},_onAudioEvent:function(b){switch(b.type){case "load":b=b.target;b.onload=b.onprogress=b.onerror=null;this._context.decodeAudioData(b.response,
this._onDecodeComplete,this._onDecodeError);break;case "ended":this.playing=!1;this.fire("end");this.loop&&this._doPlay();break;case "progress":this.fire(b);break;case "error":this.fire(b)}},_onDecodeComplete:function(b){this._buffer=b;this.loaded=!0;this.duration=b.duration;this.fire("load");this.autoPlay&&this._doPlay()},_onDecodeError:function(){this.fire("error")},_doPlay:function(){this._clearAudioNode();var b=this._context.createBufferSource();b.start||(b.start=b.noteOn,b.stop=b.noteOff);b.buffer=
this._buffer;b.onended=this._onAudioEvent;this._gainNode.gain.value=this.muted?0:this.volume;b.connect(this._gainNode);b.start(0,this._offset);this._audioNode=b;this._startTime=this._context.currentTime;this.playing=!0},_clearAudioNode:function(){var b=this._audioNode;b&&(b.onended=null,b.disconnect(0),this._audioNode=null)},play:function(){this.playing&&this.stop();this.loaded?this._doPlay():this._buffer||(this.autoPlay=!0,this.load());return this},pause:function(){this.playing&&(this._audioNode.stop(0),
this._offset+=this._context.currentTime-this._startTime,this.playing=!1);return this},resume:function(){this.playing||this._doPlay();return this},stop:function(){this.playing&&(this._audioNode.stop(0),this._audioNode.disconnect(),this._offset=0,this.playing=!1);return this},setVolume:function(b){this.volume!=b&&(this.volume=b,this._gainNode.gain.value=b);return this},setMute:function(b){this.muted!=b&&(this.muted=b,this._gainNode.gain.value=b?0:this.volume);return this},Statics:{isSupported:null!=
a,enabled:!1,enable:function(){if(!this.enabled&&f){var b=f.createBufferSource();b.buffer=f.createBuffer(1,1,22050);b.connect(f.destination);b.start?b.start(0,0,0):b.noteOn(0,0,0);return this.enabled=!0}return this.enabled}}})}();h.WebAudio=a})(window);(function(g){var h=g.Hilo,e=h.HTMLAudio,c=h.WebAudio;h.WebSound={_audios:{},enableAudio:function(){c.isSupported&&c.enable()},getAudio:function(a){a=this._normalizeSource(a);var d=this._audios[a.src];d||(c.isSupported?d=new c(a):e.isSupported&&(d=new e(a)),this._audios[a.src]=d);return d},removeAudio:function(a){a="string"===typeof a?a:a.src;var d=this._audios[a];d&&(d.stop(),d.off(),this._audios[a]=null,delete this._audios[a])},_normalizeSource:function(a){var d={};"string"===typeof a?d={src:a}:
h.copy(d,a);return d}}})(window);(function(g){var h=g.Hilo;g=h.Class.create({constructor:function(e){e=e||{};h.copy(this,e,!0)},renderType:null,canvas:null,stage:null,startDraw:function(e){return!0},draw:function(e){},endDraw:function(e){},transform:function(){},clear:function(e,c,a,d){},resize:function(e,c){}});h.Renderer=g})(window);(function(g){var h=g.Hilo,e=h.Class,c=h.Renderer,a=h.Drawable,d=function(){return e.create({Extends:c,constructor:function(f){d.superclass.constructor.call(this,f)},renderType:"dom",startDraw:function(f){var b=f.drawable=f.drawable||new a;b.domElement=b.domElement||h.createElement("div",{style:{position:"absolute"}});return f.visible},draw:function(f){h.setElementStyleByView(f)},resize:function(f,b){var a=this.canvas.style;a.width=f+"px";a.height=b+"px";"absolute"!=a.position&&(a.position="relative")}})}();
h.DOMRenderer=d})(window);(function(g){g=g.Hilo;var h=g.Matrix,e=Math.PI/180,c=g.Class.create({Extends:g.Renderer,Statics:{MAX_BATCH_NUM:2E3,ATTRIBUTE_NUM:5,isSupport:null},renderType:"webgl",gl:null,constructor:function(f){c.superclass.constructor.call(this,f);f=this.gl=this.canvas.getContext("webgl",{stencil:!0})||this.canvas.getContext("experimental-webgl",{stencil:!0});f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.enable(f.BLEND);f.disable(f.CULL_FACE);f.disable(f.DEPTH_TEST);f.disable(f.STENCIL_TEST);this._initShaders();
this.vertex2=new Float32Array(8);this.indexs2=new Uint16Array([0,1,2,1,2,3]);this.notextureShader.active();f.bufferData(f.ELEMENT_ARRAY_BUFFER,this.indexs2,f.STATIC_DRAW);f.bufferData(f.ARRAY_BUFFER,this.vertex2,f.STREAM_DRAW);this.maxBatchNum=c.MAX_BATCH_NUM;this.positionStride=4*c.ATTRIBUTE_NUM;var b=6*this.maxBatchNum;this.vertex=new Float32Array(this.maxBatchNum*c.ATTRIBUTE_NUM*4);this.indexs=new Uint16Array(b);for(var a=0,d=0;a<b;a+=6,d+=4)this.indexs[a+0]=d+0,this.indexs[a+1]=d+1,this.indexs[a+
2]=d+2,this.indexs[a+3]=d+1,this.indexs[a+4]=d+2,this.indexs[a+5]=d+3;this.batchIndex=0;this.sprites=[];this.defaultShader.active();f.bufferData(f.ELEMENT_ARRAY_BUFFER,this.indexs,f.STATIC_DRAW);f.bufferData(f.ARRAY_BUFFER,this.vertex,f.STREAM_DRAW)},context:null,startDraw:function(f){return f.visible&&0<f.alpha?(f.__webglWorldMatrix=f.__webglWorldMatrix||new h(1,0,0,1,0,0),f.__webglRenderAlpha=f.__webglRenderAlpha||1,!0):!1},draw:function(f){var b=f.drawable,a=b&&b.image,d=f.background;(this.batchIndex>=
this.maxBatchNum||d)&&this._renderBatches();if(f.clipChildren){this.stencilLevel=this.stencilLevel||0;var c=this.gl;0===this.stencilLevel?(c.enable(c.STENCIL_TEST),c.clear(c.STENCIL_BUFFER_BIT),c.stencilFunc(c.ALWAYS,1,255),c.stencilOp(c.KEEP,c.REPLACE,c.REPLACE)):c.stencilOp(c.KEEP,c.INCR,c.INCR);c.colorMask(!1,!1,!1,!1);this.notextureShader.active();this._renderBackground(f,{r:1,g:1,b:1});this.stencilLevel+=1;c.colorMask(!0,!0,!0,!0);c.stencilFunc(c.LEQUAL,this.stencilLevel,255);c.stencilOp(c.KEEP,
c.KEEP,c.KEEP)}d&&(this.notextureShader.active(),this._renderBackground(f,d.toColorRgb()));a&&(this.defaultShader.active(),this._renderImage(f,a,b.rect))},endDraw:function(f){f===this.stage&&this._renderBatches();f.clipChildren&&(f=this.gl,--this.stencilLevel,f.stencilFunc(f.LEQUAL,this.stencilLevel,255),0==this.stencilLevel&&(this._renderBatches(),f.disable(this.gl.STENCIL_TEST)))},transform:function(f){this._setConcatenatedMatrix(f,f.parent);0<f.alpha&&(f.__webglRenderAlpha=f.parent&&f.parent.__webglRenderAlpha?
f.alpha*f.parent.__webglRenderAlpha:f.alpha)},clear:function(f,b,a,d){this.gl.clear(this.gl.COLOR_BUFFER_BIT)},resize:function(f,b){if(this.width!==f||this.height!==b)this.width=this.canvas.width=f,this.height=this.canvas.height=b,this.gl.viewport(0,0,f,b),this.activeShader.active(!0)},_renderBackground:function(f,b){var a=this.gl,d=f.__webglRenderAlpha;a.uniform4f(this.activeShader.u_color,b.r/255*d,b.g/255*d,b.b/255*d,d);var c=f.width,e=f.height,d=-f.pivotX,h=f.pivotY-e,g=this.vertex2;g[0]=d;g[1]=
h;g[2]=d+c;g[3]=h;g[4]=d;g[5]=h+e;g[6]=d+c;g[7]=h+e;c=f.__webglWorldMatrix;for(e=0;4>e;e++)d=g[2*e],h=g[2*e+1],g[2*e]=c.a*d+c.c*h+c.tx,g[2*e+1]=c.b*d+c.d*h+c.ty;a.bufferData(a.ARRAY_BUFFER,g,a.STREAM_DRAW);a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0)},_renderImage:function(f,b,a){b.texture||this.activeShader.uploadTexture(b);var d=f.width,c=f.height,e=-f.pivotX,g=-f.pivotY,h=a[2],m=a[3],l=a[4],p=a[5];if(l||p)e=e+l-.5*h,g=g+p-.5*m;c=this._createVertexs(b,a[0],a[1],h,m,e,g,d,c);a=this.batchIndex*
this.positionStride;d=this.vertex;e=f.__webglRenderAlpha;d[a+0]=c[0];d[a+1]=c[1];d[a+2]=c[2];d[a+3]=c[3];d[a+4]=e;d[a+5]=c[4];d[a+6]=c[5];d[a+7]=c[6];d[a+8]=c[7];d[a+9]=e;d[a+10]=c[8];d[a+11]=c[9];d[a+12]=c[10];d[a+13]=c[11];d[a+14]=e;d[a+15]=c[12];d[a+16]=c[13];d[a+17]=c[14];d[a+18]=c[15];d[a+19]=e;c=f.__webglWorldMatrix;for(e=0;4>e;e++)g=d[a+5*e],h=d[a+5*e+1],d[a+5*e]=c.a*g+c.c*h+c.tx,d[a+5*e+1]=c.b*g+c.d*h+c.ty;f.texture=b.texture;this.sprites[this.batchIndex++]=f},_renderBatches:function(){var a=
this.gl;a.bufferSubData(a.ARRAY_BUFFER,0,this.vertex.subarray(0,this.batchIndex*this.positionStride));for(var a=0,b=null,d=0;d<this.batchIndex;d++){var c=this.sprites[d];b&&b!==c.texture&&(this._renderBatch(a,d),a=d);b=c.texture}this._renderBatch(a,this.batchIndex);this.batchIndex=0},_renderBatch:function(a,b){var d=this.gl,c=b-a;0<c&&(d.bindTexture(d.TEXTURE_2D,this.sprites[a].texture),d.drawElements(d.TRIANGLES,6*c,d.UNSIGNED_SHORT,12*a))},_initShaders:function(){this.defaultShader=new d(this,{v:"attribute vec2 a_position;\nattribute vec2 a_TexCoord;\nattribute float a_alpha;\nuniform mat3 u_projectionTransform;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n    v_TexCoord = a_TexCoord;\n    v_alpha = a_alpha;\n}\n",
f:"\nprecision mediump float;\nuniform sampler2D u_Sampler;\nvarying vec2 v_TexCoord;\nvarying float v_alpha;\nvoid main(){\n    gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_alpha;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:20},{name:"a_TexCoord",count:2,offset:8,stride:20},{name:"a_alpha",count:1,offset:16,stride:20}],uniforms:["u_projectionTransform","u_Sampler"]});this.notextureShader=new d(this,{v:"attribute vec2 a_position;\nuniform mat3 u_projectionTransform;\nvoid main(){\n    gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\n}\n",
f:"\nprecision mediump float;\nuniform vec4 u_color;\nvoid main(){\n    gl_FragColor = u_color;\n}\n"},{attributes:[{name:"a_position",count:2,offset:0,stride:8}],uniforms:["u_projectionTransform","u_color"]})},_createVertexs:function(a,b,d,c,e,g,h,n,m){var l=this.__tempVertexs||[],p=a.width;a=a.height;c/=p;e/=a;b/=p;d/=a;1<c+b&&(c=1-b);1<e+d&&(e=1-d);d=1-d-e;h=-m-h;p=0;l[p++]=g;l[p++]=h;l[p++]=b;l[p++]=d;l[p++]=g+n;l[p++]=h;l[p++]=b+c;l[p++]=d;l[p++]=g;l[p++]=h+m;l[p++]=b;l[p++]=d+e;l[p++]=g+n;l[p++]=
h+m;l[p++]=b+c;l[p++]=d+e;return l},_setConcatenatedMatrix:function(a,b){var d=a.__webglWorldMatrix,c=1,h=0,g=360-a.rotation%360,u=a.scaleX,n=a.scaleY;g&&(h=g*e,c=Math.cos(h),h=Math.sin(h));d.a=c*u;d.b=h*u;d.c=-h*n;d.d=c*n;d.tx=a.x;d.ty=-a.y;c=b.__webglWorldMatrix;d.concat(c.a,c.b,c.c,c.d,c.tx,c.ty)}}),a={},d=function(a,b,d){this.renderer=a;this.gl=a.gl;this.program=this._createProgram(this.gl,b.v,b.f);d=d||{};this.attributes=d.attributes||[];this.uniforms=d.uniforms||[];this.vertexBuffer=this.gl.createBuffer();
this.indexBuffer=this.gl.createBuffer()};d.prototype={active:function(a){var b=this,d=b.renderer,c=d.activeShader;if(c!==b||a){var e=b.gl,h=b.program;h&&e&&(c&&c.attributes.forEach(function(a){e.disableVertexAttribArray(c[a.name])}),d.activeShader=b,e.useProgram(h),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,b.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,b.vertexBuffer),b.attributes.forEach(function(a){attribute=a.name;b[attribute]=b[attribute]||e.getAttribLocation(h,attribute);e.enableVertexAttribArray(b[attribute]);
e.vertexAttribPointer(b[attribute],a.count,e.FLOAT,!1,a.stride,a.offset)}),b.uniforms.forEach(function(a){b[a]=b[a]||e.getUniformLocation(h,a)}),b.width!==d.width||b.height!==d.height)&&(b.width=d.width,b.height=d.height,b.uploadProjectionTransform(!0))}},uploadTexture:function(f){var b=this.gl;if(a[f.src])f.texture=a[f.src];else{var d=b.createTexture();b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,d);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,1);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);
b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,f);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.uniform1i(this.u_Sampler,0);b.bindTexture(b.TEXTURE_2D,null);f.texture=d;a[f.src]=d}},uploadProjectionTransform:function(a){var b=this.gl;if(!this._projectionTransformElements||a)this._projectionTransformElements=
new Float32Array([2/this.width,0,0,0,2/this.height,0,-1,1,1]);b.uniformMatrix3fv(this.u_projectionTransform,!1,this._projectionTransformElements)},_createProgram:function(a,b,d){b=this._createShader(a,a.VERTEX_SHADER,b);var c=this._createShader(a,a.FRAGMENT_SHADER,d);if(!b||!c)return null;if(d=a.createProgram())if(a.attachShader(d,b),a.attachShader(d,c),a.linkProgram(d),a.deleteShader(c),a.deleteShader(b),!a.getProgramParameter(d,a.LINK_STATUS))return b=a.getProgramInfoLog(d),console.log("Failed to link program: "+
b),a.deleteProgram(d),null;return d},_createShader:function(a,b,d){if(b=a.createShader(b))if(a.shaderSource(b,d),a.compileShader(b),!a.getShaderParameter(b,a.COMPILE_STATUS))return d=a.getShaderInfoLog(b),console.log("Failed to compile shader: "+d),a.deleteShader(b),null;return b}};c.isSupport=function(){if(void 0===this._isSupport){var a=document.createElement("canvas");a.getContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))?this._isSupport=!0:this._isSupport=!1}return this._isSupport};
g.WebGLRenderer=c})(window);(function(g){g=g.Hilo;var h=g.Class.create({Extends:g.Renderer,constructor:function(e){h.superclass.constructor.call(this,e);this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(e){return e.visible&&0<e.alpha?(this.context.save(),!0):!1},draw:function(e){var c=this.context,a=e.width,d=e.height;e.clipChildren&&(c.beginPath(),c.rect(0,0,a,d),c.clip());var f=e.background;f&&(c.fillStyle=f,c.fillRect(0,0,a,d));if(e=(f=e.drawable)&&f.image){var f=f.rect,b=f[4],
k=f[5];(b||k)&&c.translate(b-.5*sw,k-.5*sh);c.drawImage(e,f[0],f[1],f[2],f[3],0,0,a,d)}},endDraw:function(e){this.context.restore()},transform:function(e){var c=this.context,a=e.x,d=e.y,f=e.scaleX,b=e.scaleY,k=e.pivotX,h=e.pivotY,g=e.rotation%360,v=e.align;if(v)if("function"===typeof v)e.align();else{var u=e.parent;if(u){var n=e.width,m=e.height,l=u.width,u=u.height;switch(v){case "TL":d=a=0;break;case "T":a=l-n>>1;d=0;break;case "TR":a=l-n;d=0;break;case "L":a=0;d=u-m>>1;break;case "C":a=l-n>>1;
d=u-m>>1;break;case "R":a=l-n;d=u-m>>1;break;case "BL":a=0;d=u-m;break;case "B":a=l-n>>1;d=u-m;break;case "BR":a=l-n,d=u-m}}}0==a&&0==d||c.translate(a,d);0!=g&&c.rotate(g*Math.PI/180);1==f&&1==b||c.scale(f,b);0==k&&0==h||c.translate(-k,-h);0<e.alpha&&(c.globalAlpha*=e.alpha)},clear:function(e,c,a,d){this.context.clearRect(e,c,a,d)},resize:function(e,c){this.canvas.width=e;this.canvas.height=c}});g.CanvasRenderer=h})(window);(function(g){var h=g.Hilo,e=h.Class,c=h.Event,a=h.Matrix;g=function(){function d(a,b,d){for(var c=a.length,e=b.length,h,g,n,m,l,p,t=0,w=h=0;w<c;w++){h=a[w];g=a[w<c-1?w+1:0];t=h.y-g.y;h=g.x-h.x;g=Math.sqrt(t*t+h*h);t/=g;h/=g;g=n=a[0].x*t+a[0].y*h;for(var x=1;x<c;x++)p=a[x].x*t+a[x].y*h,p>n?n=p:p<g&&(g=p);m=l=b[0].x*t+b[0].y*h;for(x=1;x<e;x++)p=b[x].x*t+b[x].y*h,p>l?l=p:p<m&&(m=p);g<m?(g=m-n,t=-t,h=-h):g-=l;if(0<=g)return!1;g>d.overlap&&(d.overlap=g,d.normal.x=t,d.normal.y=h)}return d}return e.create({Mixes:c,
constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("View");h.copy(this,a,!0)},id:null,x:0,y:0,width:0,height:0,alpha:1,rotation:0,visible:!0,pivotX:0,pivotY:0,scaleX:1,scaleY:1,pointerEnabled:!0,background:null,align:null,drawable:null,boundsArea:null,parent:null,depth:-1,getStage:function(){for(var a=this,b;b=a.parent;)a=b;return a.canvas&&a.renderer?a:null},getScaledWidth:function(){return this.width*this.scaleX},getScaledHeight:function(){return this.height*this.scaleY},addTo:function(a,
b){"number"===typeof b?a.addChildAt(this,b):a.addChild(this);return this},removeFromParent:function(){var a=this.parent;a&&a.removeChild(this);return this},fixSize:function(){if(!this.width||!this.height){var a=this.drawable&&this.drawable.rect;a&&(target.width=target.width||a[2],target.height=target.height||a[3])}},getBounds:function(){for(var a=this.width,b=this.height,d=this.getConcatenatedMatrix(),a=this.boundsArea||[{x:0,y:0},{x:a,y:0},{x:a,y:b},{x:0,y:b}],b=[],c,e,h,g,n,m,l,p=0,t=a.length;p<
t;p++)c=d.transformPoint(a[p],!0,!0),e=c.x,h=c.y,0==p?(g=n=e,m=l=h):(g>e?g=e:n<e&&(n=e),m>h?m=h:l<h&&(l=h)),b[p]=c;b.x=g;b.y=m;b.width=n-g;b.height=l-m;return b},getConcatenatedMatrix:function(f){for(var b=new a(1,0,0,1,0,0),d=this;d!=f&&d.parent;d=d.parent){var c=1,e=0,h=d.rotation%360,g=d.pivotX,n=d.pivotY,m=d.scaleX,l=d.scaleY;h&&(e=h*Math.PI/180,c=Math.cos(e),e=Math.sin(e));0!=g&&(b.tx-=g);0!=n&&(b.ty-=n);b.concat(c*m,e*m,-e*l,c*l,d.x,d.y)}return b},hitTestPoint:function(a,b,d){var c=this.getBounds(),
e=a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height;if(e&&d){d=0;for(var e=!1,h,g,n,m,l=0,p=c.length;l<p;l++){var t=c[l],w=c[(l+1)%p];if(t.y==w.y&&b==t.y&&(t.x>w.x?(h=w.x,g=t.x):(h=t.x,g=w.x),a>=h&&a<=g)){e=!0;continue}t.y>w.y?(n=w.y,m=t.y):(n=t.y,m=w.y);if(!(b<n||b>m)){var x=(b-t.y)*(w.x-t.x)/(w.y-t.y)+t.x;x>a?d++:x==a&&(e=!0);t.x>a&&t.y==b&&(t=c[(p+l-1)%p],(t.y<b&&w.y>b||t.y>b&&w.y<b)&&d++)}}e=e||1==d%2}return e},hitTestObject:function(a,b){var c=this.getBounds(),e=a.getBounds(),h=c.x<=e.x+e.width&&
e.x<=c.x+c.width&&c.y<=e.y+e.height&&e.y<=c.y+c.height;h&&b&&(h=(h=d(c,e,{overlap:-Infinity,normal:{x:0,y:0}}))?d(e,c,h):!1);return!!h},_render:function(a,b){this.onUpdate&&!1===this.onUpdate(b)||!a.startDraw(this)||(a.transform(this),this.render(a,b),a.endDraw(this))},_fireMouseEvent:function(a){a.eventCurrentTarget=this;this.fire(a);if("mousemove"==a.type){if(!this.__mouseOver){this.__mouseOver=!0;var b=h.copy({},a);b.type="mouseover";this.fire(b)}}else"mouseout"==a.type&&(this.__mouseOver=!1);
b=this.parent;a._stopped||a._stopPropagationed||!b||("mouseout"==a.type||"touchout"==a.type?b.hitTestPoint(a.stageX,a.stageY,!0)||b._fireMouseEvent(a):b._fireMouseEvent(a))},onUpdate:null,render:function(a,b){this.fixSize();a.draw(this)},toString:function(){for(var a,b=this;b;)a=a?b.id+"."+a:b.id,b=b.parent;return a}})}();h.View=g})(window);(function(g){var h=g.Hilo,e=h.Drawable,c=h.Class.create({Extends:h.View,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Container");c.superclass.constructor.call(this,a);this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(a,d){var f=this.children,b=f.length,c=a.parent;d=0>d?0:d>b?b:d;var e=this.getChildIndex(a);if(e==d)return this;0<=e?(f.splice(e,1),d=d==
b?b-1:d):c&&c.removeChild(a);f.splice(d,0,a);0>e?this._updateChildren(d):this._updateChildren(e<d?e:d,(e<d?d:e)+1);a.drawable&&a.drawable.domElement&&(this._domContainerFlag=!0);return this},addChild:function(a){for(var d=this.children.length,f=arguments,b=0,c=f.length;b<c;b++)this.addChildAt(f[b],d+b);return this},removeChildAt:function(a){var d=this.children;if(0>a||a>=d.length)return null;var f=d[a];if(f){var b=f.drawable,c=b&&b.domElement;if(c){var e=c.parentNode;e&&e.removeChild(c);b.domElement=
null;this._domContainerFlag=!0}f.parent=null;f.depth=-1}d.splice(a,1);this._updateChildren(a);return f},removeChild:function(a){return this.removeChildAt(this.getChildIndex(a))},removeChildById:function(a){for(var d=this.children,f,b=0,c=d.length;b<c;b++)if(f=d[b],f.id===a)return this.removeChildAt(b),f;return null},removeAllChildren:function(){for(;this.children.length;)this.removeChildAt(0);return this},getChildAt:function(a){var d=this.children;return 0>a||a>=d.length?null:d[a]},getChildById:function(a){for(var d=
this.children,f,b=0,c=d.length;b<c;b++)if(f=d[b],f.id===a)return f;return null},getChildIndex:function(a){return this.children.indexOf(a)},setChildIndex:function(a,d){var f=this.children,b=f.indexOf(a);if(0<=b&&b!=d){var c=f.length;d=0>d?0:d>=c?c-1:d;f.splice(b,1);f.splice(d,0,a);this._updateChildren()}return this},swapChildren:function(a,d){var f=this.children,b=this.getChildIndex(a),c=this.getChildIndex(d);a.depth=c;f[c]=a;d.depth=b;f[b]=d},swapChildrenAt:function(a,d){var f=this.children,b=this.getChildAt(a),
c=this.getChildAt(d);b.depth=d;f[d]=b;c.depth=a;f[a]=c},sortChildren:function(a){var d=this.children;if("string"==typeof a){var f=a;a=function(a,d){return d[f]-a[f]}}d.sort(a);this._updateChildren()},_updateChildren:function(a,d){var f=this.children,b;d=d||f.length;for(var c=a||0;c<d;c++)b=f[c],b.depth=c+1,b.parent=this},contains:function(a){for(;a=a.parent;)if(a===this)return!0;return!1},getViewAtPoint:function(a,d,f,b,c){if(this.clipChildren&&!this.hitTestPoint(a,d,f))return null;for(var e=b?[]:
null,h=this.children,g,u,n=h.length-1;0<=n;n--)if(g=h[n],!(!g||!g.visible||0>=g.alpha||c&&!g.pointerEnabled))if(g.children&&g.children.length&&(!c||g.pointerChildren)&&(u=g.getViewAtPoint(a,d,f,b,c)),u)if(b)u.length&&(e=e.concat(u));else return u;else if(g.hitTestPoint(a,d,f))if(b)e.push(g);else return g;return b&&e.length?e:null},render:function(a,d){c.superclass.render.call(this,a,d);"dom"!=a.renderType&&(this._domContainerFlag&&(this._domContainerFlag=!1,this._domContainerUpdate()),this.drawable&&
this.drawable.domElement&&h.setElementStyleByView(this,!0));var f=this.children.slice(0),b,e,g;b=0;for(e=f.length;b<e;b++)g=f[b],g._render(a,d)},_domContainerUpdate:function(){var a=this.children,d=!1;i=0;for(len=a.length;i<len;i++)if(child=a[i],child.drawable&&child.drawable.domElement){d=!0;break}var a=this.parent,c=this.drawable,b=c&&c.domElement;d?b||(c=this.drawable=this.drawable||new e,c.domElement=c.domElement||h.createElement("div",{style:{position:"absolute"}}),a&&a._domContainerUpdate()):
b&&(b&&((d=b.parentNode)&&d.removeChild(b),this.drawable=c.domElement=null),a&&a._domContainerUpdate())}});h.Container=c})(window);(function(g){var h=g.Hilo,e=h.CanvasRenderer,c=h.DOMRenderer,a=h.WebGLRenderer,d=h.Class.create({Extends:h.Container,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Stage");d.superclass.constructor.call(this,a);this._initRenderer(a);var b=this.width,c=this.height,e=this.updateViewport();a.width||(b=e&&e.width||320);a.height||(c=e&&e.height||480);this.resize(b,c,!0)},canvas:null,renderer:null,paused:!1,viewport:null,_initRenderer:function(d){var b=d.canvas,g=d.container;d=d.renderType||
"canvas";"string"===typeof b&&(b=h.getElement(b));"string"===typeof g&&(g=h.getElement(g));b||(b=h.createElement("dom"===d?"div":"canvas",{style:{position:"absolute",overflow:"hidden"}}));this.canvas=b;g&&g.appendChild(b);b={canvas:b,stage:this};switch(d){case "dom":this.renderer=new c(b);break;case "webgl":a.isSupport()?this.renderer=new a(b):this.renderer=new e(b);break;default:this.renderer=new e(b)}},_render:function(a,b){if((!this.onUpdate||!1!==this.onUpdate(b))&&a.startDraw(this)){var d=this.width,
c=this.height,e=this.scaleX,g=this.scaleY,h=this._height,n=this._scaleX,m=this._scaleY,l=this.canvas,p=l.style;if(this._width!==d||n!==e)this._width=d,this._scaleX=e,l.width=d,p.width=e*d+"px";if(h!==c||m!==g)this._height=c,this._scaleY=g,l.height=c,p.height=g*c+"px";(d=this.drawable&&this.drawable.domElement)&&!d.parentNode&&(d.style.overflow="hidden",l.appendChild(d));a.clear(0,0,this.width,this.height);this.render(a,b);a.endDraw(this)}},addTo:function(a){var b=this.canvas;b.parentNode!==a&&a.appendChild(b);
return this},tick:function(a){this.paused||this._render(this.renderer,a)},resize:function(a,b,d){if(d||this.width!==a||this.height!==b)this.width=a,this.height=b,this.renderer.resize(a,b),this.updateViewport()},enableDOMEvent:function(a,b){var d=this,c=d.canvas,e="string"===typeof a?[a]:a;b=!1!==b;for(var g=d._domListener||(d._domListener=function(a){d._onDOMEvent(a)}),h=0;h<e.length;h++)a=e[h],b?c.addEventListener(a,g,!1):c.removeEventListener(a,g);return d},_onDOMEvent:function(a){var b=a.type,
d=0==b.indexOf("touch"),c=a;if(d)var e=a.touches,c=a.changedTouches,c=e&&e.length?e[0]:c&&c.length?c[0]:null;var e=c.pageX||c.clientX,c=c.pageY||c.clientY,g=this.viewport||this.updateViewport();a.stageX=e=(e-g.left)/this.scaleX;a.stageY=c=(c-g.top)/this.scaleY;a.stopPropagation=function(){this._stopPropagationed=!0};var e=this.getViewAtPoint(e,c,!0,!1,!0)||this,c=this.canvas,g=this._eventTarget,u="mouseout"===b;if(g&&(!(g==e||g.contains&&g.contains(e))||u)){if(u="touchmove"===b?"touchout":"mousemove"===
b||u||!e?"mouseout":null){var n=h.copy({},a);n.type=u;n.eventTarget=g;g._fireMouseEvent(n)}a.lastEventTarget=g;this._eventTarget=null}e&&e.pointerEnabled&&"mouseout"!==b&&(a.eventTarget=this._eventTarget=e,e._fireMouseEvent(a));d||(c.style.cursor=e&&e.pointerEnabled&&e.useHandCursor?"pointer":"");h.browser.android&&"touchmove"===b&&a.preventDefault()},updateViewport:function(){var a=this.canvas,b=null;a.parentNode&&(b=this.viewport=h.getElementRect(a));return b},_domContainerUpdate:function(){d.superclass._domContainerUpdate.call(this);
var a=this.drawable&&this.drawable.domElement;a&&!a.parentNode&&this.canvas.parentNode&&this.canvas.parentNode.appendChild(a)}});h.Stage=d})(window);(function(g){var h=g.Hilo,e=h.Drawable,c=h.Class.create({Extends:h.View,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Bitmap");c.superclass.constructor.call(this,a);this.drawable=new e(a);if(!this.width||!this.height)if(a=this.drawable.rect)this.width=a[2],this.height=a[3]},setImage:function(a,d){this.drawable.init({image:a,rect:d});d&&(this.width=d[2],this.height=d[3]);return this}});h.Bitmap=c})(window);(function(g){var h=g.Hilo,e=h.Drawable,c=h.Class.create({Extends:h.View,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Sprite");c.superclass.constructor.call(this,a);this._frames=[];this._frameNames={};this.drawable=new e;a.frames&&this.addFrame(a.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(a,d){var c=null!=d?d:this._frames.length;
if(a instanceof Array)for(var b=0,e=a.length;b<e;b++)this.setFrame(a[b],c+b);else this.setFrame(a,c);return this},setFrame:function(a,d){var c=this._frames,b=c.length;d=0>d?0:d>b?b:d;c[d]=a;a.name&&(this._frameNames[a.name]=a);if(0==d&&!this.width||!this.height)this.width=a.rect[2],this.height=a.rect[3];return this},getFrame:function(a){if("number"===typeof a){var d=this._frames;return 0>a||a>=d.length?null:d[a]}return this._frameNames[a]},getFrameIndex:function(a){var d=this._frames,c=d.length,b=
-1;if("number"===typeof a)b=a;else if(a="string"===typeof a?this._frameNames[a]:a)for(var e=0;e<c;e++)if(a===d[e]){b=e;break}return b},play:function(){this.paused=!1;return this},stop:function(){this.paused=!0;return this},"goto":function(a,d){var c=this._frames.length,b=this.getFrameIndex(a);this.currentFrame=0>b?0:b>=c?c-1:b;this.paused=d;this._firstRender=!0;return this},_render:function(a,d){var f=this.currentFrame,b;this._firstRender?(b=f,this._firstRender=!1):b=this._nextFrame(d);b!=f&&(this.currentFrame=
b,(f=this._frames[b].callback)&&f.call(this));this.drawable.init(this._frames[b]);c.superclass._render.call(this,a,d)},_nextFrame:function(a){var d=this._frames,c=d.length,b=this.currentFrame,d=d[b],e=this._frameElapsed;a=0!=b||this.drawable?e+(this.timeBased?a:1):0;e=this._frameElapsed=a<(d.duration||this.interval)?a:0;(d.stop||!this.loop&&b>=c-1)&&this.stop();this.paused||0!=e||(null!=d.next?b=this.getFrameIndex(d.next):b>=c-1?b=0:this.drawable&&b++);return b},setFrameCallback:function(a,d){if(a=
this.getFrame(a))a.callback=d;return this}});h.Sprite=c})(window);(function(g){var h=g.Hilo,e=h.Drawable,c=h.Class.create({Extends:h.View,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Button");c.superclass.constructor.call(this,a);this.drawable=new e(a);this.setState(c.UP)},upState:null,overState:null,downState:null,disabledState:null,state:null,enabled:!0,useHandCursor:!0,setEnabled:function(a){this.enabled!=a&&(a?this.setState(c.UP):this.setState(c.DISABLED));return this},setState:function(a){if(this.state!==a){this.state=a;this.pointerEnabled=
this.enabled=a!==c.DISABLED;var d;switch(a){case c.UP:d=this.upState;break;case c.OVER:d=this.overState;break;case c.DOWN:d=this.downState;break;case c.DISABLED:d=this.disabledState}d&&(this.drawable.init(d),h.copy(this,d,!0))}return this},fire:function(a,d){if(this.enabled){switch("string"===typeof a?a:a.type){case "mousedown":case "touchstart":case "touchmove":this.setState(c.DOWN);break;case "mouseover":this.setState(c.OVER);break;case "mouseup":this.overState?this.setState(c.OVER):this.upState&&
this.setState(c.UP);break;case "touchend":case "touchout":case "mouseout":this.setState(c.UP)}return c.superclass.fire.call(this,a,d)}},Statics:{UP:"up",OVER:"over",DOWN:"down",DISABLED:"disabled"}});h.Button=c})(window);(function(g){var h=g.Hilo;g=h.Class;var e=h.Drawable,c=h.View,a=h.createElement("canvas"),d=a&&a.getContext("2d"),f=g.create({Extends:c,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("Text");f.superclass.constructor.call(this,a);a.font||(this.font="16px arial");this._fontHeight=f.measureFontHeight(this.font);a.width?(this.width=a.width,this._autoWidth=!1):(this.width=512,this._autoWidth=!0);a.height?(this.height=a.height,this._autoHeight=!1):(this.height=512,this._autoHeight=!0)},
text:null,color:"#000",textAlign:null,outline:!1,lineSpacing:0,font:null,cache:function(){var b=!0;this._text!==this.text&&(this._text=this.text,b=!0);this._color!==this.color&&(this._color=this.color,b=!0);this._font!==this.font&&(this._font=this.font,b=!0);b&&(a.width=this.width,a.height=this.height,d.clearRect(0,0,a.width,a.height),this._draw(d),this._cacheImage=new Image,this._cacheImage.src=a.toDataURL(),this.drawable=this.drawable||new e,this.drawable.init(this._cacheImage),console.log(JSON.stringify(this.drawable),
this.width,this.height))},setFont:function(a){this.font!==a&&(this.font=a,this._fontHeight=f.measureFontHeight(a));return this},render:function(a,d){if("canvas"===a.renderType)this._draw(a.context);else{if("dom"===a.renderType){var c=this.drawable.domElement,e=c.style;e.font=this.font;e.textAlign=this.textAlign;e.color=this.color;e.width=this._autoWidth?null:this.width+"px";e.height=this._autoHeight?null:this.height+"px";e.lineHeight=this._fontHeight+this.lineSpacing+"px";e["word-break"]="break-all";
e["word-wrap"]="break-word";this._text!==this.text&&(c.innerHTML=this.text.replace("\n","</br>"))}else this.cache();a.draw(this)}},_draw:function(a){var c=this.text.toString();if(c){a.font=this.font;a.textAlign=this.textAlign;a.textBaseline="top";var e=c.split(/\r\n|\r|\n|<br(?:[ \/])*>/),f=0,g=0,h=this._fontHeight+this.lineSpacing,n,m,l,c=[];n=0;for(len=e.length;n<len;n++)if(m=e[n],l=a.measureText(m).width,l<=this.width||this._autoWidth)c.push({text:m,y:g}),f<l&&(f=l),g+=h;else{l="";var p=0,t,w,
x;w=0;for(wlen=m.length;w<wlen;w++)x=m[w],t=a.measureText(l+x).width,t>this.width?(c.push({text:l,y:g}),f<p&&(f=p),g+=h,l=x):(p=t,l+=x),w==wlen-1&&(c.push({text:l,y:g}),l!==x&&f<t&&(f=t),g+=h)}this._autoWidth&&(this.width=f);this._autoHeight&&(this.height=g);(e=this.background)&&a!==d&&(a.fillStyle=e,a.fillRect(0,0,this.width,this.height));this.outline?a.strokeStyle=this.color:a.fillStyle=this.color;for(n=0;n<c.length;n++)m=c[n],this._drawTextLine(a,m.text,m.y)}},_drawTextLine:function(a,c,d){var e=
0,f=this.width;switch(this.textAlign){case "center":e=f>>1;break;case "right":e=f}this.outline?a.strokeText(c,e,d):a.fillText(c,e,d)},Statics:{measureFontHeight:function(a){var c=document.documentElement,d=h.createElement("div",{style:{font:a,position:"absolute"},innerHTML:"M"});c.appendChild(d);a=d.offsetHeight;c.removeChild(d);return a}}});h.Text=f})(window);(function(g){var h=g.Hilo,e=h.Bitmap,c=h.Class.create({Extends:h.Container,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("BitmapText");c.superclass.constructor.call(this,a);if(a=a.text+"")this.text="",this.setText(a);this.pointerChildren=!1},glyphs:null,letterSpacing:0,text:"",textAlign:"left",setText:function(a){a=a.toString();var c=a.length;if(this.text!=a){this.text=a;var e,b,g,h=g=0,r=0;for(e=0;e<c;e++)if(b=a.charAt(e),b=this.glyphs[b])r=g+(0<g?this.letterSpacing:0),this.children[e]?
(g=this.children[e],g.setImage(b.image,b.rect)):(g=this._createBitmap(b),this.addChild(g)),g.x=r,g=r+b.rect[2],h=Math.max(h,b.rect[3]);for(e=this.children.length-1;e>=c;e--)this._releaseBitmap(this.children[e]),this.children[e].removeFromParent();this.width=g;this.height=h;this.setTextAlign();return this}},_createBitmap:function(a){var d;c._pool.length?(d=c._pool.pop(),d.setImage(a.image,a.rect)):d=new e({image:a.image,rect:a.rect});return d},_releaseBitmap:function(a){c._pool.push(a)},setTextAlign:function(a){this.textAlign=
a||this.textAlign;switch(this.textAlign){case "center":this.pivotX=.5*this.width;break;case "right":this.pivotX=this.width;break;default:this.pivotX=0}return this},hasGlyphs:function(a){var c=this.glyphs;if(!c)return!1;a=a.toString();var e=a.length,b;for(b=0;b<e;b++)if(!c[a.charAt(b)])return!1;return!0},Statics:{_pool:[],createGlyphs:function(a,c,e,b){var g=a.toString();e=e||g.length;var h=c.width/e;b=c.height/(b||1);var r={},v=0;for(a=a.length;v<a;v++)charStr=g.charAt(v),r[charStr]={image:c,rect:[v%
e*h,b*Math.floor(v/e),h,b]};return r}}});h.BitmapText=c})(window);(function(g){var h=g.Hilo,e=h.Drawable,c=h.Class.create({Extends:h.View,constructor:function(a){a=a||{};this.id=this.id||a.id||h.getUid("DOMElement");c.superclass.constructor.call(this,a);this.drawable=new e;(this.drawable.domElement=a.element||h.createElement("div",{style:{position:"absolute"}})).id=this.id},_render:function(a,c){this.onUpdate&&!1===this.onUpdate(c)||this.visible&&this.render(a,c)},render:function(a,c){"dom"!=a.renderType?h.setElementStyleByView(this):a.draw(this)}});h.DOMElement=
c})(window);(function(g){g=g.Hilo;var h=g.Class,e=function(){function c(a,c){var e={image:a.image,rect:a.rect};c&&(e.name=c.name||null,e.duration=c.duration||0,e.stop=!!c.stop,e.next=c.next||null);return e}return h.create({constructor:function(a){var d;var e=a.frames;if(e){d=[];var b;if(e instanceof Array)for(var g=0,h=e.length;g<h;g++)b=e[g],d[g]={image:a.image,rect:b};else{b=e.frameWidth;for(var h=e.frameHeight,r=a.width/b|0,g=a.height/h|0,e=e.numFrames||r*g,g=0;g<e;g++)d[g]={image:a.image,rect:[g%r*b,(g/r|
0)*h,b,h]}}}else d=null;this._frames=d;var v;d=this._frames;if(a=a.sprites){var e={},u;for(v in a){g=a[v];if("number"===typeof g)b=c(d[g]);else if(g instanceof Array)for(b=[],h=0,r=g.length;h<r;h++){u=g[h];var n;"number"===typeof u?u=c(d[u]):(n=u.rect,"number"===typeof n&&(n=d[u.rect]),u=c(n,u));b[h]=u}else for(b=[],h=g.from;h<=g.to;h++)b[h-g.from]=c(d[h],g[h]);e[v]=b}v=e}else v=null;this._sprites=v},_frames:null,_sprites:null,getFrame:function(a){var c=this._frames;return c&&c[a]},getSprite:function(a){var c=
this._sprites;return c&&c[a]}})}();g.TextureAtlas=e})(window);
